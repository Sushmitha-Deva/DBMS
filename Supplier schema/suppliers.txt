mysql> quit
mysql> create database suppliers;
Query OK, 1 row affected (0.00 sec)

mysql> use suppliers;
Database changed
mysql> create table supplier(sno int primary key,sname varchar(15),status int,city varchar(15));
Query OK, 0 rows affected (0.27 sec)

mysql> create table supplier(pno int primary key,pname varchar(15),color varchar(10),weight int,city varchar(15));
ERROR 1050 (42S01): Table 'supplier' already exists
mysql> create table part(pno int primary key,pname varchar(15),color varchar(10),weight int,city varchar(15));
Query OK, 0 rows affected (0.25 sec)

mysql> create table project(jno int primary key,jname varchar(15),city varchar(15));
Query OK, 0 rows affected (0.51 sec)

mysql> desc suppliers;
ERROR 1146 (42S02): Table 'suppliers.suppliers' doesn't exist
mysql> desc supplier;
+--------+-------------+------+-----+---------+-------+
| Field  | Type        | Null | Key | Default | Extra |
+--------+-------------+------+-----+---------+-------+
| sno    | int(11)     | NO   | PRI | NULL    |       |
| sname  | varchar(15) | YES  |     | NULL    |       |
| status | int(11)     | YES  |     | NULL    |       |
| city   | varchar(15) | YES  |     | NULL    |       |
+--------+-------------+------+-----+---------+-------+
4 rows in set (0.00 sec)

mysql> desc part;
+--------+-------------+------+-----+---------+-------+
| Field  | Type        | Null | Key | Default | Extra |
+--------+-------------+------+-----+---------+-------+
| pno    | int(11)     | NO   | PRI | NULL    |       |
| pname  | varchar(15) | YES  |     | NULL    |       |
| color  | varchar(10) | YES  |     | NULL    |       |
| weight | int(11)     | YES  |     | NULL    |       |
| city   | varchar(15) | YES  |     | NULL    |       |
+--------+-------------+------+-----+---------+-------+
5 rows in set (0.01 sec)

mysql> desc project;
+-------+-------------+------+-----+---------+-------+
| Field | Type        | Null | Key | Default | Extra |
+-------+-------------+------+-----+---------+-------+
| jno   | int(11)     | NO   | PRI | NULL    |       |
| jname | varchar(15) | YES  |     | NULL    |       |
| city  | varchar(15) | YES  |     | NULL    |       |
+-------+-------------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> use COMPANY;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> 
mysql> select Ssn,Dnum from employee,works_on,project where Essn=Ssn and Pno=pnumber and Pno in (select Pno from employee,works_on where exists (select Essn,count(Pno) from works_on,project where Essn=Ssn and Pno=pnumber  group by Essn having count(Pno)<=all(select count(Pno) from works_on,project where Pno=pnumber group by Essn)) and Ssn=Essn) 
    -> and Dnum IN(select distinct Dnum from project,works_on where Pno=pnumber)
    -> order by Dnum;
+-----------+------+
| Ssn       | Dnum |
+-----------+------+
| 666884444 |    2 |
| 333445555 |    2 |
| 123456789 |    5 |
| 453453453 |    5 |
| 987987987 |    6 |
| 999887777 |    6 |
| 345678912 |    6 |
+-----------+------+
7 rows in set (0.00 sec)

mysql> use suppliers;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> insert into supplier values(1,'Deva',10,'Warangal');
Query OK, 1 row affected (0.31 sec)

mysql> insert into supplier values(2,'manasa',4,'hanamkonda');
Query OK, 1 row affected (0.04 sec)

mysql> insert into supplier values(3,'sadwika',5,'hyderabad');
Query OK, 1 row affected (0.30 sec)

mysql> use COMPANY;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> select * from employee;
+----------+-------+-----------+-----------+------------+-----------------------------+------+----------+-----------+-----+
| Fname    | Minit | Lname     | Ssn       | Bdate      | Address                     | Sex  | Salary   | Super_Ssn | Dno |
+----------+-------+-----------+-----------+------------+-----------------------------+------+----------+-----------+-----+
| John     | B     | Smith     | 123456789 | 1965-03-09 | 731 Fondren,Houseton,TX     | M    | 30000.00 | 333445555 |   6 |
| Franklin | T     | Wong      | 333445555 | 1955-12-08 | 678 Voss,Houseton,TX        | M    | 40000.00 | 888665555 |   6 |
| Cecilia  | F     | Kolonsky  | 345678912 | 1960-04-05 | 1978 Windy lane,Houseton,TX | F    | 43000.00 | 333445555 |   2 |
| Joyce    | A     | English   | 453453453 | 1972-12-31 | 6448 Rice,Houseton,TX       | M    | 25000.00 | 333445555 |   2 |
| Arun     | K     | Narayanan | 666884444 | 1962-01-15 | 112 Fire oak,Houseton,TX    | M    | 38000.00 | 333445555 |   5 |
| Deva     | D     | Sushmitha | 755016802 | 1975-01-09 | 197 Berry,Houseton,TX       | F    | 75000.00 | NULL      |   2 |
| James    | E     | Bong      | 888665555 | 1937-11-10 | 450 stone,Houseton,TX       | M    | 55000.00 | NULL      |   5 |
| Jennifer | S     | Wallace   | 987654321 | 1941-06-20 | 182 Berry,Houseton,TX       | F    | 43000.00 | 888665555 |   5 |
| Ahmed    | V     | Jabbar    | 987987987 | 1937-03-10 | 980 Dallas,Houseton,TX      | M    | 25000.00 | 987654321 |   6 |
| Alicia   | J     | Zelaya    | 999887777 | 1968-01-19 | 897 Castle,Houseton,TX      | F    | 27500.00 | 987654321 |   6 |
+----------+-------+-----------+-----------+------------+-----------------------------+------+----------+-----------+-----+
10 rows in set (0.00 sec)

mysql> ^C
mysql> alter table employee add CONSTRAINT EMPPK
    -> PRIMARY KEY (Ssn),
    -> CONSTRAINT EMPSUPERFK
    -> FOREIGN KEY (Super_ssn) REFERENCES EMPLOYEE(Ssn)
    -> ON DELETE SET NULL
    -> ON UPDATE CASCADE,
    -> ;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONSTRAINT EMPSUPERFK
FOREIGN KEY (Super_ssn) REFERENCES EMPLOYEE(Ssn)
ON DELETE' at line 3
mysql> alter table employee add CONSTRAINT EMPPK PRIMARY KEY (Ssn), CONSTRAINT EMPSUPERFK FOREIGN KEY (Super_ssn) REFERENCES EMPLOYEE(Ssn) ON DELETE SET NULL ON UPDATE CASCADE;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONSTRAINT EMPSUPERFK FOREIGN KEY (Super_ssn) REFERENCES EMPLOYEE(Ssn) ON DELETE' at line 1
mysql> alter table employee modify CONSTRAINT EMPPK PRIMARY KEY (Ssn), CONSTRAINT EMPSUPERFK FOREIGN KEY (Super_ssn) REFERENCES EMPLOYEE(Ssn) ON DELETE SET NULL ON UPDATE CASCADE;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CONSTRAINT EMPPK PRIMARY KEY (Ssn), CONSTRAINT EMPSUPERFK FOREIGN KEY (Super_ssn' at line 1
mysql> create view wov (Essn,Pno,cpno,Dnum) as select Essn,Pno,count(Pno),Dnum from works_on,project where Pno=pnumber group by Essn; 
Query OK, 0 rows affected (2.21 sec)

mysql> select * from wov;
ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'COMPANY.works_on.Pno' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> create view wov (Essn,Pno,cpno,Dnum) as select Essn,Pno,count(Pno),Dnum from works_on,project where Pno=pnumber group by Essn,Dnum;
ERROR 1050 (42S01): Table 'wov' already exists
mysql> create view wovv (Essn,Pno,cpno,Dnum) as select Essn,Pno,count(Pno),Dnum from works_on,project where Pno=pnumber group by Essn,Dnum;
Query OK, 0 rows affected (0.06 sec)

mysql> select * from wovv;
ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'COMPANY.works_on.Pno' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> create view wovvv (Essn,cpno,Dnum) as select Essn,count(Pno),Dnum from works_on,project where Pno=pnumber group by Essn,Dnum;
Query OK, 0 rows affected (0.04 sec)

mysql> select * from wovvv;
+-----------+------+------+
| Essn      | cpno | Dnum |
+-----------+------+------+
| 123456789 |    1 |    5 |
| 333445555 |    1 |    2 |
| 345678912 |    2 |    6 |
| 453453453 |    1 |    5 |
| 666884444 |    1 |    2 |
| 987987987 |    1 |    6 |
| 999887777 |    2 |    6 |
+-----------+------+------+
7 rows in set (0.00 sec)

mysql> create view wovvvv (Essn,cpno,Dnum) as select Essn,count(Pno),Dnum from works_on,project where Pno=pnumber group by Essn;
Query OK, 0 rows affected (0.06 sec)

mysql> select * from wovvvv;
ERROR 1055 (42000): Expression #3 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'COMPANY.project.Dnum' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> drop view wov;
Query OK, 0 rows affected (0.00 sec)

mysql> drop view wovv;
Query OK, 0 rows affected (0.00 sec)

mysql> drop view wovvvv;
Query OK, 0 rows affected (0.01 sec)

mysql> quit
mysql> show tables;
+---------------------+
| Tables_in_suppliers |
+---------------------+
| part                |
| project             |
| supplier            |
+---------------------+
3 rows in set (0.00 sec)

mysql> desc part;
+--------+-------------+------+-----+---------+-------+
| Field  | Type        | Null | Key | Default | Extra |
+--------+-------------+------+-----+---------+-------+
| pno    | int(11)     | NO   | PRI | NULL    |       |
| pname  | varchar(15) | YES  |     | NULL    |       |
| color  | varchar(10) | YES  |     | NULL    |       |
| weight | int(11)     | YES  |     | NULL    |       |
| city   | varchar(15) | YES  |     | NULL    |       |
+--------+-------------+------+-----+---------+-------+
5 rows in set (0.00 sec)

mysql> desc supplier;
+--------+-------------+------+-----+---------+-------+
| Field  | Type        | Null | Key | Default | Extra |
+--------+-------------+------+-----+---------+-------+
| sno    | int(11)     | NO   | PRI | NULL    |       |
| sname  | varchar(15) | YES  |     | NULL    |       |
| status | int(11)     | YES  |     | NULL    |       |
| city   | varchar(15) | YES  |     | NULL    |       |
+--------+-------------+------+-----+---------+-------+
4 rows in set (0.00 sec)

mysql> select * from suppliers;
ERROR 1146 (42S02): Table 'suppliers.suppliers' doesn't exist
mysql> select * from supplier;
+-----+---------+--------+------------+
| sno | sname   | status | city       |
+-----+---------+--------+------------+
|   1 | Deva    |     10 | Warangal   |
|   2 | manasa  |      4 | hanamkonda |
|   3 | sadwika |      5 | hyderabad  |
+-----+---------+--------+------------+
3 rows in set (0.00 sec)

mysql> insert into supplier values as(4,Hrishi,10,'thrissur');
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'as(4,Hrishi,10,'thrissur')' at line 1
mysql> insert into supplier values as(4,'Hrishi',10,'thrissur');
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'as(4,'Hrishi',10,'thrissur')' at line 1
mysql> insert into supplier values (4,'Hrishi',10,'thrissur');
Query OK, 1 row affected (0.07 sec)

mysql> insert into supplier values (5,'Pawan',6,'vijaywada');
Query OK, 1 row affected (0.05 sec)

mysql> insert into supplier values (6,'nanda',50,'warangal');
Query OK, 1 row affected (0.05 sec)

mysql> 
mysql> insert into supplier values (7,'Deeksith',40,'hanamkonda');
Query OK, 1 row affected (0.04 sec)

mysql> update supplier name='Satya' where sno=6;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '='Satya' where sno=6' at line 1
mysql> update supplier set name='Satya' where sno=6;
ERROR 1054 (42S22): Unknown column 'name' in 'field list'
mysql> update supplier set sname='Satya' where sno=6;
Query OK, 1 row affected (0.04 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from part;
Empty set (0.00 sec)

mysql> ^C
mysql> insert into part values (1,'X','hanamkonda');
ERROR 1136 (21S01): Column count doesn't match value count at row 1
mysql> insert into project values (1,'X','hanamkonda');
Query OK, 1 row affected (0.04 sec)

mysql> quit
mysql> select * from part;
+-----+------------+--------+--------+------------+
| pno | pname      | color  | weight | city       |
+-----+------------+--------+--------+------------+
|   1 | Nut        | Black  |     10 | hanamkonda |
|   2 | Bolt       | Brown  |     15 | warangal   |
|   3 | screw      | Red    |     17 | hanamkonda |
|   4 | wires      | Green  |     20 | thrissur   |
|   5 | breadboard | yellow |     16 | vijaywada  |
|   6 | capacitor  | Blue   |      7 | hyderabad  |
+-----+------------+--------+--------+------------+
6 rows in set (0.00 sec)

mysql> update part set color='Yellow' where pno=5;
Query OK, 1 row affected (0.15 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from part;
+-----+------------+--------+--------+------------+
| pno | pname      | color  | weight | city       |
+-----+------------+--------+--------+------------+
|   1 | Nut        | Black  |     10 | hanamkonda |
|   2 | Bolt       | Brown  |     15 | warangal   |
|   3 | screw      | Red    |     17 | hanamkonda |
|   4 | wires      | Green  |     20 | thrissur   |
|   5 | breadboard | Yellow |     16 | vijaywada  |
|   6 | capacitor  | Blue   |      7 | hyderabad  |
+-----+------------+--------+--------+------------+
6 rows in set (0.00 sec)

mysql> select * from spj;
ERROR 1146 (42S02): Table 'suppliers.spj' doesn't exist
mysql> show tables;
+---------------------+
| Tables_in_suppliers |
+---------------------+
| part                |
| project             |
| supplier            |
+---------------------+
3 rows in set (0.00 sec)

mysql> create table spj (sno int ,pno int,jno int,qty number,primary key (sno,pno,jno),foreign key (sno) references (supplier) on delete set NULL on update cascade,foreign key (pno) references (part) on delete set NULL on update cascade,foreign key (jno) references (project) on delete set NULL on update set cascade);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'number,primary key (sno,pno,jno),foreign key (sno) references (supplier) on dele' at line 1
mysql> create table spj (sno int ,pno int,jno int,qty int,primary key (sno,pno,jno),foreign key (sno) references (supplier) on delete set NULL on update cascade,foreign key (pno) references (part) on delete set NULL on update cascade,foreign key (jno) references (project) on delete set NULL on update set cascade);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(supplier) on delete set NULL on update cascade,foreign key (pno) references (pa' at line 1
mysql> create table spj (sno int ,pno int,jno int,qty int,primary key (sno,pno,jno),foreign key (sno) references (supplier) on delete set NULL on update cascade,foreign key (pno) references (part) on delete set NULL on update cascade,foreign key (jno) references (project) on delete set NULL on update  cascade);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(supplier) on delete set NULL on update cascade,foreign key (pno) references (pa' at line 1
mysql> create table spj (sno int ,pno int,jno int,qty int,primary key (sno,pno,jno),foreign key (sno) references (supplier),foreign key (pno) references (part),foreign key (jno) references (project));
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(supplier),foreign key (pno) references (part),foreign key (jno) references (pro' at line 1
mysql> create table spj (sno int ,pno int,jno int,qty int,primary key (sno,pno,jno),constraint foreign key (sno) references (supplier),constraint foreign key (pno) references (part),constraint foreign key (jno) references (project));
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '(supplier),constraint foreign key (pno) references (part),constraint foreign key' at line 1
mysql> create table spj (sno int ,pno int,jno int,qty int,primary key (sno,pno,jno),foreign key (sno) references supplier(sno),foreign key (pno) references part(pno),foreign key (jno) references project(jno));
Query OK, 0 rows affected (0.61 sec)

mysql> drop table spj;
Query OK, 0 rows affected (0.19 sec)

mysql> create table spj (sno int ,pno int,jno int,qty int,primary key (sno,pno,jno),foreign key (sno) references supplier (sno) on delete cascade on update cascade,foreign key (pno) references part (pno) on delete set cascade on update cascade,foreign key (jno) references project (jno) on delete cascade on update  cascade);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'cascade on update cascade,foreign key (jno) references project (jno) on delete c' at line 1
mysql> create table spj (sno int ,pno int,jno int,qty int,primary key (sno,pno,jno),foreign key (sno) references supplier (sno) on delete cascade on update cascade,foreign key (pno) references part (pno) on delete  cascade on update cascade,foreign key (jno) references project (jno) on delete cascade on update  cascade);
Query OK, 0 rows affected (0.62 sec)

mysql> insert into spj values (1,1,2,20);
Query OK, 1 row affected (0.07 sec)

mysql> insert into spj values (1,2,3,20);
Query OK, 1 row affected (0.06 sec)

mysql> insert into spj values (1,2,5,30);
Query OK, 1 row affected (0.06 sec)

mysql> insert into spj values (2,2,1,40);
Query OK, 1 row affected (0.04 sec)

mysql> insert into spj values (3,2,1,50);
Query OK, 1 row affected (0.04 sec)

mysql> insert into spj values (4,5,5,50);
Query OK, 1 row affected (0.05 sec)

mysql> insert into spj values (3,1,1,60);
Query OK, 1 row affected (0.32 sec)

mysql> insert into spj values (2,3,6,20);
Query OK, 1 row affected (0.32 sec)

mysql> select * from project;
+-----+-------+------------+
| jno | jname | city       |
+-----+-------+------------+
|   1 | X     | hanamkonda |
|   2 | Y     | warangal   |
|   3 | Z     | thrissur   |
|   4 | A     | hyderabad  |
|   5 | B     | hyderabad  |
|   6 | C     | vijaywada  |
+-----+-------+------------+
6 rows in set (0.00 sec)

mysql> select * from part;
+-----+------------+--------+--------+------------+
| pno | pname      | color  | weight | city       |
+-----+------------+--------+--------+------------+
|   1 | Nut        | Black  |     10 | hanamkonda |
|   2 | Bolt       | Brown  |     15 | warangal   |
|   3 | screw      | Red    |     17 | hanamkonda |
|   4 | wires      | Green  |     20 | thrissur   |
|   5 | breadboard | Yellow |     16 | vijaywada  |
|   6 | capacitor  | Blue   |      7 | hyderabad  |
+-----+------------+--------+--------+------------+
6 rows in set (0.00 sec)

mysql> select * from supplier;
+-----+---------+--------+------------+
| sno | sname   | status | city       |
+-----+---------+--------+------------+
|   1 | Deva    |     10 | warangal   |
|   2 | manasa  |      4 | hanamkonda |
|   3 | sadwika |      5 | hyderabad  |
|   4 | Hrishi  |     10 | thrissur   |
|   5 | Pawan   |      6 | vijaywada  |
|   6 | Satya   |     50 | warangal   |
|   7 | Ram     |     40 | hanamkonda |
+-----+---------+--------+------------+
7 rows in set (0.00 sec)

mysql> insert into spj values (5,6,5,10);
Query OK, 1 row affected (0.04 sec)

mysql> select pno from spj where qty>=16 or sno=2;
+-----+
| pno |
+-----+
|   1 |
|   2 |
|   2 |
|   2 |
|   3 |
|   1 |
|   2 |
|   5 |
+-----+
8 rows in set (0.00 sec)

mysql> select pno,sno,qty from spj where qty>=16 or sno=2;
+-----+-----+------+
| pno | sno | qty  |
+-----+-----+------+
|   1 |   1 |   20 |
|   2 |   1 |   20 |
|   2 |   1 |   30 |
|   2 |   2 |   40 |
|   3 |   2 |   20 |
|   1 |   3 |   60 |
|   2 |   3 |   50 |
|   5 |   4 |   50 |
+-----+-----+------+
8 rows in set (0.00 sec)

mysql> insert into spj values (4,5,1,10);
Query OK, 1 row affected (0.05 sec)

mysql> select * from spj;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |
|   1 |   2 |   3 |   20 |
|   1 |   2 |   5 |   30 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
|   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |
|   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |
|   5 |   6 |   5 |   10 |
+-----+-----+-----+------+
10 rows in set (0.00 sec)

mysql> select pno,sno,qty from spj where qty>=30 or sno=2;
+-----+-----+------+
| pno | sno | qty  |
+-----+-----+------+
|   2 |   1 |   30 |
|   2 |   2 |   40 |
|   3 |   2 |   20 |
|   1 |   3 |   60 |
|   2 |   3 |   50 |
|   5 |   4 |   50 |
+-----+-----+------+
6 rows in set (0.00 sec)

mysql> select S.sno,S.pno,S.jno from (((spj S natural join supplier s) natural join part p) natural join project j);
Empty set (0.01 sec)

mysql> select * from supplier;
+-----+---------+--------+------------+
| sno | sname   | status | city       |
+-----+---------+--------+------------+
|   1 | Deva    |     10 | warangal   |
|   2 | manasa  |      4 | hanamkonda |
|   3 | sadwika |      5 | hyderabad  |
|   4 | Hrishi  |     10 | thrissur   |
|   5 | Pawan   |      6 | vijaywada  |
|   6 | Satya   |     50 | warangal   |
|   7 | Ram     |     40 | hanamkonda |
+-----+---------+--------+------------+
7 rows in set (0.00 sec)

mysql> select * from part;
+-----+------------+--------+--------+------------+
| pno | pname      | color  | weight | city       |
+-----+------------+--------+--------+------------+
|   1 | Nut        | Black  |     10 | hanamkonda |
|   2 | Bolt       | Brown  |     15 | warangal   |
|   3 | screw      | Red    |     17 | hanamkonda |
|   4 | wires      | Green  |     20 | thrissur   |
|   5 | breadboard | Yellow |     16 | vijaywada  |
|   6 | capacitor  | Blue   |      7 | hyderabad  |
+-----+------------+--------+--------+------------+
6 rows in set (0.00 sec)

mysql> select * from project;
+-----+-------+------------+
| jno | jname | city       |
+-----+-------+------------+
|   1 | X     | hanamkonda |
|   2 | Y     | warangal   |
|   3 | Z     | thrissur   |
|   4 | A     | hyderabad  |
|   5 | B     | hyderabad  |
|   6 | C     | vijaywada  |
+-----+-------+------------+
6 rows in set (0.00 sec)

mysql> insert into spj values (1,2,250);
ERROR 1136 (21S01): Column count doesn't match value count at row 1
mysql> insert into spj values (1,2,2,50);
Query OK, 1 row affected (0.05 sec)

mysql> select S.sno,S.pno,S.jno from (((spj S natural join supplier s) natural join part p) natural join project j);
+-----+-----+-----+
| sno | pno | jno |
+-----+-----+-----+
|   1 |   2 |   2 |
+-----+-----+-----+
1 row in set (0.00 sec)

mysql> ^C
mysql> select S.pno,s.city,p.city from (spj S natural join supplier s on S.sno=s.sno)natural join project p on S.jno=p.jno) where s.city='warangal' and p.city='warangal';
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'on S.sno=s.sno)natural join project p on S.jno=p.jno) where s.city='warangal' an' at line 1
mysql> select S.pno,s.city,p.city from (spj S join supplier s on S.sno=s.sno) join project p on S.jno=p.jno) where s.city='warangal' and p.city='warangal';
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') where s.city='warangal' and p.city='warangal'' at line 1
mysql> select sno,pno from spj natural join supplier;  
+-----+-----+
| sno | pno |
+-----+-----+
|   1 |   1 |
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   2 |   2 |
|   2 |   3 |
|   3 |   1 |
|   3 |   2 |
|   4 |   5 |
|   4 |   5 |
|   5 |   6 |
+-----+-----+
11 rows in set (0.01 sec)

mysql> select * from spj;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |
|   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |
|   1 |   2 |   5 |   30 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
|   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |
|   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |
|   5 |   6 |   5 |   10 |
+-----+-----+-----+------+
11 rows in set (0.00 sec)

mysql> select sno,pno,city from project natural join supplier; 
ERROR 1054 (42S22): Unknown column 'pno' in 'field list'
mysql> select sno,jno,city from project natural join supplier;
+-----+-----+------------+
| sno | jno | city       |
+-----+-----+------------+
|   1 |   2 | warangal   |
|   2 |   1 | hanamkonda |
|   3 |   4 | hyderabad  |
|   3 |   5 | hyderabad  |
|   4 |   3 | thrissur   |
|   5 |   6 | vijaywada  |
|   6 |   2 | warangal   |
|   7 |   1 | hanamkonda |
+-----+-----+------------+
8 rows in set (0.00 sec)

mysql> select S.sno,S.pno,S.jno from (((spj S natural join supplier s) natural join part p) natural join project j) where s.city<>p.city and p.city<>j.city and s.city<>j.city;
Empty set (0.00 sec)

mysql> select S.sno,S.pno,S.jno from (((spj S natural join supplier s) natural join part p) natural join project j) where s.city!=p.city and p.city<>j.city and s.city<>j.city;
Empty set (0.00 sec)

mysql> select S.sno,S.pno,S.jno from (((spj S natural join supplier s) natural join part p) natural join project j) where s.city=p.city and p.city=j.city and s.city=j.city;
+-----+-----+-----+
| sno | pno | jno |
+-----+-----+-----+
|   1 |   2 |   2 |
+-----+-----+-----+
1 row in set (0.00 sec)

mysql> select S.sno,S.pno,S.jno from (((spj S natural join supplier s) natural join part p) natural join project j) where s.city!=p.city and p.city!=j.city and s.city!=j.city;
Empty set (0.00 sec)

mysql> insert into spj values (1,1,6,40);
Query OK, 1 row affected (0.04 sec)

mysql> select S.sno,S.pno,S.jno from (((spj S natural join supplier s) natural join part p) natural join project j) where s.city!=p.city and p.city!=j.city and s.city!=j.city;
Empty set (0.00 sec)

mysql> select * from spj;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |
|   1 |   1 |   6 |   40 |
|   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |
|   1 |   2 |   5 |   30 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
|   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |
|   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |
|   5 |   6 |   5 |   10 |
+-----+-----+-----+------+
12 rows in set (0.01 sec)

mysql> select S.sno,S.pno,S.jno from (((spj S natural join supplier s) natural join part p) natural join project j);
+-----+-----+-----+
| sno | pno | jno |
+-----+-----+-----+
|   1 |   2 |   2 |
+-----+-----+-----+
1 row in set (0.00 sec)

mysql> select S.sno,S.pno,S.jno from (( supplier s natural join part p) natural join project j);
ERROR 1054 (42S22): Unknown column 'S.sno' in 'field list'
mysql> select sno,pno,jno from (( supplier s natural join part p) natural join project j);
+-----+-----+-----+
| sno | pno | jno |
+-----+-----+-----+
|   1 |   2 |   2 |
|   2 |   1 |   1 |
|   2 |   3 |   1 |
|   3 |   6 |   4 |
|   3 |   6 |   5 |
|   4 |   4 |   3 |
|   5 |   5 |   6 |
|   6 |   2 |   2 |
|   7 |   1 |   1 |
|   7 |   3 |   1 |
+-----+-----+-----+
10 rows in set (0.01 sec)

mysql> select S.sno,S.pno,S.jno from (((spj S join supplier s on S.sno=s.sno) join part p on S.pno=p.pno) join project j on S.jno=j.jno);
+-----+-----+-----+
| sno | pno | jno |
+-----+-----+-----+
|   2 |   2 |   1 |
|   3 |   1 |   1 |
|   3 |   2 |   1 |
|   4 |   5 |   1 |
|   1 |   1 |   2 |
|   1 |   2 |   2 |
|   1 |   2 |   3 |
|   1 |   2 |   5 |
|   4 |   5 |   5 |
|   5 |   6 |   5 |
|   1 |   1 |   6 |
|   2 |   3 |   6 |
+-----+-----+-----+
12 rows in set (0.00 sec)

mysql> select S.sno,S.pno,S.jno from (((spj S join supplier s on S.sno=s.sno) join part p on S.pno=p.pno) join project j on S.jno=j.jno) where s.city!=p.city and p.city!=j.city and s.city!=j.city;
+-----+-----+-----+
| sno | pno | jno |
+-----+-----+-----+
|   3 |   2 |   1 |
|   4 |   5 |   1 |
|   4 |   5 |   5 |
|   1 |   1 |   6 |
+-----+-----+-----+
4 rows in set (0.00 sec)

mysql> select sno,pno,jno from (( supplier s join part p on S.pno=p.pno) join project j on S.jno=j.jno) where s.city!=p.city and p.city!=j.city and s.city!=j.city;
ERROR 1054 (42S22): Unknown column 'S.pno' in 'on clause'
mysql> select sno,pno,jno from (( supplier s join part p) join project j) where s.city!=p.city and p.city!=j.city and s.city!=j.city;
+-----+-----+-----+
| sno | pno | jno |
+-----+-----+-----+
|   1 |   1 |   3 |
|   1 |   1 |   4 |
|   1 |   1 |   5 |
|   1 |   1 |   6 |
|   1 |   3 |   3 |
|   1 |   3 |   4 |
|   1 |   3 |   5 |
|   1 |   3 |   6 |
|   1 |   4 |   1 |
|   1 |   4 |   4 |
|   1 |   4 |   5 |
|   1 |   4 |   6 |
|   1 |   5 |   1 |
|   1 |   5 |   3 |
|   1 |   5 |   4 |
|   1 |   5 |   5 |
|   1 |   6 |   1 |
|   1 |   6 |   3 |
|   1 |   6 |   6 |
|   2 |   2 |   3 |
|   2 |   2 |   4 |
|   2 |   2 |   5 |
|   2 |   2 |   6 |
|   2 |   4 |   2 |
|   2 |   4 |   4 |
|   2 |   4 |   5 |
|   2 |   4 |   6 |
|   2 |   5 |   2 |
|   2 |   5 |   3 |
|   2 |   5 |   4 |
|   2 |   5 |   5 |
|   2 |   6 |   2 |
|   2 |   6 |   3 |
|   2 |   6 |   6 |
|   3 |   1 |   2 |
|   3 |   1 |   3 |
|   3 |   1 |   6 |
|   3 |   2 |   1 |
|   3 |   2 |   3 |
|   3 |   2 |   6 |
|   3 |   3 |   2 |
|   3 |   3 |   3 |
|   3 |   3 |   6 |
|   3 |   4 |   1 |
|   3 |   4 |   2 |
|   3 |   4 |   6 |
|   3 |   5 |   1 |
|   3 |   5 |   2 |
|   3 |   5 |   3 |
|   4 |   1 |   2 |
|   4 |   1 |   4 |
|   4 |   1 |   5 |
|   4 |   1 |   6 |
|   4 |   2 |   1 |
|   4 |   2 |   4 |
|   4 |   2 |   5 |
|   4 |   2 |   6 |
|   4 |   3 |   2 |
|   4 |   3 |   4 |
|   4 |   3 |   5 |
|   4 |   3 |   6 |
|   4 |   5 |   1 |
|   4 |   5 |   2 |
|   4 |   5 |   4 |
|   4 |   5 |   5 |
|   4 |   6 |   1 |
|   4 |   6 |   2 |
|   4 |   6 |   6 |
|   5 |   1 |   2 |
|   5 |   1 |   3 |
|   5 |   1 |   4 |
|   5 |   1 |   5 |
|   5 |   2 |   1 |
|   5 |   2 |   3 |
|   5 |   2 |   4 |
|   5 |   2 |   5 |
|   5 |   3 |   2 |
|   5 |   3 |   3 |
|   5 |   3 |   4 |
|   5 |   3 |   5 |
|   5 |   4 |   1 |
|   5 |   4 |   2 |
|   5 |   4 |   4 |
|   5 |   4 |   5 |
|   5 |   6 |   1 |
|   5 |   6 |   2 |
|   5 |   6 |   3 |
|   6 |   1 |   3 |
|   6 |   1 |   4 |
|   6 |   1 |   5 |
|   6 |   1 |   6 |
|   6 |   3 |   3 |
|   6 |   3 |   4 |
|   6 |   3 |   5 |
|   6 |   3 |   6 |
|   6 |   4 |   1 |
|   6 |   4 |   4 |
|   6 |   4 |   5 |
|   6 |   4 |   6 |
|   6 |   5 |   1 |
|   6 |   5 |   3 |
|   6 |   5 |   4 |
|   6 |   5 |   5 |
|   6 |   6 |   1 |
|   6 |   6 |   3 |
|   6 |   6 |   6 |
|   7 |   2 |   3 |
|   7 |   2 |   4 |
|   7 |   2 |   5 |
|   7 |   2 |   6 |
|   7 |   4 |   2 |
|   7 |   4 |   4 |
|   7 |   4 |   5 |
|   7 |   4 |   6 |
|   7 |   5 |   2 |
|   7 |   5 |   3 |
|   7 |   5 |   4 |
|   7 |   5 |   5 |
|   7 |   6 |   2 |
|   7 |   6 |   3 |
|   7 |   6 |   6 |
+-----+-----+-----+
121 rows in set (0.00 sec)

mysql> select S.sno,S.pno,S.jno from (((spj S join supplier s on S.sno=s.sno) join part p on S.pno=p.pno) join project j on S.jno=j.jno) where s.city!=p.city and p.city!=j.city and s.city!=j.city;
+-----+-----+-----+
| sno | pno | jno |
+-----+-----+-----+
|   3 |   2 |   1 |
|   4 |   5 |   1 |
|   4 |   5 |   5 |
|   1 |   1 |   6 |
+-----+-----+-----+
4 rows in set (0.00 sec)

mysql> select * from supplier;
+-----+---------+--------+------------+
| sno | sname   | status | city       |
+-----+---------+--------+------------+
|   1 | Deva    |     10 | warangal   |
|   2 | manasa  |      4 | hanamkonda |
|   3 | sadwika |      5 | hyderabad  |
|   4 | Hrishi  |     10 | thrissur   |
|   5 | Pawan   |      6 | vijaywada  |
|   6 | Satya   |     50 | warangal   |
|   7 | Ram     |     40 | hanamkonda |
+-----+---------+--------+------------+
7 rows in set (0.01 sec)

mysql> select * from part;
+-----+------------+--------+--------+------------+
| pno | pname      | color  | weight | city       |
+-----+------------+--------+--------+------------+
|   1 | Nut        | Black  |     10 | hanamkonda |
|   2 | Bolt       | Brown  |     15 | warangal   |
|   3 | screw      | Red    |     17 | hanamkonda |
|   4 | wires      | Green  |     20 | thrissur   |
|   5 | breadboard | Yellow |     16 | vijaywada  |
|   6 | capacitor  | Blue   |      7 | hyderabad  |
+-----+------------+--------+--------+------------+
6 rows in set (0.00 sec)

mysql> select * from project;
+-----+-------+------------+
| jno | jname | city       |
+-----+-------+------------+
|   1 | X     | hanamkonda |
|   2 | Y     | warangal   |
|   3 | Z     | thrissur   |
|   4 | A     | hyderabad  |
|   5 | B     | hyderabad  |
|   6 | C     | vijaywada  |
+-----+-------+------------+
6 rows in set (0.01 sec)

mysql> select * from spj;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |
|   1 |   1 |   6 |   40 |
|   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |
|   1 |   2 |   5 |   30 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
|   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |
|   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |
|   5 |   6 |   5 |   10 |
+-----+-----+-----+------+
12 rows in set (0.00 sec)

mysql> select S.sno,S.pno from ((spj S join supplier s) join project p) where s.city='warangal' and p.city='warangal';
+-----+-----+
| sno | pno |
+-----+-----+
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   3 |   1 |
|   3 |   1 |
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   2 |   2 |
|   2 |   2 |
|   3 |   2 |
|   3 |   2 |
|   2 |   3 |
|   2 |   3 |
|   4 |   5 |
|   4 |   5 |
|   4 |   5 |
|   4 |   5 |
|   5 |   6 |
|   5 |   6 |
+-----+-----+
24 rows in set (0.00 sec)

mysql> select S.sno,S.pno,S.jno from ((spj S join supplier s) join project p) where s.city='warangal' and p.city='warangal';
+-----+-----+-----+
| sno | pno | jno |
+-----+-----+-----+
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   6 |
|   1 |   1 |   6 |
|   3 |   1 |   1 |
|   3 |   1 |   1 |
|   1 |   2 |   2 |
|   1 |   2 |   2 |
|   1 |   2 |   3 |
|   1 |   2 |   3 |
|   1 |   2 |   5 |
|   1 |   2 |   5 |
|   2 |   2 |   1 |
|   2 |   2 |   1 |
|   3 |   2 |   1 |
|   3 |   2 |   1 |
|   2 |   3 |   6 |
|   2 |   3 |   6 |
|   4 |   5 |   1 |
|   4 |   5 |   1 |
|   4 |   5 |   5 |
|   4 |   5 |   5 |
|   5 |   6 |   5 |
|   5 |   6 |   5 |
+-----+-----+-----+
24 rows in set (0.00 sec)

mysql> select S.sno,S.pno,S.jno from ((spj S join supplier s on S.sno=s.sno) join project p S.jno=p.jno) where s.city='warangal' and p.city='warangal';
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'S.jno=p.jno) where s.city='warangal' and p.city='warangal'' at line 1
mysql> select S.sno,S.pno,S.jno from ((spj S join supplier s on S.sno=s.sno) join project p on S.jno=p.jno) where s.city='warangal' and p.city='warangal';
+-----+-----+-----+
| sno | pno | jno |
+-----+-----+-----+
|   1 |   1 |   2 |
|   1 |   2 |   2 |
+-----+-----+-----+
2 rows in set (0.00 sec)

mysql> select S.sno,S.pno,S.jno from ((spj S join supplier s on S.sno=s.sno) join project p on S.jno=p.jno) where s.city=p.city;
+-----+-----+-----+
| sno | pno | jno |
+-----+-----+-----+
|   2 |   2 |   1 |
|   1 |   1 |   2 |
|   1 |   2 |   2 |
+-----+-----+-----+
3 rows in set (0.00 sec)

mysql> select S.sno,S.pno,S.jno from ((spj S join supplier s on S.sno=s.sno) join project p on S.jno=p.jno) where s.city!=p.city;
+-----+-----+-----+
| sno | pno | jno |
+-----+-----+-----+
|   3 |   1 |   1 |
|   3 |   2 |   1 |
|   4 |   5 |   1 |
|   1 |   2 |   3 |
|   1 |   2 |   5 |
|   4 |   5 |   5 |
|   5 |   6 |   5 |
|   1 |   1 |   6 |
|   2 |   3 |   6 |
+-----+-----+-----+
9 rows in set (0.00 sec)

mysql> select * from spj;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |
|   1 |   1 |   6 |   40 |
|   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |
|   1 |   2 |   5 |   30 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
|   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |
|   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |
|   5 |   6 |   5 |   10 |
+-----+-----+-----+------+
12 rows in set (0.00 sec)

mysql> select * from spj natural join spj;
ERROR 1066 (42000): Not unique table/alias: 'spj'
mysql> select * from spj s1 natural join spj s2;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |
|   1 |   1 |   6 |   40 |
|   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |
|   1 |   2 |   5 |   30 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
|   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |
|   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |
|   5 |   6 |   5 |   10 |
+-----+-----+-----+------+
12 rows in set (0.00 sec)

mysql> 
mysql> select * from spj s1  join spj s2;
+-----+-----+-----+------+-----+-----+-----+------+
| sno | pno | jno | qty  | sno | pno | jno | qty  |
+-----+-----+-----+------+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |   1 |   1 |   2 |   20 |
|   1 |   1 |   6 |   40 |   1 |   1 |   2 |   20 |
|   1 |   2 |   2 |   50 |   1 |   1 |   2 |   20 |
|   1 |   2 |   3 |   20 |   1 |   1 |   2 |   20 |
|   1 |   2 |   5 |   30 |   1 |   1 |   2 |   20 |
|   2 |   2 |   1 |   40 |   1 |   1 |   2 |   20 |
|   2 |   3 |   6 |   20 |   1 |   1 |   2 |   20 |
|   3 |   1 |   1 |   60 |   1 |   1 |   2 |   20 |
|   3 |   2 |   1 |   50 |   1 |   1 |   2 |   20 |
|   4 |   5 |   1 |   10 |   1 |   1 |   2 |   20 |
|   4 |   5 |   5 |   50 |   1 |   1 |   2 |   20 |
|   5 |   6 |   5 |   10 |   1 |   1 |   2 |   20 |
|   1 |   1 |   2 |   20 |   1 |   1 |   6 |   40 |
|   1 |   1 |   6 |   40 |   1 |   1 |   6 |   40 |
|   1 |   2 |   2 |   50 |   1 |   1 |   6 |   40 |
|   1 |   2 |   3 |   20 |   1 |   1 |   6 |   40 |
|   1 |   2 |   5 |   30 |   1 |   1 |   6 |   40 |
|   2 |   2 |   1 |   40 |   1 |   1 |   6 |   40 |
|   2 |   3 |   6 |   20 |   1 |   1 |   6 |   40 |
|   3 |   1 |   1 |   60 |   1 |   1 |   6 |   40 |
|   3 |   2 |   1 |   50 |   1 |   1 |   6 |   40 |
|   4 |   5 |   1 |   10 |   1 |   1 |   6 |   40 |
|   4 |   5 |   5 |   50 |   1 |   1 |   6 |   40 |
|   5 |   6 |   5 |   10 |   1 |   1 |   6 |   40 |
|   1 |   1 |   2 |   20 |   1 |   2 |   2 |   50 |
|   1 |   1 |   6 |   40 |   1 |   2 |   2 |   50 |
|   1 |   2 |   2 |   50 |   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |   1 |   2 |   2 |   50 |
|   1 |   2 |   5 |   30 |   1 |   2 |   2 |   50 |
|   2 |   2 |   1 |   40 |   1 |   2 |   2 |   50 |
|   2 |   3 |   6 |   20 |   1 |   2 |   2 |   50 |
|   3 |   1 |   1 |   60 |   1 |   2 |   2 |   50 |
|   3 |   2 |   1 |   50 |   1 |   2 |   2 |   50 |
|   4 |   5 |   1 |   10 |   1 |   2 |   2 |   50 |
|   4 |   5 |   5 |   50 |   1 |   2 |   2 |   50 |
|   5 |   6 |   5 |   10 |   1 |   2 |   2 |   50 |
|   1 |   1 |   2 |   20 |   1 |   2 |   3 |   20 |
|   1 |   1 |   6 |   40 |   1 |   2 |   3 |   20 |
|   1 |   2 |   2 |   50 |   1 |   2 |   3 |   20 |
|   1 |   2 |   3 |   20 |   1 |   2 |   3 |   20 |
|   1 |   2 |   5 |   30 |   1 |   2 |   3 |   20 |
|   2 |   2 |   1 |   40 |   1 |   2 |   3 |   20 |
|   2 |   3 |   6 |   20 |   1 |   2 |   3 |   20 |
|   3 |   1 |   1 |   60 |   1 |   2 |   3 |   20 |
|   3 |   2 |   1 |   50 |   1 |   2 |   3 |   20 |
|   4 |   5 |   1 |   10 |   1 |   2 |   3 |   20 |
|   4 |   5 |   5 |   50 |   1 |   2 |   3 |   20 |
|   5 |   6 |   5 |   10 |   1 |   2 |   3 |   20 |
|   1 |   1 |   2 |   20 |   1 |   2 |   5 |   30 |
|   1 |   1 |   6 |   40 |   1 |   2 |   5 |   30 |
|   1 |   2 |   2 |   50 |   1 |   2 |   5 |   30 |
|   1 |   2 |   3 |   20 |   1 |   2 |   5 |   30 |
|   1 |   2 |   5 |   30 |   1 |   2 |   5 |   30 |
|   2 |   2 |   1 |   40 |   1 |   2 |   5 |   30 |
|   2 |   3 |   6 |   20 |   1 |   2 |   5 |   30 |
|   3 |   1 |   1 |   60 |   1 |   2 |   5 |   30 |
|   3 |   2 |   1 |   50 |   1 |   2 |   5 |   30 |
|   4 |   5 |   1 |   10 |   1 |   2 |   5 |   30 |
|   4 |   5 |   5 |   50 |   1 |   2 |   5 |   30 |
|   5 |   6 |   5 |   10 |   1 |   2 |   5 |   30 |
|   1 |   1 |   2 |   20 |   2 |   2 |   1 |   40 |
|   1 |   1 |   6 |   40 |   2 |   2 |   1 |   40 |
|   1 |   2 |   2 |   50 |   2 |   2 |   1 |   40 |
|   1 |   2 |   3 |   20 |   2 |   2 |   1 |   40 |
|   1 |   2 |   5 |   30 |   2 |   2 |   1 |   40 |
|   2 |   2 |   1 |   40 |   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |   2 |   2 |   1 |   40 |
|   3 |   1 |   1 |   60 |   2 |   2 |   1 |   40 |
|   3 |   2 |   1 |   50 |   2 |   2 |   1 |   40 |
|   4 |   5 |   1 |   10 |   2 |   2 |   1 |   40 |
|   4 |   5 |   5 |   50 |   2 |   2 |   1 |   40 |
|   5 |   6 |   5 |   10 |   2 |   2 |   1 |   40 |
|   1 |   1 |   2 |   20 |   2 |   3 |   6 |   20 |
|   1 |   1 |   6 |   40 |   2 |   3 |   6 |   20 |
|   1 |   2 |   2 |   50 |   2 |   3 |   6 |   20 |
|   1 |   2 |   3 |   20 |   2 |   3 |   6 |   20 |
|   1 |   2 |   5 |   30 |   2 |   3 |   6 |   20 |
|   2 |   2 |   1 |   40 |   2 |   3 |   6 |   20 |
|   2 |   3 |   6 |   20 |   2 |   3 |   6 |   20 |
|   3 |   1 |   1 |   60 |   2 |   3 |   6 |   20 |
|   3 |   2 |   1 |   50 |   2 |   3 |   6 |   20 |
|   4 |   5 |   1 |   10 |   2 |   3 |   6 |   20 |
|   4 |   5 |   5 |   50 |   2 |   3 |   6 |   20 |
|   5 |   6 |   5 |   10 |   2 |   3 |   6 |   20 |
|   1 |   1 |   2 |   20 |   3 |   1 |   1 |   60 |
|   1 |   1 |   6 |   40 |   3 |   1 |   1 |   60 |
|   1 |   2 |   2 |   50 |   3 |   1 |   1 |   60 |
|   1 |   2 |   3 |   20 |   3 |   1 |   1 |   60 |
|   1 |   2 |   5 |   30 |   3 |   1 |   1 |   60 |
|   2 |   2 |   1 |   40 |   3 |   1 |   1 |   60 |
|   2 |   3 |   6 |   20 |   3 |   1 |   1 |   60 |
|   3 |   1 |   1 |   60 |   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |   3 |   1 |   1 |   60 |
|   4 |   5 |   1 |   10 |   3 |   1 |   1 |   60 |
|   4 |   5 |   5 |   50 |   3 |   1 |   1 |   60 |
|   5 |   6 |   5 |   10 |   3 |   1 |   1 |   60 |
|   1 |   1 |   2 |   20 |   3 |   2 |   1 |   50 |
|   1 |   1 |   6 |   40 |   3 |   2 |   1 |   50 |
|   1 |   2 |   2 |   50 |   3 |   2 |   1 |   50 |
|   1 |   2 |   3 |   20 |   3 |   2 |   1 |   50 |
|   1 |   2 |   5 |   30 |   3 |   2 |   1 |   50 |
|   2 |   2 |   1 |   40 |   3 |   2 |   1 |   50 |
|   2 |   3 |   6 |   20 |   3 |   2 |   1 |   50 |
|   3 |   1 |   1 |   60 |   3 |   2 |   1 |   50 |
|   3 |   2 |   1 |   50 |   3 |   2 |   1 |   50 |
|   4 |   5 |   1 |   10 |   3 |   2 |   1 |   50 |
|   4 |   5 |   5 |   50 |   3 |   2 |   1 |   50 |
|   5 |   6 |   5 |   10 |   3 |   2 |   1 |   50 |
|   1 |   1 |   2 |   20 |   4 |   5 |   1 |   10 |
|   1 |   1 |   6 |   40 |   4 |   5 |   1 |   10 |
|   1 |   2 |   2 |   50 |   4 |   5 |   1 |   10 |
|   1 |   2 |   3 |   20 |   4 |   5 |   1 |   10 |
|   1 |   2 |   5 |   30 |   4 |   5 |   1 |   10 |
|   2 |   2 |   1 |   40 |   4 |   5 |   1 |   10 |
|   2 |   3 |   6 |   20 |   4 |   5 |   1 |   10 |
|   3 |   1 |   1 |   60 |   4 |   5 |   1 |   10 |
|   3 |   2 |   1 |   50 |   4 |   5 |   1 |   10 |
|   4 |   5 |   1 |   10 |   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |   4 |   5 |   1 |   10 |
|   5 |   6 |   5 |   10 |   4 |   5 |   1 |   10 |
|   1 |   1 |   2 |   20 |   4 |   5 |   5 |   50 |
|   1 |   1 |   6 |   40 |   4 |   5 |   5 |   50 |
|   1 |   2 |   2 |   50 |   4 |   5 |   5 |   50 |
|   1 |   2 |   3 |   20 |   4 |   5 |   5 |   50 |
|   1 |   2 |   5 |   30 |   4 |   5 |   5 |   50 |
|   2 |   2 |   1 |   40 |   4 |   5 |   5 |   50 |
|   2 |   3 |   6 |   20 |   4 |   5 |   5 |   50 |
|   3 |   1 |   1 |   60 |   4 |   5 |   5 |   50 |
|   3 |   2 |   1 |   50 |   4 |   5 |   5 |   50 |
|   4 |   5 |   1 |   10 |   4 |   5 |   5 |   50 |
|   4 |   5 |   5 |   50 |   4 |   5 |   5 |   50 |
|   5 |   6 |   5 |   10 |   4 |   5 |   5 |   50 |
|   1 |   1 |   2 |   20 |   5 |   6 |   5 |   10 |
|   1 |   1 |   6 |   40 |   5 |   6 |   5 |   10 |
|   1 |   2 |   2 |   50 |   5 |   6 |   5 |   10 |
|   1 |   2 |   3 |   20 |   5 |   6 |   5 |   10 |
|   1 |   2 |   5 |   30 |   5 |   6 |   5 |   10 |
|   2 |   2 |   1 |   40 |   5 |   6 |   5 |   10 |
|   2 |   3 |   6 |   20 |   5 |   6 |   5 |   10 |
|   3 |   1 |   1 |   60 |   5 |   6 |   5 |   10 |
|   3 |   2 |   1 |   50 |   5 |   6 |   5 |   10 |
|   4 |   5 |   1 |   10 |   5 |   6 |   5 |   10 |
|   4 |   5 |   5 |   50 |   5 |   6 |   5 |   10 |
|   5 |   6 |   5 |   10 |   5 |   6 |   5 |   10 |
+-----+-----+-----+------+-----+-----+-----+------+
144 rows in set (0.00 sec)

mysql> select sum(qty) from spj where sno=1;
+----------+
| sum(qty) |
+----------+
|      160 |
+----------+
1 row in set (0.01 sec)

mysql> select * from spj s1  join spj s2 where s1.sno=s2.sno;
+-----+-----+-----+------+-----+-----+-----+------+
| sno | pno | jno | qty  | sno | pno | jno | qty  |
+-----+-----+-----+------+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |   1 |   1 |   2 |   20 |
|   1 |   1 |   2 |   20 |   1 |   1 |   6 |   40 |
|   1 |   1 |   2 |   20 |   1 |   2 |   2 |   50 |
|   1 |   1 |   2 |   20 |   1 |   2 |   3 |   20 |
|   1 |   1 |   2 |   20 |   1 |   2 |   5 |   30 |
|   1 |   1 |   6 |   40 |   1 |   1 |   2 |   20 |
|   1 |   1 |   6 |   40 |   1 |   1 |   6 |   40 |
|   1 |   1 |   6 |   40 |   1 |   2 |   2 |   50 |
|   1 |   1 |   6 |   40 |   1 |   2 |   3 |   20 |
|   1 |   1 |   6 |   40 |   1 |   2 |   5 |   30 |
|   1 |   2 |   2 |   50 |   1 |   1 |   2 |   20 |
|   1 |   2 |   2 |   50 |   1 |   1 |   6 |   40 |
|   1 |   2 |   2 |   50 |   1 |   2 |   2 |   50 |
|   1 |   2 |   2 |   50 |   1 |   2 |   3 |   20 |
|   1 |   2 |   2 |   50 |   1 |   2 |   5 |   30 |
|   1 |   2 |   3 |   20 |   1 |   1 |   2 |   20 |
|   1 |   2 |   3 |   20 |   1 |   1 |   6 |   40 |
|   1 |   2 |   3 |   20 |   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |   1 |   2 |   3 |   20 |
|   1 |   2 |   3 |   20 |   1 |   2 |   5 |   30 |
|   1 |   2 |   5 |   30 |   1 |   1 |   2 |   20 |
|   1 |   2 |   5 |   30 |   1 |   1 |   6 |   40 |
|   1 |   2 |   5 |   30 |   1 |   2 |   2 |   50 |
|   1 |   2 |   5 |   30 |   1 |   2 |   3 |   20 |
|   1 |   2 |   5 |   30 |   1 |   2 |   5 |   30 |
|   2 |   2 |   1 |   40 |   2 |   2 |   1 |   40 |
|   2 |   2 |   1 |   40 |   2 |   3 |   6 |   20 |
|   2 |   3 |   6 |   20 |   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |   2 |   3 |   6 |   20 |
|   3 |   1 |   1 |   60 |   3 |   1 |   1 |   60 |
|   3 |   1 |   1 |   60 |   3 |   2 |   1 |   50 |
|   3 |   2 |   1 |   50 |   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |   3 |   2 |   1 |   50 |
|   4 |   5 |   1 |   10 |   4 |   5 |   1 |   10 |
|   4 |   5 |   1 |   10 |   4 |   5 |   5 |   50 |
|   4 |   5 |   5 |   50 |   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |   4 |   5 |   5 |   50 |
|   5 |   6 |   5 |   10 |   5 |   6 |   5 |   10 |
+-----+-----+-----+------+-----+-----+-----+------+
38 rows in set (0.00 sec)

mysql> select s1.pno,s2.pno from spj s1  join spj s2 where s1.sno=s2.sno;
+-----+-----+
| pno | pno |
+-----+-----+
|   1 |   1 |
|   1 |   1 |
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   1 |   1 |
|   1 |   1 |
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   1 |   1 |
|   1 |   2 |
|   2 |   1 |
|   2 |   1 |
|   2 |   2 |
|   2 |   2 |
|   2 |   2 |
|   2 |   1 |
|   2 |   1 |
|   2 |   2 |
|   2 |   2 |
|   2 |   2 |
|   2 |   1 |
|   2 |   1 |
|   2 |   2 |
|   2 |   2 |
|   2 |   2 |
|   2 |   2 |
|   2 |   3 |
|   2 |   1 |
|   2 |   2 |
|   3 |   2 |
|   3 |   3 |
|   5 |   5 |
|   5 |   5 |
|   5 |   5 |
|   5 |   5 |
|   6 |   6 |
+-----+-----+
38 rows in set (0.00 sec)

mysql> select distinct s1.pno,s2.pno from spj s1  join spj s2 where s1.sno=s2.sno;
+-----+-----+
| pno | pno |
+-----+-----+
|   1 |   1 |
|   1 |   2 |
|   2 |   1 |
|   2 |   2 |
|   2 |   3 |
|   3 |   2 |
|   3 |   3 |
|   5 |   5 |
|   6 |   6 |
+-----+-----+
9 rows in set (0.00 sec)

mysql> select distinct s1.sno, distinct s1.pno,s2.pno from spj s1  join spj s2 where s1.sno=s2.sno;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'distinct s1.pno,s2.pno from spj s1  join spj s2 where s1.sno=s2.sno' at line 1
mysql> select s1.sno, distinct s1.pno,s2.pno from spj s1  join spj s2 where s1.sno=s2.sno;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'distinct s1.pno,s2.pno from spj s1  join spj s2 where s1.sno=s2.sno' at line 1
mysql> select s1.sno, distinct s1.pno,s2.pno from spj s1  join spj s2 where s1.sno=s2.sno;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'distinct s1.pno,s2.pno from spj s1  join spj s2 where s1.sno=s2.sno' at line 1
mysql> select  s1.pno,s2.pno from spj s1  join spj s2 where s1.sno=s2.sno;
+-----+-----+
| pno | pno |
+-----+-----+
|   1 |   1 |
|   1 |   1 |
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   1 |   1 |
|   1 |   1 |
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   1 |   1 |
|   1 |   2 |
|   2 |   1 |
|   2 |   1 |
|   2 |   2 |
|   2 |   2 |
|   2 |   2 |
|   2 |   1 |
|   2 |   1 |
|   2 |   2 |
|   2 |   2 |
|   2 |   2 |
|   2 |   1 |
|   2 |   1 |
|   2 |   2 |
|   2 |   2 |
|   2 |   2 |
|   2 |   2 |
|   2 |   3 |
|   2 |   1 |
|   2 |   2 |
|   3 |   2 |
|   3 |   3 |
|   5 |   5 |
|   5 |   5 |
|   5 |   5 |
|   5 |   5 |
|   6 |   6 |
+-----+-----+
38 rows in set (0.00 sec)

mysql> select distinct  s1.pno,s2.pno from spj s1  join spj s2 where s1.sno=s2.sno;
+-----+-----+
| pno | pno |
+-----+-----+
|   1 |   1 |
|   1 |   2 |
|   2 |   1 |
|   2 |   2 |
|   2 |   3 |
|   3 |   2 |
|   3 |   3 |
|   5 |   5 |
|   6 |   6 |
+-----+-----+
9 rows in set (0.00 sec)

mysql> select distinct  s1.pno,s2.pno,s1.sno from spj s1  join spj s2 where s1.sno=s2.sno;
+-----+-----+-----+
| pno | pno | sno |
+-----+-----+-----+
|   1 |   1 |   1 |
|   1 |   2 |   1 |
|   1 |   1 |   3 |
|   1 |   2 |   3 |
|   2 |   1 |   1 |
|   2 |   2 |   1 |
|   2 |   2 |   2 |
|   2 |   3 |   2 |
|   2 |   1 |   3 |
|   2 |   2 |   3 |
|   3 |   2 |   2 |
|   3 |   3 |   2 |
|   5 |   5 |   4 |
|   6 |   6 |   5 |
+-----+-----+-----+
14 rows in set (0.00 sec)

mysql> select pno,jno,sum(qty) from spj group by jno;
ERROR 1055 (42000): Expression #1 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'suppliers.spj.pno' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> select pno,sum(qty) from spj group by jno;
ERROR 1055 (42000): Expression #1 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'suppliers.spj.pno' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> select jno,sum(qty) from spj group by jno;
+-----+----------+
| jno | sum(qty) |
+-----+----------+
|   1 |      160 |
|   2 |       70 |
|   3 |       20 |
|   5 |       90 |
|   6 |       60 |
+-----+----------+
5 rows in set (0.00 sec)

mysql> select pname from ((spj s join project j on j.jno=s.jno)join part p on p.pno=s.pno) where pname='warangal';
Empty set (0.00 sec)

mysql> select pname from ((spj s join project j on j.jno=s.jno)join part p on p.pno=s.pno) where jname='warangal';
Empty set (0.00 sec)

mysql> select p.pname from ((spj s join project j on j.jno=s.jno)join part p on p.pno=s.pno) where j.jname='warangal';
Empty set (0.01 sec)

mysql> select p.pname from ((spj S join supplier s on S.sno=s.sno) join project p on S.jno=p.jno) where jname='warangal;
    '> ^C
mysql> select p.pname from ((spj S join supplier s on S.sno=s.sno) join project p on S.jno=p.jno) where jname='warangal';
ERROR 1054 (42S22): Unknown column 'p.pname' in 'field list'
mysql> select pname from ((spj s join project j on j.jno=s.jno)join part p on p.pno=s.pno) where jname='warangal';
Empty set (0.00 sec)

mysql> quit
mysql> select pname from spj s,project j,part p where j.jno=s.jno and s.pno=p.pno and j.jname='warangal';
Empty set (0.30 sec)

mysql> select pname from spj s,project j,part p where j.jno=s.jno and s.pno=p.pno and j.jname='hanamkonda';
Empty set (0.00 sec)

mysql> select pname from ((spj s join project j on j.jno=s.jno)join part p on p.pno=s.pno) where jname='warangal';
Empty set (0.00 sec)

mysql> select pname from ((spj s join project j on j.jno=s.jno)join part p on p.pno=s.pno) where j.jno=2;
+-------+
| pname |
+-------+
| Nut   |
| Bolt  |
+-------+
2 rows in set (0.03 sec)

mysql> select pname from ((spj s join project j on j.jno=s.jno)join part p on p.pno=s.pno) where j.city='warangal';
+-------+
| pname |
+-------+
| Nut   |
| Bolt  |
+-------+
2 rows in set (0.00 sec)

mysql> select S.sno from spj S,part p where p.pno=S.pno and p.color='Brown'; 
+-----+
| sno |
+-----+
|   1 |
|   1 |
|   1 |
|   2 |
|   3 |
+-----+
5 rows in set (0.00 sec)

mysql> select distinct S.sno from spj S,part p where p.pno=S.pno and p.color='Brown';
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
+-----+
3 rows in set (0.00 sec)

mysql> select S.pno from spj S,supplier s where s.sno=S.sno and S.sno in(select distinct S.sno from spj S,part p where p.pno=S.pno and p.color='Brown'); 
+-----+
| pno |
+-----+
|   1 |
|   1 |
|   2 |
|   2 |
|   2 |
|   2 |
|   3 |
|   1 |
|   2 |
+-----+
9 rows in set (0.00 sec)

mysql> select S.pno,S.sno from spj S,supplier s where s.sno=S.sno and S.sno in(select distinct S.sno from spj S,part p where p.pno=S.pno and p.color='Brown');
+-----+-----+
| pno | sno |
+-----+-----+
|   1 |   1 |
|   1 |   1 |
|   2 |   1 |
|   2 |   1 |
|   2 |   1 |
|   2 |   2 |
|   3 |   2 |
|   1 |   3 |
|   2 |   3 |
+-----+-----+
9 rows in set (0.00 sec)

mysql> select distinct S.pno from spj S,supplier s where s.sno=S.sno and S.sno in(select distinct S.sno from spj S,part p where p.pno=S.pno and p.color='Brown');
+-----+
| pno |
+-----+
|   1 |
|   2 |
|   3 |
+-----+
3 rows in set (0.00 sec)

mysql> select S1.pno from spj S1,supplier s where s.sno=S1.sno and S.sno in(select distinct S.sno from spj S,part p where p.pno=S.pno and p.color='Brown');
ERROR 1054 (42S22): Unknown column 'S.sno' in 'IN/ALL/ANY subquery'
mysql> select S1.pno from spj S1,supplier s where s.sno=S1.sno and S1.sno in(select distinct S.sno from spj S,part p where p.pno=S.pno and p.color='Brown');
+-----+
| pno |
+-----+
|   1 |
|   1 |
|   2 |
|   2 |
|   2 |
|   2 |
|   3 |
|   1 |
|   2 |
+-----+
9 rows in set (0.00 sec)

mysql> select distinct S.pno from spj S,supplier s where s.sno=S.sno and S.sno in(select distinct S.sno from spj S,part p where p.pno=S.pno and p.color='Brown');
+-----+
| pno |
+-----+
|   1 |
|   2 |
|   3 |
+-----+
3 rows in set (0.00 sec)

mysql> select S.sno from spj S,part p where S.pno=p.pno and S.pno in(select distinct S.pno from spj S,supplier s where s.sno=S.sno and S.sno in(select distinct S.sno from spj S,part p where p.pno=S.pno and p.color='Brown'));
+-----+
| sno |
+-----+
|   1 |
|   1 |
|   3 |
|   1 |
|   1 |
|   1 |
|   2 |
|   3 |
|   2 |
+-----+
9 rows in set (0.01 sec)

mysql> select distinct S.sno from spj S,part p where S.pno=p.pno and S.pno in(select distinct S.pno from spj S,supplier s where s.sno=S.sno and S.sno in(select distinct S.sno from spj S,part p where p.pno=S.pno and p.color='Brown'));
+-----+
| sno |
+-----+
|   1 |
|   3 |
|   2 |
+-----+
3 rows in set (0.00 sec)

mysql> select max(qty) from spj where jno=1;
+----------+
| max(qty) |
+----------+
|       60 |
+----------+
1 row in set (0.00 sec)

mysql> select jno from spj where qty>select max(qty) from spj where jno=1; 
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select max(qty) from spj where jno=1' at line 1
mysql> select jno from spj where qty>(select max(qty) from spj where jno=1);
Empty set (0.00 sec)

mysql> select jno from spj where qty>(select max(qty) from spj where jno=1) and pno=1;
Empty set (0.00 sec)

mysql> select jno from spj where qty>(select max(qty) from spj where jno=2) and pno=1;
+-----+
| jno |
+-----+
|   1 |
+-----+
1 row in set (0.00 sec)

mysql> select avg(qty) from spj where pno=1;
+----------+
| avg(qty) |
+----------+
|  40.0000 |
+----------+
1 row in set (0.00 sec)

mysql> select sno,jno from spj where pno=1 and qty>( select avg(qty) from spj where pno=1);
+-----+-----+
| sno | jno |
+-----+-----+
|   3 |   1 |
+-----+-----+
1 row in set (0.00 sec)

mysql> insert into spj values(4,1,4,50);
Query OK, 1 row affected (0.07 sec)

mysql> select sno,jno from spj where pno=1 and qty>( select avg(qty) from spj where pno=1);
+-----+-----+
| sno | jno |
+-----+-----+
|   3 |   1 |
|   4 |   4 |
+-----+-----+
2 rows in set (0.00 sec)

mysql> select S.sno,S.jno from spj S where S.pno=1 and S.qty>( select avg(qty) from spj S1 where S1.pno=1 and S1.jno=S.jno);
Empty set (0.01 sec)

mysql> insert into spj values(5,1,1,80);
Query OK, 1 row affected (0.31 sec)

mysql> insert into spj values(5,1,1,80);
ERROR 1062 (23000): Duplicate entry '5-1-1' for key 'PRIMARY'
mysql> select S.sno,S.jno from spj S where S.pno=1 and S.qty>( select avg(qty) from spj S1 where S1.pno=1 and S1.jno=S.jno);
+-----+-----+
| sno | jno |
+-----+-----+
|   5 |   1 |
+-----+-----+
1 row in set (0.00 sec)

mysql> select jno from spj where sno=1;
+-----+
| jno |
+-----+
|   2 |
|   6 |
|   2 |
|   3 |
|   5 |
+-----+
5 rows in set (0.00 sec)

mysql> select s1.sno,s2.sno,s1.city from supplier s1 where s1.city=(select s2.city from supplier where s1.city=s2.city);
ERROR 1054 (42S22): Unknown column 's2.sno' in 'field list'
mysql> select s1.sno,s2.sno,s1.city from supplier s1 where s1.city=(select s2.city from supplier s2 where s1.city=s2.city);
ERROR 1054 (42S22): Unknown column 's2.sno' in 'field list'
mysql> select s1.sno,s2.pno from supplier s1 join supplier s2 where s1.city=s2.city;
ERROR 1054 (42S22): Unknown column 's2.pno' in 'field list'
mysql> select s1.sno,s2.sno from supplier s1 join supplier s2 where s1.city=s2.city;
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   1 |
|   6 |   1 |
|   2 |   2 |
|   7 |   2 |
|   3 |   3 |
|   4 |   4 |
|   5 |   5 |
|   1 |   6 |
|   6 |   6 |
|   2 |   7 |
|   7 |   7 |
+-----+-----+
11 rows in set (0.00 sec)

mysql> select s1.sno,s2.sno,s1.city from supplier s1 join supplier s2 where s1.city=s2.city;
+-----+-----+------------+
| sno | sno | city       |
+-----+-----+------------+
|   1 |   1 | warangal   |
|   6 |   1 | warangal   |
|   2 |   2 | hanamkonda |
|   7 |   2 | hanamkonda |
|   3 |   3 | hyderabad  |
|   4 |   4 | thrissur   |
|   5 |   5 | vijaywada  |
|   1 |   6 | warangal   |
|   6 |   6 | warangal   |
|   2 |   7 | hanamkonda |
|   7 |   7 | hanamkonda |
+-----+-----+------------+
11 rows in set (0.00 sec)

mysql> select s1.sno,s2.sno,s1.city from supplier s1 join supplier s2 where s1.city=s2.city order by s1.sno;
+-----+-----+------------+
| sno | sno | city       |
+-----+-----+------------+
|   1 |   6 | warangal   |
|   1 |   1 | warangal   |
|   2 |   7 | hanamkonda |
|   2 |   2 | hanamkonda |
|   3 |   3 | hyderabad  |
|   4 |   4 | thrissur   |
|   5 |   5 | vijaywada  |
|   6 |   6 | warangal   |
|   6 |   1 | warangal   |
|   7 |   7 | hanamkonda |
|   7 |   2 | hanamkonda |
+-----+-----+------------+
11 rows in set (0.00 sec)

mysql> select s1.sno,s2.sno,s1.city from supplier s1 join supplier s2 where s1.city=s2.city and s1.sno!=s2.sno order by s1.sno ;
+-----+-----+------------+
| sno | sno | city       |
+-----+-----+------------+
|   1 |   6 | warangal   |
|   2 |   7 | hanamkonda |
|   6 |   1 | warangal   |
|   7 |   2 | hanamkonda |
+-----+-----+------------+
4 rows in set (0.00 sec)

mysql> select distinct(s1.sno,s2.sno),s1.city from supplier s1 join supplier s2 where s1.city=s2.city and s1.sno!=s2.sno order by s1.sno ;
ERROR 1241 (21000): Operand should contain 1 column(s)
mysql> select pno from spj where sno=2;
+-----+
| pno |
+-----+
|   2 |
|   3 |
+-----+
2 rows in set (0.00 sec)

mysql> select pno,weight*453 from part where weight>15*453;
Empty set (0.00 sec)

mysql> select pno,weight*453 from part where weight*453>15*453;
+-----+------------+
| pno | weight*453 |
+-----+------------+
|   3 |       7701 |
|   4 |       9060 |
|   5 |       7248 |
+-----+------------+
3 rows in set (0.00 sec)

mysql> select sno,qty*(p.weight) as weight from spj s,part p where p.pno=s.pno; 
+-----+--------+
| sno | weight |
+-----+--------+
|   1 |    200 |
|   1 |    400 |
|   3 |    600 |
|   4 |    500 |
|   5 |    800 |
|   1 |    750 |
|   1 |    300 |
|   1 |    450 |
|   2 |    600 |
|   3 |    750 |
|   2 |    340 |
|   4 |    160 |
|   4 |    800 |
|   5 |     70 |
+-----+--------+
14 rows in set (0.00 sec)

mysql> select sno,sum(qty*(p.weight)) as weight from spj s,part p where p.pno=s.pno group by sno;
+-----+--------+
| sno | weight |
+-----+--------+
|   1 |   2100 |
|   2 |    940 |
|   3 |   1350 |
|   4 |   1460 |
|   5 |    870 |
+-----+--------+
5 rows in set (0.00 sec)

mysql> select sno,count(pno) from spj group by sno; 
+-----+------------+
| sno | count(pno) |
+-----+------------+
|   1 |          5 |
|   2 |          2 |
|   3 |          2 |
|   4 |          3 |
|   5 |          2 |
+-----+------------+
5 rows in set (0.00 sec)

mysql> quit
mysql> alter table spj add constraint foreign key(sno) references supplier(sno)
    -> ;
Query OK, 14 rows affected (0.92 sec)
Records: 14  Duplicates: 0  Warnings: 0

mysql> alter table spj add constraint foreign key(pno) references part(pno);
Query OK, 14 rows affected (1.02 sec)
Records: 14  Duplicates: 0  Warnings: 0

mysql> alter table spj add constraint foreign key(jno) references project(jno);
Query OK, 14 rows affected (0.93 sec)
Records: 14  Duplicates: 0  Warnings: 0

mysql> select S.pno from (spj S join supplier s on s.sno=S.sno)join project j onj.jno=S.jno where s.city='warangal'or j.city='warangal';
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'onj.jno=S.jno where s.city='warangal'or j.city='warangal'' at line 1
mysql> select S.pno from ((spj S join supplier s on s.sno=S.sno)join project j onj.jno=S.jno) where s.city='warangal'or j.city='warangal';
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'onj.jno=S.jno) where s.city='warangal'or j.city='warangal'' at line 1
mysql> select S.pno from ((spj S join supplier s on s.sno=S.sno)join project j on j.jno=S.jno) where s.city='warangal'or j.city='warangal';
+-----+
| pno |
+-----+
|   1 |
|   2 |
|   2 |
|   2 |
|   1 |
+-----+
5 rows in set (0.00 sec)

mysql> select s1.city,s2.city from spj S,supplier s1,supplier s2 where S.sno=s1.sno and s2.sno=S.sno and s2.sno=s1.sno+1; 
Empty set (0.00 sec)

mysql> select s1.city,s2.city from spj S,supplier s1,supplier s2 where S.sno=s1.sno and s2.sno=S.sno and s2.sno=(select s1.sno+1 from supplier s1);
ERROR 1242 (21000): Subquery returns more than 1 row
mysql> select s1.city,s2.city from spj S,supplier s1,supplier s2 where S.sno=s1.sno and s2.sno=S.sno and s2.sno in (select s1.sno+1 from supplier s1);
+------------+------------+
| city       | city       |
+------------+------------+
| hanamkonda | hanamkonda |
| hanamkonda | hanamkonda |
| hyderabad  | hyderabad  |
| hyderabad  | hyderabad  |
| thrissur   | thrissur   |
| thrissur   | thrissur   |
| thrissur   | thrissur   |
| vijaywada  | vijaywada  |
| vijaywada  | vijaywada  |
+------------+------------+
9 rows in set (0.00 sec)

mysql> select s1.city,s2.city from spj S,supplier s2 where s2.sno=S.sno and s2.sno in (select s1.sno+1 from supplier s1,spj where sno=s1.sno);
ERROR 1054 (42S22): Unknown column 's1.city' in 'field list'
mysql> select s1.city,s2.city from spj S,supplier s1,supplier s2 where S.sno=s1.sno and s2.sno=S.sno and s2.sno in (select s.sno+1 from supplier s);
+------------+------------+
| city       | city       |
+------------+------------+
| hanamkonda | hanamkonda |
| hanamkonda | hanamkonda |
| hyderabad  | hyderabad  |
| hyderabad  | hyderabad  |
| thrissur   | thrissur   |
| thrissur   | thrissur   |
| thrissur   | thrissur   |
| vijaywada  | vijaywada  |
| vijaywada  | vijaywada  |
+------------+------------+
9 rows in set (0.00 sec)

mysql> select sno,pno from (spj join supplier s on sno=s.sno)join part p on p.pno=pno where pno=sno+1;
ERROR 1052 (23000): Column 'sno' in field list is ambiguous
mysql> select S.sno,S.pno from (spj S join supplier s on S.sno=s.sno)join part p on p.pno=S.pno where S.pno=S.sno+1;
+-----+-----+
| sno | pno |
+-----+-----+
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   2 |   3 |
|   4 |   5 |
|   4 |   5 |
|   5 |   6 |
+-----+-----+
7 rows in set (0.00 sec)

mysql> select S.sno,S.pno,s.city,p.city from (spj S join supplier s on S.sno=s.sno)join part p on p.pno=S.pno where S.pno=S.sno+1;
+-----+-----+------------+------------+
| sno | pno | city       | city       |
+-----+-----+------------+------------+
|   1 |   2 | warangal   | warangal   |
|   1 |   2 | warangal   | warangal   |
|   1 |   2 | warangal   | warangal   |
|   2 |   3 | hanamkonda | hanamkonda |
|   4 |   5 | thrissur   | vijaywada  |
|   4 |   5 | thrissur   | vijaywada  |
|   5 |   6 | vijaywada  | hyderabad  |
+-----+-----+------------+------------+
7 rows in set (0.00 sec)

mysql> select distinct S.sno,S.pno,s.city,p.city from (spj S join supplier s on S.sno=s.sno)join part p on p.pno=S.pno where S.pno=S.sno+1;
+-----+-----+------------+------------+
| sno | pno | city       | city       |
+-----+-----+------------+------------+
|   1 |   2 | warangal   | warangal   |
|   2 |   3 | hanamkonda | hanamkonda |
|   4 |   5 | thrissur   | vijaywada  |
|   5 |   6 | vijaywada  | hyderabad  |
+-----+-----+------------+------------+
4 rows in set (0.00 sec)

mysql> select distinct S.sno from (spj S join supplier s on S.sno=s.sno)join part p on p.pno=S.pno where p.color='Red';
+-----+
| sno |
+-----+
|   2 |
+-----+
1 row in set (0.00 sec)

mysql> select sno from suppliers where status<(select max(status) from supplier);
ERROR 1146 (42S02): Table 'suppliers.suppliers' doesn't exist
mysql> select sno from supplier where status<(select max(status) from supplier);
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
|   7 |
+-----+
6 rows in set (0.00 sec)

mysql> select sno from spj where not exists (select * from spj where pno=2);
Empty set (0.00 sec)

mysql> select sno from spj where  exists (select * from spj where pno=2);
+-----+
| sno |
+-----+
|   1 |
|   1 |
|   3 |
|   4 |
|   5 |
|   1 |
|   1 |
|   1 |
|   2 |
|   3 |
|   2 |
|   4 |
|   4 |
|   5 |
+-----+
14 rows in set (0.00 sec)

mysql> select sno,pno from spj where  exists (select * from spj where pno=2);
+-----+-----+
| sno | pno |
+-----+-----+
|   1 |   1 |
|   1 |   1 |
|   3 |   1 |
|   4 |   1 |
|   5 |   1 |
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   2 |   2 |
|   3 |   2 |
|   2 |   3 |
|   4 |   5 |
|   4 |   5 |
|   5 |   6 |
+-----+-----+
14 rows in set (0.00 sec)

mysql> select sno,pno from spj where pno!=2;
+-----+-----+
| sno | pno |
+-----+-----+
|   1 |   1 |
|   1 |   1 |
|   3 |   1 |
|   4 |   1 |
|   5 |   1 |
|   2 |   3 |
|   4 |   5 |
|   4 |   5 |
|   5 |   6 |
+-----+-----+
9 rows in set (0.00 sec)

mysql> select sno,sname from supplier where exists (select sno,pno from spj where pno!=2;);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1
mysql> select sno,sname from supplier where exists (select sno,pno from spj where pno!=2);
+-----+---------+
| sno | sname   |
+-----+---------+
|   1 | Deva    |
|   2 | manasa  |
|   3 | sadwika |
|   4 | Hrishi  |
|   5 | Pawan   |
|   6 | Satya   |
|   7 | Ram     |
+-----+---------+
7 rows in set (0.00 sec)

mysql> select sno,sname from supplier where exists (select * from spj where pno!=2);
+-----+---------+
| sno | sname   |
+-----+---------+
|   1 | Deva    |
|   2 | manasa  |
|   3 | sadwika |
|   4 | Hrishi  |
|   5 | Pawan   |
|   6 | Satya   |
|   7 | Ram     |
+-----+---------+
7 rows in set (0.00 sec)

mysql> select sno,sname from supplier where not exists (select * from spj where pno=2);
Empty set (0.00 sec)

mysql> select sno,sname from supplier where sno in (select sno from spj where pno!=2);
+-----+---------+
| sno | sname   |
+-----+---------+
|   1 | Deva    |
|   2 | manasa  |
|   3 | sadwika |
|   4 | Hrishi  |
|   5 | Pawan   |
+-----+---------+
5 rows in set (0.01 sec)

mysql> select sno,sname from supplier s where sno in (select sno from spj S where pno!=2 and S.sno=s.sno);
+-----+---------+
| sno | sname   |
+-----+---------+
|   1 | Deva    |
|   2 | manasa  |
|   3 | sadwika |
|   4 | Hrishi  |
|   5 | Pawan   |
+-----+---------+
5 rows in set (0.00 sec)

mysql> select sno,sname from supplier s where exists (select sno from spj S where pno!=2 and S.sno=s.sno);
+-----+---------+
| sno | sname   |
+-----+---------+
|   1 | Deva    |
|   2 | manasa  |
|   3 | sadwika |
|   4 | Hrishi  |
|   5 | Pawan   |
+-----+---------+
5 rows in set (0.00 sec)

mysql> select sno,sname from supplier s where not exists (select sno from spj S where pno=2 and S.sno=s.sno);
+-----+--------+
| sno | sname  |
+-----+--------+
|   4 | Hrishi |
|   5 | Pawan  |
|   6 | Satya  |
|   7 | Ram    |
+-----+--------+
4 rows in set (0.00 sec)

mysql> select sno,sname from supplier s where s.sno not in (select sno from spj S where pno=2);
+-----+--------+
| sno | sname  |
+-----+--------+
|   4 | Hrishi |
|   5 | Pawan  |
|   6 | Satya  |
|   7 | Ram    |
+-----+--------+
4 rows in set (0.00 sec)

mysql> Cselect sno,sname from supplier s where not exists (select sno from spj S where pno=2 and S.sno=s.sno);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'Cselect sno,sname from supplier s where not exists (select sno from spj S where ' at line 1
mysql> select sno,pno from spj s where pno not in (select pno from spj s1 where s.sno=s1.sno);
Empty set (0.00 sec)

mysql> select s1.sno,s2.pno from spj s1 natural join spj s2 where s1.pno!=s2.pno;
Empty set (0.00 sec)

mysql> select s1.sno,s2.pno from spj s1, spj s2 where s1.sno=s2.sno and s1.pno!=s2.pno;
+-----+-----+
| sno | pno |
+-----+-----+
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   1 |   2 |
|   3 |   2 |
|   4 |   5 |
|   4 |   5 |
|   5 |   6 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   2 |   3 |
|   3 |   1 |
|   2 |   2 |
|   4 |   1 |
|   4 |   1 |
|   5 |   1 |
+-----+-----+
22 rows in set (0.01 sec)

mysql> select s1.sno,s2.pno from spj s1, spj s2 where s1.sno=s2.sno and s1.jno=s2.jno and s1.pno!=s2.pno;
+-----+-----+
| sno | pno |
+-----+-----+
|   1 |   2 |
|   3 |   2 |
|   1 |   1 |
|   3 |   1 |
+-----+-----+
4 rows in set (0.00 sec)

mysql> select S.sno,P.pno from spj S join part P on P.pno=S.pno where P.pno not in (select pno from spj);
Empty set (0.00 sec)

mysql> select S.sno,P.pno from spj S join part P on P.pno=S.pno where (S.sno,P.pno) not in (select sno,pno from spj);
Empty set (0.00 sec)

mysql> select S.sno,P.pno from spj S join part P on P.pno=S.pno where P.pno not in (select s.pno from spj s where s.sno=S.sno);
Empty set (0.00 sec)

mysql> select S.sno,P.pno from spj S join part P on P.pno=S.pno where (S.sno,P.pno) not in (select s.sno,s.pno from spj s s.sno=S.sno);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 's.sno=S.sno)' at line 1
mysql> select S.sno,P.pno from spj S join part P on P.pno=S.pno where P.pno not in (select s.pno from spj s where s.sno=S.sno);
Empty set (0.00 sec)

mysql> select S.sno,P.pno from spj S join part P on P.pno=S.pno where P.pno not in (select s.pno from spj ) group by S.sno;
ERROR 1054 (42S22): Unknown column 's.pno' in 'field list'
mysql> select S.sno,P.pno from spj S join part P on P.pno=S.pno where P.pno not in (select pno from spj ) group by S.sno;
ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'suppliers.P.pno' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> select S.sno,P.pno from spj S join part P on P.pno=S.pno where P.pno not in (select pno from spj group by S.sno);
Empty set (0.00 sec)

mysql> select S.sno,P.pno from spj S join part P on P.pno=S.pno where P.pno not in (select distinct pno from spj group by sno);
Empty set (0.00 sec)

mysql> select S.sno,P.pno from spj S,part P where P.pno not in (select distinct pno from spj group by sno);
+-----+-----+
| sno | pno |
+-----+-----+
|   1 |   4 |
|   1 |   4 |
|   3 |   4 |
|   4 |   4 |
|   5 |   4 |
|   1 |   4 |
|   1 |   4 |
|   1 |   4 |
|   2 |   4 |
|   3 |   4 |
|   2 |   4 |
|   4 |   4 |
|   4 |   4 |
|   5 |   4 |
+-----+-----+
14 rows in set (0.30 sec)

mysql> select S.sno,P.pno from spj S,part P where P.pno not in (select distinct pno from spj s where s.sno=S.sno);
+-----+-----+
| sno | pno |
+-----+-----+
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   3 |   3 |
|   3 |   4 |
|   3 |   5 |
|   3 |   6 |
|   4 |   2 |
|   4 |   3 |
|   4 |   4 |
|   4 |   6 |
|   5 |   2 |
|   5 |   3 |
|   5 |   4 |
|   5 |   5 |
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   1 |
|   2 |   4 |
|   2 |   5 |
|   2 |   6 |
|   3 |   3 |
|   3 |   4 |
|   3 |   5 |
|   3 |   6 |
|   2 |   1 |
|   2 |   4 |
|   2 |   5 |
|   2 |   6 |
|   4 |   2 |
|   4 |   3 |
|   4 |   4 |
|   4 |   6 |
|   4 |   2 |
|   4 |   3 |
|   4 |   4 |
|   4 |   6 |
|   5 |   2 |
|   5 |   3 |
|   5 |   4 |
|   5 |   5 |
+-----+-----+
56 rows in set (0.00 sec)

mysql> select distinct S.sno,P.pno from spj S,part P where P.pno not in (select distinct pno from spj s where s.sno=S.sno);
+-----+-----+
| sno | pno |
+-----+-----+
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   3 |   3 |
|   3 |   4 |
|   3 |   5 |
|   3 |   6 |
|   4 |   2 |
|   4 |   3 |
|   4 |   4 |
|   4 |   6 |
|   5 |   2 |
|   5 |   3 |
|   5 |   4 |
|   5 |   5 |
|   2 |   1 |
|   2 |   4 |
|   2 |   5 |
|   2 |   6 |
+-----+-----+
20 rows in set (0.01 sec)

mysql> insert into spj values (2,1,6,10);
Query OK, 1 row affected (0.32 sec)

mysql> insert into spj values (3,3,6,70);
Query OK, 1 row affected (0.32 sec)

mysql> quit
mysql> select sno,pno,count(jno) from spj group by sno,pno;
+-----+-----+------------+
| sno | pno | count(jno) |
+-----+-----+------------+
|   1 |   1 |          2 |
|   1 |   2 |          3 |
|   2 |   1 |          1 |
|   2 |   2 |          1 |
|   2 |   3 |          1 |
|   3 |   1 |          1 |
|   3 |   2 |          1 |
|   3 |   3 |          1 |
|   4 |   1 |          1 |
|   4 |   5 |          2 |
|   5 |   1 |          1 |
|   5 |   6 |          1 |
+-----+-----+------------+
12 rows in set (0.02 sec)

mysql> select sno,pno,count(*) from spj group by sno,pno;
+-----+-----+----------+
| sno | pno | count(*) |
+-----+-----+----------+
|   1 |   1 |        2 |
|   1 |   2 |        3 |
|   2 |   1 |        1 |
|   2 |   2 |        1 |
|   2 |   3 |        1 |
|   3 |   1 |        1 |
|   3 |   2 |        1 |
|   3 |   3 |        1 |
|   4 |   1 |        1 |
|   4 |   5 |        2 |
|   5 |   1 |        1 |
|   5 |   6 |        1 |
+-----+-----+----------+
12 rows in set (0.00 sec)

mysql> select count(jno) from project;
+------------+
| count(jno) |
+------------+
|          6 |
+------------+
1 row in set (0.00 sec)

mysql> insert into spj values (1,2,1,30);
Query OK, 1 row affected (0.09 sec)

mysql> insert into spj values (1,2,2,10);
ERROR 1062 (23000): Duplicate entry '1-2-2' for key 'PRIMARY'
mysql> insert into spj values (1,2,4,10);
Query OK, 1 row affected (0.05 sec)

mysql> insert into spj values (1,2,6,10);
Query OK, 1 row affected (0.05 sec)

mysql> select S.sno from spj S where exists (select sno,pno,count(*) from spj where S.sno=sno group by sno,pno having count(*)=(select count(*) from project));
+-----+
| sno |
+-----+
|   1 |
|   1 |
|   1 |
|   1 |
|   1 |
|   1 |
|   1 |
|   1 |
+-----+
8 rows in set (0.00 sec)

mysql> select distinct S.sno from spj S where exists (select sno,pno,count(*) from spj where S.sno=sno group by sno,pno having count(*)=(select count(*) from project));
+-----+
| sno |
+-----+
|   1 |
+-----+
1 row in set (0.01 sec)

mysql> select sno from spj where pno contains (select pno from spj where sno=2);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'contains (select pno from spj where sno=2)' at line 1
mysql> select sno from spj where contains (select pno from spj where sno=2);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select pno from spj where sno=2)' at line 1
mysql> select sno from spj where contains (select s.pno from spj s where s.sno=2);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select s.pno from spj s where s.sno=2)' at line 1
mysql> select sno from spj where contains (pno,select s.pno from spj s where s.sno=2);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select s.pno from spj s where s.sno=2)' at line 1
mysql> create view s2 (sno,pno,jno,qty) as (select sno,pno,jno from spj where sno=2);
ERROR 1353 (HY000): View's SELECT and view's field list have different column counts
mysql> select * from spj;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |
|   1 |   1 |   6 |   40 |
|   1 |   2 |   1 |   30 |
|   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |
|   1 |   2 |   4 |   10 |
|   1 |   2 |   5 |   30 |
|   1 |   2 |   6 |   10 |
|   2 |   1 |   6 |   10 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
|   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |
|   3 |   3 |   6 |   70 |
|   4 |   1 |   4 |   50 |
|   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |
|   5 |   1 |   1 |   80 |
|   5 |   6 |   5 |   10 |
+-----+-----+-----+------+
19 rows in set (0.00 sec)

mysql> create view s2 (sno,pno,jno,qty) as (select sno,pno,jno,qty from spj where sno=2);
Query OK, 0 rows affected (0.32 sec)

mysql> show s2;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 's2' at line 1
mysql> select * from s2;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   2 |   1 |   6 |   10 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
+-----+-----+-----+------+
3 rows in set (0.03 sec)

mysql> select s.sno from spj s,s2 S where s.pno=S.pno group by s.sno; 
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
+-----+
5 rows in set (0.29 sec)

mysql> select s.sno from spj s join s2 S on s.pno=S.pno group by s.sno;
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
+-----+
5 rows in set (0.00 sec)

mysql> select * from spj s join s2 S on s.pno=S.pno group by s.sno;
ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'suppliers.s.pno' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> select * from spj s join s2 S on s.pno=S.pno;
+-----+-----+-----+------+-----+-----+-----+------+
| sno | pno | jno | qty  | sno | pno | jno | qty  |
+-----+-----+-----+------+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |   2 |   1 |   6 |   10 |
|   1 |   1 |   6 |   40 |   2 |   1 |   6 |   10 |
|   2 |   1 |   6 |   10 |   2 |   1 |   6 |   10 |
|   3 |   1 |   1 |   60 |   2 |   1 |   6 |   10 |
|   4 |   1 |   4 |   50 |   2 |   1 |   6 |   10 |
|   5 |   1 |   1 |   80 |   2 |   1 |   6 |   10 |
|   1 |   2 |   1 |   30 |   2 |   2 |   1 |   40 |
|   1 |   2 |   2 |   50 |   2 |   2 |   1 |   40 |
|   1 |   2 |   3 |   20 |   2 |   2 |   1 |   40 |
|   1 |   2 |   4 |   10 |   2 |   2 |   1 |   40 |
|   1 |   2 |   5 |   30 |   2 |   2 |   1 |   40 |
|   1 |   2 |   6 |   10 |   2 |   2 |   1 |   40 |
|   2 |   2 |   1 |   40 |   2 |   2 |   1 |   40 |
|   3 |   2 |   1 |   50 |   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |   2 |   3 |   6 |   20 |
|   3 |   3 |   6 |   70 |   2 |   3 |   6 |   20 |
+-----+-----+-----+------+-----+-----+-----+------+
16 rows in set (0.00 sec)

mysql> select sno from spj where pno=(select pno from s2);
ERROR 1242 (21000): Subquery returns more than 1 row
mysql> select sno from spj where pno in (select pno from s2);
+-----+
| sno |
+-----+
|   1 |
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
|   1 |
|   1 |
|   1 |
|   1 |
|   1 |
|   1 |
|   2 |
|   3 |
|   2 |
|   3 |
+-----+
16 rows in set (0.00 sec)

mysql> select * from spj natural join s2;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   2 |   1 |   6 |   10 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
+-----+-----+-----+------+
3 rows in set (0.00 sec)

mysql> select count(*) from spj left natural join s2 on s2.pno=NULL;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'natural join s2 on s2.pno=NULL' at line 1
mysql> select count(*) from spj left natural join s2 on s2.pno='NULL';
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'natural join s2 on s2.pno='NULL'' at line 1
mysql> select count(*) from spj left natural join s2 on s2.pno is'NULL';
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'natural join s2 on s2.pno is'NULL'' at line 1
mysql> select count(*) from spj left natural join s2 where s2.pno is NULL;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'natural join s2 where s2.pno is NULL' at line 1
mysql> select s1.sno,s2.sno from spj s1,spj s2 where s1.pno=s2.pno group by s1.sno;
ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'suppliers.s2.sno' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> select s1.sno,s2.sno from spj s1,spj s2 where s1.pno=s2.pno;
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   1 |
|   1 |   1 |
|   1 |   2 |
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   1 |   1 |
|   1 |   1 |
|   1 |   2 |
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   2 |   1 |
|   2 |   1 |
|   2 |   2 |
|   2 |   3 |
|   2 |   4 |
|   2 |   5 |
|   3 |   1 |
|   3 |   1 |
|   3 |   2 |
|   3 |   3 |
|   3 |   4 |
|   3 |   5 |
|   4 |   1 |
|   4 |   1 |
|   4 |   2 |
|   4 |   3 |
|   4 |   4 |
|   4 |   5 |
|   5 |   1 |
|   5 |   1 |
|   5 |   2 |
|   5 |   3 |
|   5 |   4 |
|   5 |   5 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   2 |
|   1 |   3 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   2 |
|   1 |   3 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   2 |
|   1 |   3 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   2 |
|   1 |   3 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   2 |
|   1 |   3 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   1 |
|   1 |   2 |
|   1 |   3 |
|   2 |   1 |
|   2 |   1 |
|   2 |   1 |
|   2 |   1 |
|   2 |   1 |
|   2 |   1 |
|   2 |   2 |
|   2 |   3 |
|   3 |   1 |
|   3 |   1 |
|   3 |   1 |
|   3 |   1 |
|   3 |   1 |
|   3 |   1 |
|   3 |   2 |
|   3 |   3 |
|   2 |   2 |
|   2 |   3 |
|   3 |   2 |
|   3 |   3 |
|   4 |   4 |
|   4 |   4 |
|   4 |   4 |
|   4 |   4 |
|   5 |   5 |
+-----+-----+
109 rows in set (0.00 sec)

mysql> select s1.sno,s2.sno,s1.pno from spj s1,spj s2 where s1.pno=s2.pno;
+-----+-----+-----+
| sno | sno | pno |
+-----+-----+-----+
|   1 |   1 |   1 |
|   1 |   1 |   1 |
|   1 |   2 |   1 |
|   1 |   3 |   1 |
|   1 |   4 |   1 |
|   1 |   5 |   1 |
|   1 |   1 |   1 |
|   1 |   1 |   1 |
|   1 |   2 |   1 |
|   1 |   3 |   1 |
|   1 |   4 |   1 |
|   1 |   5 |   1 |
|   2 |   1 |   1 |
|   2 |   1 |   1 |
|   2 |   2 |   1 |
|   2 |   3 |   1 |
|   2 |   4 |   1 |
|   2 |   5 |   1 |
|   3 |   1 |   1 |
|   3 |   1 |   1 |
|   3 |   2 |   1 |
|   3 |   3 |   1 |
|   3 |   4 |   1 |
|   3 |   5 |   1 |
|   4 |   1 |   1 |
|   4 |   1 |   1 |
|   4 |   2 |   1 |
|   4 |   3 |   1 |
|   4 |   4 |   1 |
|   4 |   5 |   1 |
|   5 |   1 |   1 |
|   5 |   1 |   1 |
|   5 |   2 |   1 |
|   5 |   3 |   1 |
|   5 |   4 |   1 |
|   5 |   5 |   1 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   2 |   2 |
|   1 |   3 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   2 |   2 |
|   1 |   3 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   2 |   2 |
|   1 |   3 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   2 |   2 |
|   1 |   3 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   2 |   2 |
|   1 |   3 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   1 |   2 |
|   1 |   2 |   2 |
|   1 |   3 |   2 |
|   2 |   1 |   2 |
|   2 |   1 |   2 |
|   2 |   1 |   2 |
|   2 |   1 |   2 |
|   2 |   1 |   2 |
|   2 |   1 |   2 |
|   2 |   2 |   2 |
|   2 |   3 |   2 |
|   3 |   1 |   2 |
|   3 |   1 |   2 |
|   3 |   1 |   2 |
|   3 |   1 |   2 |
|   3 |   1 |   2 |
|   3 |   1 |   2 |
|   3 |   2 |   2 |
|   3 |   3 |   2 |
|   2 |   2 |   3 |
|   2 |   3 |   3 |
|   3 |   2 |   3 |
|   3 |   3 |   3 |
|   4 |   4 |   5 |
|   4 |   4 |   5 |
|   4 |   4 |   5 |
|   4 |   4 |   5 |
|   5 |   5 |   6 |
+-----+-----+-----+
109 rows in set (0.00 sec)

mysql> select s1.sno,s2.sno,s1.pno from spj s1,spj s2 where s1.pno=s2.pno group by s1.sno,s2.sno;
ERROR 1055 (42000): Expression #3 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'suppliers.s1.pno' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> select * from spj left natural join s2 on s2.pno is'NULL';
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'natural join s2 on s2.pno is'NULL'' at line 1
mysql> select * from spj left natural join s2 on s2.pno is 'NULL';
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'natural join s2 on s2.pno is 'NULL'' at line 1
mysql> select * from spj left natural join s2 on s2.pno is NULL;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'natural join s2 on s2.pno is NULL' at line 1
mysql> select * from spj left natural join s2 where s2.pno is NULL;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'natural join s2 where s2.pno is NULL' at line 1
mysql> select * from spj  natural left join s2 where s2.pno is NULL;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |
|   1 |   1 |   6 |   40 |
|   1 |   2 |   1 |   30 |
|   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |
|   1 |   2 |   4 |   10 |
|   1 |   2 |   5 |   30 |
|   1 |   2 |   6 |   10 |
|   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |
|   3 |   3 |   6 |   70 |
|   4 |   1 |   4 |   50 |
|   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |
|   5 |   1 |   1 |   80 |
|   5 |   6 |   5 |   10 |
+-----+-----+-----+------+
16 rows in set (0.02 sec)

mysql> select S.sno from spj S natural left join s2 where s2.pno is NULL group by S.sno;
+-----+
| sno |
+-----+
|   1 |
|   3 |
|   4 |
|   5 |
+-----+
4 rows in set (0.00 sec)

mysql> select S.sno from spj S natural right join s2 where s2.pno is NULL group by S.sno;
Empty set (0.00 sec)

mysql> select S.sno from spj S natural right join s2 where s.pno is NULL group by S.sno;
ERROR 1054 (42S22): Unknown column 's.pno' in 'where clause'
mysql> select S.sno from spj S natural right join s2 where S.pno is NULL group by S.sno;
Empty set (0.00 sec)

mysql> select * from spj S natural right join s2 where S.pno is NULL group by S.sno;
ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column 's2.pno' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> select * from spj;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |
|   1 |   1 |   6 |   40 |
|   1 |   2 |   1 |   30 |
|   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |
|   1 |   2 |   4 |   10 |
|   1 |   2 |   5 |   30 |
|   1 |   2 |   6 |   10 |
|   2 |   1 |   6 |   10 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
|   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |
|   3 |   3 |   6 |   70 |
|   4 |   1 |   4 |   50 |
|   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |
|   5 |   1 |   1 |   80 |
|   5 |   6 |   5 |   10 |
+-----+-----+-----+------+
19 rows in set (0.00 sec)

mysql> select sno from spj where not exists (select * from spj s where s.sno=snoand s.pno not in (select pno from spj where sno=2 ));
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 's.pno not in (select pno from spj where sno=2 ))' at line 1
mysql> select sno from spj where not exists (select * from spj s where s.sno=snoand s.pno not in (select s1.pno from spj s1 where s1.sno=2 ));
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 's.pno not in (select s1.pno from spj s1 where s1.sno=2 ))' at line 1
mysql> elect sno from spj where not exists (select * from spj s where s.sno=snoand s.pno not in (select s1.pno from spj s1 where s1.sno=2 ));
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'elect sno from spj where not exists (select * from spj s where s.sno=snoand s.pn' at line 1
mysql> elect sno from spj where not exists (select * from spj s where s.sno=sno and s.pno not in (select s1.pno from spj s1 where s1.sno=2 ));
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'elect sno from spj where not exists (select * from spj s where s.sno=sno and s.p' at line 1
mysql> select sno from spj where not exists (select * from spj s where s.sno=sno and s.pno not in (select s1.pno from spj s1 where s1.sno=2 ));
Empty set (0.00 sec)

mysql> select sno from spj where not exists (select * from spj s where s.sno=sno and pno not in (select s1.pno from spj s1 where s1.sno=2 ));
Empty set (0.00 sec)

mysql> select sno from spj where not exists (select * from spj s right natural join s2 where s.pno is NULL);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'natural join s2 where s.pno is NULL)' at line 1
mysql> select sno from spj where not exists (select * from spj s right natural join s2 where s.pno is NULL and s.sno=sno);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'natural join s2 where s.pno is NULL and s.sno=sno)' at line 1
mysql> select sno from spj where not exists (select * from spj s natural right join s2 where s.pno is NULL and s.sno=sno);
+-----+
| sno |
+-----+
|   1 |
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
|   1 |
|   1 |
|   1 |
|   1 |
|   1 |
|   1 |
|   2 |
|   3 |
|   2 |
|   3 |
|   4 |
|   4 |
|   5 |
+-----+
19 rows in set (0.00 sec)

mysql> select distinct sno from spj where not exists (select * from spj s natural right join s2 where s.pno is NULL and s.sno=sno);
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
+-----+
5 rows in set (0.01 sec)

mysql> ^C
mysql> select distinct sno from spj where exists (select * from spj s natural right join s2 where s.pno is NULL and s.sno=sno);
Empty set (0.00 sec)

mysql> ^C
mysql> 
mysql> select distinct sno from spj where not exists (select * from spj s natural right join s2 where s.pno is NULL and s.sno=sno);
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
+-----+
5 rows in set (0.00 sec)

mysql> select distinct sno from spj where not exists (select * from spj s natural right join s2 where s2.pno is NULL and s.sno=sno);
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
+-----+
5 rows in set (0.01 sec)

mysql> select distinct sno from spj where not exists (select * from spj s natural right join s2 where s.pno is NULL and s.sno=sno);
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
+-----+
5 rows in set (0.00 sec)

mysql> select * from spj s natural right join s2 where s.pno is NULL and s.sno=sno;
Empty set (0.00 sec)

mysql> select * from spj s natural right join s2 where s.pno is NULL;
Empty set (0.00 sec)

mysql> select * from spj s natural right join s2;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   2 |   1 |   6 |   10 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
+-----+-----+-----+------+
3 rows in set (0.00 sec)

mysql> select * from spj s natural right join s2;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   2 |   1 |   6 |   10 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
+-----+-----+-----+------+
3 rows in set (0.00 sec)

mysql> select distinct sno from spj where not exists (select * from spj s natural right join s2;);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1
mysql> select distinct sno from spj where not exists (select * from spj s natural right join s2);
Empty set (0.00 sec)

mysql> select distinct sno from spj where pno not in (select pno from spj s natural right join s2) group by sno;
+-----+
| sno |
+-----+
|   4 |
|   5 |
+-----+
2 rows in set (0.00 sec)

mysql> select * from spj s right join s2 on s2.pno=s.pno;
+------+------+------+------+-----+-----+-----+------+
| sno  | pno  | jno  | qty  | sno | pno | jno | qty  |
+------+------+------+------+-----+-----+-----+------+
|    1 |    1 |    2 |   20 |   2 |   1 |   6 |   10 |
|    1 |    1 |    6 |   40 |   2 |   1 |   6 |   10 |
|    2 |    1 |    6 |   10 |   2 |   1 |   6 |   10 |
|    3 |    1 |    1 |   60 |   2 |   1 |   6 |   10 |
|    4 |    1 |    4 |   50 |   2 |   1 |   6 |   10 |
|    5 |    1 |    1 |   80 |   2 |   1 |   6 |   10 |
|    1 |    2 |    1 |   30 |   2 |   2 |   1 |   40 |
|    1 |    2 |    2 |   50 |   2 |   2 |   1 |   40 |
|    1 |    2 |    3 |   20 |   2 |   2 |   1 |   40 |
|    1 |    2 |    4 |   10 |   2 |   2 |   1 |   40 |
|    1 |    2 |    5 |   30 |   2 |   2 |   1 |   40 |
|    1 |    2 |    6 |   10 |   2 |   2 |   1 |   40 |
|    2 |    2 |    1 |   40 |   2 |   2 |   1 |   40 |
|    3 |    2 |    1 |   50 |   2 |   2 |   1 |   40 |
|    2 |    3 |    6 |   20 |   2 |   3 |   6 |   20 |
|    3 |    3 |    6 |   70 |   2 |   3 |   6 |   20 |
+------+------+------+------+-----+-----+-----+------+
16 rows in set (0.00 sec)

mysql> select * from spj s right join s2 on s2.pno=s.pno where s.pno=NULL;
Empty set (0.00 sec)

mysql> select * from spj s right join s2 on s2.pno=s.pno where s.pno=NULL group by sno;
ERROR 1052 (23000): Column 'sno' in group statement is ambiguous
mysql> select * from spj s right join s2 on s2.pno=s.pno where s.pno=NULL group by s.sno;
ERROR 1055 (42000): Expression #3 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'suppliers.s.jno' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> select s.sno from spj s right join s2 on s2.pno=s.pno where s.pno=NULL group by s.sno;
Empty set (0.00 sec)

mysql> select s.sno from spj s right join s2 on s2.pno=s.pno where s2.pno=NULL group by s.sno;
Empty set (0.00 sec)

mysql> select distinct sno from spj where not exists (select * from spj s right outer join s2 where s.pno is NULL and s.sno=sno);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where s.pno is NULL and s.sno=sno)' at line 1
mysql> select distinct sno from spj where not exists (select * from spj s right join s2 where s.pno is NULL and s.sno=sno);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where s.pno is NULL and s.sno=sno)' at line 1
mysql> select distinct sno from spj where not exists (select * from spj s right outer join s2);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1
mysql> select distinct sno from spj where not exists (select * from spj s right  join s2);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1
mysql> select distinct sno from spj where not exists (select * from spj s left  join s2);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1
mysql> select distinct sno from spj where not exists (select * from spj s left  join s2 on s.sno=s2.sno);
Empty set (0.00 sec)

mysql> select distinct sno from spj where not exists (select * from spj s left  join s2 on s.sno=s2.sno and s.pno=s2.pno and s.jno=s2.jno);
Empty set (0.00 sec)

mysql> select distinct sno from spj where not exists (select * from spj s right  join s2 on s.sno=s2.sno and s.pno=s2.pno and s.jno=s2.jno where s.pno is NULL and sno=s.sno);
ERROR 1052 (23000): Column 'sno' in where clause is ambiguous
mysql> select distinct sno from spj where not exists (select * from spj s right  join s2 on s.sno=s2.sno and s.pno=s2.pno and s.jno=s2.jno where s.pno is NULL);
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
+-----+
5 rows in set (0.00 sec)

mysql> show schemas
    -> ;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| COMPANY            |
| Flight             |
| INSTITUTE          |
| mysql              |
| performance_schema |
| suppliers          |
| sys                |
| university         |
+--------------------+
9 rows in set (0.00 sec)

mysql> use Flight
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> use suppliers
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> select sno from spj where pno in all(select pno from spj where sno-=2);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'all(select pno from spj where sno-=2)' at line 1
mysql> select sno from spj where pno in all(select pno from spj where sno=2);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'all(select pno from spj where sno=2)' at line 1
mysql> (select pno from spj where sno=2);
+-----+
| pno |
+-----+
|   1 |
|   2 |
|   3 |
+-----+
3 rows in set (0.00 sec)

mysql> select distinct sno from spj where not exists (select * from spj s right  join s2 on s.sno=s2.sno and s.pno=s2.pno and s.jno=s2.jno where s.pno is NULL);
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
+-----+
5 rows in set (0.00 sec)

mysql> select distinct sno from spj where not exists (select * from spj s right  join s2 on s.pno=s2.pno where s.pno is NULL);
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
+-----+
5 rows in set (0.00 sec)

mysql> select distinct sno from spj where not exists (select * from spj s right  join s2 on s.pno=s2.pno where s.pno is NULL and sno=s.sno);
ERROR 1052 (23000): Column 'sno' in where clause is ambiguous
mysql> select distinct S.sno from spj S where not exists (select * from spj s right  join s2 on s.pno=s2.pno where s.pno is NULL and S.sno=s.sno);
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
+-----+
5 rows in set (0.00 sec)

mysql> (select * from spj s right outer join s2 on s.pno=s2.pno where s.pno is NULL and S.sno=s.sno);
ERROR 1054 (42S22): Unknown column 'S.sno' in 'where clause'
mysql> (select * from spj s right outer join s2 on s.pno=s2.pno where s.pno is NULL);
Empty set (0.00 sec)

mysql> (select * from spj s right outer join s2 on s.pno=s2.pno);
+------+------+------+------+-----+-----+-----+------+
| sno  | pno  | jno  | qty  | sno | pno | jno | qty  |
+------+------+------+------+-----+-----+-----+------+
|    1 |    1 |    2 |   20 |   2 |   1 |   6 |   10 |
|    1 |    1 |    6 |   40 |   2 |   1 |   6 |   10 |
|    2 |    1 |    6 |   10 |   2 |   1 |   6 |   10 |
|    3 |    1 |    1 |   60 |   2 |   1 |   6 |   10 |
|    4 |    1 |    4 |   50 |   2 |   1 |   6 |   10 |
|    5 |    1 |    1 |   80 |   2 |   1 |   6 |   10 |
|    1 |    2 |    1 |   30 |   2 |   2 |   1 |   40 |
|    1 |    2 |    2 |   50 |   2 |   2 |   1 |   40 |
|    1 |    2 |    3 |   20 |   2 |   2 |   1 |   40 |
|    1 |    2 |    4 |   10 |   2 |   2 |   1 |   40 |
|    1 |    2 |    5 |   30 |   2 |   2 |   1 |   40 |
|    1 |    2 |    6 |   10 |   2 |   2 |   1 |   40 |
|    2 |    2 |    1 |   40 |   2 |   2 |   1 |   40 |
|    3 |    2 |    1 |   50 |   2 |   2 |   1 |   40 |
|    2 |    3 |    6 |   20 |   2 |   3 |   6 |   20 |
|    3 |    3 |    6 |   70 |   2 |   3 |   6 |   20 |
+------+------+------+------+-----+-----+-----+------+
16 rows in set (0.00 sec)

mysql> (select * from spj s left outer join s2 on s.pno=s2.pno);
+-----+-----+-----+------+------+------+------+------+
| sno | pno | jno | qty  | sno  | pno  | jno  | qty  |
+-----+-----+-----+------+------+------+------+------+
|   1 |   1 |   2 |   20 |    2 |    1 |    6 |   10 |
|   1 |   1 |   6 |   40 |    2 |    1 |    6 |   10 |
|   1 |   2 |   1 |   30 |    2 |    2 |    1 |   40 |
|   1 |   2 |   2 |   50 |    2 |    2 |    1 |   40 |
|   1 |   2 |   3 |   20 |    2 |    2 |    1 |   40 |
|   1 |   2 |   4 |   10 |    2 |    2 |    1 |   40 |
|   1 |   2 |   5 |   30 |    2 |    2 |    1 |   40 |
|   1 |   2 |   6 |   10 |    2 |    2 |    1 |   40 |
|   2 |   1 |   6 |   10 |    2 |    1 |    6 |   10 |
|   2 |   2 |   1 |   40 |    2 |    2 |    1 |   40 |
|   2 |   3 |   6 |   20 |    2 |    3 |    6 |   20 |
|   3 |   1 |   1 |   60 |    2 |    1 |    6 |   10 |
|   3 |   2 |   1 |   50 |    2 |    2 |    1 |   40 |
|   3 |   3 |   6 |   70 |    2 |    3 |    6 |   20 |
|   4 |   1 |   4 |   50 |    2 |    1 |    6 |   10 |
|   4 |   5 |   1 |   10 | NULL | NULL | NULL | NULL |
|   4 |   5 |   5 |   50 | NULL | NULL | NULL | NULL |
|   5 |   1 |   1 |   80 |    2 |    1 |    6 |   10 |
|   5 |   6 |   5 |   10 | NULL | NULL | NULL | NULL |
+-----+-----+-----+------+------+------+------+------+
19 rows in set (0.00 sec)

mysql> (select * from spj s left outer join s2 on s.pno=s2.pno where s.pno is NULL);
Empty set (0.00 sec)

mysql> (select * from spj s left outer join s2 on s.pno=s2.pno where s.pno = NULL);
Empty set (0.00 sec)

mysql> (select * from spj s left outer join s2 on s.pno=s2.pno where s2.pno = NULL);
Empty set (0.00 sec)

mysql> (select * from spj s full outer join s2 on s.pno=s2.pno where s2.pno = NULL);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'full outer join s2 on s.pno=s2.pno where s2.pno = NULL)' at line 1
mysql> (select * from spj s outer join s2 on s.pno=s2.pno where s2.pno = NULL);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'outer join s2 on s.pno=s2.pno where s2.pno = NULL)' at line 1
mysql> (select * from spj s outer join s2 on s.pno=s2.pno);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'outer join s2 on s.pno=s2.pno)' at line 1
mysql> (select * from spj s  outer join s2 on s.pno=s2.pno);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'outer join s2 on s.pno=s2.pno)' at line 1
mysql> quit
mysql> (select * from spj s  outer join s2 on s.pno=s2.pno);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'outer join s2 on s.pno=s2.pno)' at line 1
mysql> (select * from spj s outer join s2 on s.pno=s2.pno);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'outer join s2 on s.pno=s2.pno)' at line 1
mysql> (select * from spj s join s2 on s.pno=s2.pno);
+-----+-----+-----+------+-----+-----+-----+------+
| sno | pno | jno | qty  | sno | pno | jno | qty  |
+-----+-----+-----+------+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |   2 |   1 |   6 |   10 |
|   1 |   1 |   6 |   40 |   2 |   1 |   6 |   10 |
|   2 |   1 |   6 |   10 |   2 |   1 |   6 |   10 |
|   3 |   1 |   1 |   60 |   2 |   1 |   6 |   10 |
|   4 |   1 |   4 |   50 |   2 |   1 |   6 |   10 |
|   5 |   1 |   1 |   80 |   2 |   1 |   6 |   10 |
|   1 |   2 |   1 |   30 |   2 |   2 |   1 |   40 |
|   1 |   2 |   2 |   50 |   2 |   2 |   1 |   40 |
|   1 |   2 |   3 |   20 |   2 |   2 |   1 |   40 |
|   1 |   2 |   4 |   10 |   2 |   2 |   1 |   40 |
|   1 |   2 |   5 |   30 |   2 |   2 |   1 |   40 |
|   1 |   2 |   6 |   10 |   2 |   2 |   1 |   40 |
|   2 |   2 |   1 |   40 |   2 |   2 |   1 |   40 |
|   3 |   2 |   1 |   50 |   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |   2 |   3 |   6 |   20 |
|   3 |   3 |   6 |   70 |   2 |   3 |   6 |   20 |
+-----+-----+-----+------+-----+-----+-----+------+
16 rows in set (0.04 sec)

mysql> select count(*) from s2 group by pno;
+----------+
| count(*) |
+----------+
|        1 |
|        1 |
|        1 |
+----------+
3 rows in set (0.00 sec)

mysql> select count(*) from s2 group by sno;
+----------+
| count(*) |
+----------+
|        3 |
+----------+
1 row in set (0.00 sec)

mysql> select s.sno,count(*) from spj s join s2 on s.pno=s2.pno group by s.sno;
+-----+----------+
| sno | count(*) |
+-----+----------+
|   1 |        8 |
|   2 |        3 |
|   3 |        3 |
|   4 |        1 |
|   5 |        1 |
+-----+----------+
5 rows in set (0.00 sec)

mysql> select s.sno,count(distinct pno) from spj s join s2 on s.pno=s2.pno group by s.sno;
ERROR 1052 (23000): Column 'pno' in field list is ambiguous
mysql> select s.sno,count(distinct s.pno) from spj s join s2 on s.pno=s2.pno group by s.sno;
+-----+-----------------------+
| sno | count(distinct s.pno) |
+-----+-----------------------+
|   1 |                     2 |
|   2 |                     3 |
|   3 |                     3 |
|   4 |                     1 |
|   5 |                     1 |
+-----+-----------------------+
5 rows in set (0.00 sec)

mysql> select sno from spj where sno!=2 and sno in ( select s.sno,count(distinct s.pno) from spj s join s2 on s.pno=s2.pno group by s.sno having count(distinct s.pno)=select count(*) from s2 group by sno);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'select count(*) from s2 group by sno)' at line 1
mysql> select sno from spj where sno!=2 and sno in ( select s.sno,count(distinct s.pno) from spj s join s2 on s.pno=s2.pno group by s.sno having count(distinct s.pno)=(select count(*) from s2 group by sno));
ERROR 1241 (21000): Operand should contain 1 column(s)
mysql> select sno from spj where sno!=2 and sno in ( select s.sno from spj s join s2 on s.pno=s2.pno group by s.sno having count(distinct s.pno)=(select count(*) from s2 group by sno));
+-----+
| sno |
+-----+
|   3 |
|   3 |
|   3 |
+-----+
3 rows in set (0.01 sec)

mysql> select distinct sno from spj where sno!=2 and sno in ( select s.sno from spj s join s2 on s.pno=s2.pno group by s.sno having count(distinct s.pno)=(select count(*) from s2 group by sno));
+-----+
| sno |
+-----+
|   3 |
+-----+
1 row in set (0.00 sec)

mysql> select * from project;
+-----+-------+------------+
| jno | jname | city       |
+-----+-------+------------+
|   1 | X     | hanamkonda |
|   2 | Y     | warangal   |
|   3 | Z     | thrissur   |
|   4 | A     | hyderabad  |
|   5 | B     | hyderabad  |
|   6 | C     | vijaywada  |
+-----+-------+------------+
6 rows in set (0.00 sec)

mysql> select sno from suppliers group by sno having count(distinct pno)=(select count(*) from project);
ERROR 1146 (42S02): Table 'suppliers.suppliers' doesn't exist
mysql> select sno from supplier group by sno having count(distinct pno)=(select count(*) from project);
ERROR 1054 (42S22): Unknown column 'pno' in 'having clause'
mysql> select sno from spj group by sno having count(distinct pno)=(select count(*) from project);
Empty set (0.00 sec)

mysql> select sno from spj group by sno;
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
|   4 |
|   5 |
+-----+
5 rows in set (0.00 sec)

mysql> select sno from spj group by sno having count(distinct pno)=6;
Empty set (0.01 sec)

mysql> select sno from spj group by sno having count(distinct jno)=(select count(*) from project);
+-----+
| sno |
+-----+
|   1 |
+-----+
1 row in set (0.00 sec)

mysql> select sno,pno from spj group by sno,pno having count(distinct jno)=(select count(*) from project);
+-----+-----+
| sno | pno |
+-----+-----+
|   1 |   2 |
+-----+-----+
1 row in set (0.00 sec)

mysql> create view v1 as (select * from spj s join spj s1 on s.pno=s1.pno);
ERROR 1060 (42S21): Duplicate column name 'sno'
mysql> select * from spj s,spj s1 ;
+-----+-----+-----+------+-----+-----+-----+------+
| sno | pno | jno | qty  | sno | pno | jno | qty  |
+-----+-----+-----+------+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |   1 |   1 |   2 |   20 |
|   1 |   1 |   6 |   40 |   1 |   1 |   2 |   20 |
|   1 |   2 |   1 |   30 |   1 |   1 |   2 |   20 |
|   1 |   2 |   2 |   50 |   1 |   1 |   2 |   20 |
|   1 |   2 |   3 |   20 |   1 |   1 |   2 |   20 |
|   1 |   2 |   4 |   10 |   1 |   1 |   2 |   20 |
|   1 |   2 |   5 |   30 |   1 |   1 |   2 |   20 |
|   1 |   2 |   6 |   10 |   1 |   1 |   2 |   20 |
|   2 |   1 |   6 |   10 |   1 |   1 |   2 |   20 |
|   2 |   2 |   1 |   40 |   1 |   1 |   2 |   20 |
|   2 |   3 |   6 |   20 |   1 |   1 |   2 |   20 |
|   3 |   1 |   1 |   60 |   1 |   1 |   2 |   20 |
|   3 |   2 |   1 |   50 |   1 |   1 |   2 |   20 |
|   3 |   3 |   6 |   70 |   1 |   1 |   2 |   20 |
|   4 |   1 |   4 |   50 |   1 |   1 |   2 |   20 |
|   4 |   5 |   1 |   10 |   1 |   1 |   2 |   20 |
|   4 |   5 |   5 |   50 |   1 |   1 |   2 |   20 |
|   5 |   1 |   1 |   80 |   1 |   1 |   2 |   20 |
|   5 |   6 |   5 |   10 |   1 |   1 |   2 |   20 |
|   1 |   1 |   2 |   20 |   1 |   1 |   6 |   40 |
|   1 |   1 |   6 |   40 |   1 |   1 |   6 |   40 |
|   1 |   2 |   1 |   30 |   1 |   1 |   6 |   40 |
|   1 |   2 |   2 |   50 |   1 |   1 |   6 |   40 |
|   1 |   2 |   3 |   20 |   1 |   1 |   6 |   40 |
|   1 |   2 |   4 |   10 |   1 |   1 |   6 |   40 |
|   1 |   2 |   5 |   30 |   1 |   1 |   6 |   40 |
|   1 |   2 |   6 |   10 |   1 |   1 |   6 |   40 |
|   2 |   1 |   6 |   10 |   1 |   1 |   6 |   40 |
|   2 |   2 |   1 |   40 |   1 |   1 |   6 |   40 |
|   2 |   3 |   6 |   20 |   1 |   1 |   6 |   40 |
|   3 |   1 |   1 |   60 |   1 |   1 |   6 |   40 |
|   3 |   2 |   1 |   50 |   1 |   1 |   6 |   40 |
|   3 |   3 |   6 |   70 |   1 |   1 |   6 |   40 |
|   4 |   1 |   4 |   50 |   1 |   1 |   6 |   40 |
|   4 |   5 |   1 |   10 |   1 |   1 |   6 |   40 |
|   4 |   5 |   5 |   50 |   1 |   1 |   6 |   40 |
|   5 |   1 |   1 |   80 |   1 |   1 |   6 |   40 |
|   5 |   6 |   5 |   10 |   1 |   1 |   6 |   40 |
|   1 |   1 |   2 |   20 |   1 |   2 |   1 |   30 |
|   1 |   1 |   6 |   40 |   1 |   2 |   1 |   30 |
|   1 |   2 |   1 |   30 |   1 |   2 |   1 |   30 |
|   1 |   2 |   2 |   50 |   1 |   2 |   1 |   30 |
|   1 |   2 |   3 |   20 |   1 |   2 |   1 |   30 |
|   1 |   2 |   4 |   10 |   1 |   2 |   1 |   30 |
|   1 |   2 |   5 |   30 |   1 |   2 |   1 |   30 |
|   1 |   2 |   6 |   10 |   1 |   2 |   1 |   30 |
|   2 |   1 |   6 |   10 |   1 |   2 |   1 |   30 |
|   2 |   2 |   1 |   40 |   1 |   2 |   1 |   30 |
|   2 |   3 |   6 |   20 |   1 |   2 |   1 |   30 |
|   3 |   1 |   1 |   60 |   1 |   2 |   1 |   30 |
|   3 |   2 |   1 |   50 |   1 |   2 |   1 |   30 |
|   3 |   3 |   6 |   70 |   1 |   2 |   1 |   30 |
|   4 |   1 |   4 |   50 |   1 |   2 |   1 |   30 |
|   4 |   5 |   1 |   10 |   1 |   2 |   1 |   30 |
|   4 |   5 |   5 |   50 |   1 |   2 |   1 |   30 |
|   5 |   1 |   1 |   80 |   1 |   2 |   1 |   30 |
|   5 |   6 |   5 |   10 |   1 |   2 |   1 |   30 |
|   1 |   1 |   2 |   20 |   1 |   2 |   2 |   50 |
|   1 |   1 |   6 |   40 |   1 |   2 |   2 |   50 |
|   1 |   2 |   1 |   30 |   1 |   2 |   2 |   50 |
|   1 |   2 |   2 |   50 |   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |   1 |   2 |   2 |   50 |
|   1 |   2 |   4 |   10 |   1 |   2 |   2 |   50 |
|   1 |   2 |   5 |   30 |   1 |   2 |   2 |   50 |
|   1 |   2 |   6 |   10 |   1 |   2 |   2 |   50 |
|   2 |   1 |   6 |   10 |   1 |   2 |   2 |   50 |
|   2 |   2 |   1 |   40 |   1 |   2 |   2 |   50 |
|   2 |   3 |   6 |   20 |   1 |   2 |   2 |   50 |
|   3 |   1 |   1 |   60 |   1 |   2 |   2 |   50 |
|   3 |   2 |   1 |   50 |   1 |   2 |   2 |   50 |
|   3 |   3 |   6 |   70 |   1 |   2 |   2 |   50 |
|   4 |   1 |   4 |   50 |   1 |   2 |   2 |   50 |
|   4 |   5 |   1 |   10 |   1 |   2 |   2 |   50 |
|   4 |   5 |   5 |   50 |   1 |   2 |   2 |   50 |
|   5 |   1 |   1 |   80 |   1 |   2 |   2 |   50 |
|   5 |   6 |   5 |   10 |   1 |   2 |   2 |   50 |
|   1 |   1 |   2 |   20 |   1 |   2 |   3 |   20 |
|   1 |   1 |   6 |   40 |   1 |   2 |   3 |   20 |
|   1 |   2 |   1 |   30 |   1 |   2 |   3 |   20 |
|   1 |   2 |   2 |   50 |   1 |   2 |   3 |   20 |
|   1 |   2 |   3 |   20 |   1 |   2 |   3 |   20 |
|   1 |   2 |   4 |   10 |   1 |   2 |   3 |   20 |
|   1 |   2 |   5 |   30 |   1 |   2 |   3 |   20 |
|   1 |   2 |   6 |   10 |   1 |   2 |   3 |   20 |
|   2 |   1 |   6 |   10 |   1 |   2 |   3 |   20 |
|   2 |   2 |   1 |   40 |   1 |   2 |   3 |   20 |
|   2 |   3 |   6 |   20 |   1 |   2 |   3 |   20 |
|   3 |   1 |   1 |   60 |   1 |   2 |   3 |   20 |
|   3 |   2 |   1 |   50 |   1 |   2 |   3 |   20 |
|   3 |   3 |   6 |   70 |   1 |   2 |   3 |   20 |
|   4 |   1 |   4 |   50 |   1 |   2 |   3 |   20 |
|   4 |   5 |   1 |   10 |   1 |   2 |   3 |   20 |
|   4 |   5 |   5 |   50 |   1 |   2 |   3 |   20 |
|   5 |   1 |   1 |   80 |   1 |   2 |   3 |   20 |
|   5 |   6 |   5 |   10 |   1 |   2 |   3 |   20 |
|   1 |   1 |   2 |   20 |   1 |   2 |   4 |   10 |
|   1 |   1 |   6 |   40 |   1 |   2 |   4 |   10 |
|   1 |   2 |   1 |   30 |   1 |   2 |   4 |   10 |
|   1 |   2 |   2 |   50 |   1 |   2 |   4 |   10 |
|   1 |   2 |   3 |   20 |   1 |   2 |   4 |   10 |
|   1 |   2 |   4 |   10 |   1 |   2 |   4 |   10 |
|   1 |   2 |   5 |   30 |   1 |   2 |   4 |   10 |
|   1 |   2 |   6 |   10 |   1 |   2 |   4 |   10 |
|   2 |   1 |   6 |   10 |   1 |   2 |   4 |   10 |
|   2 |   2 |   1 |   40 |   1 |   2 |   4 |   10 |
|   2 |   3 |   6 |   20 |   1 |   2 |   4 |   10 |
|   3 |   1 |   1 |   60 |   1 |   2 |   4 |   10 |
|   3 |   2 |   1 |   50 |   1 |   2 |   4 |   10 |
|   3 |   3 |   6 |   70 |   1 |   2 |   4 |   10 |
|   4 |   1 |   4 |   50 |   1 |   2 |   4 |   10 |
|   4 |   5 |   1 |   10 |   1 |   2 |   4 |   10 |
|   4 |   5 |   5 |   50 |   1 |   2 |   4 |   10 |
|   5 |   1 |   1 |   80 |   1 |   2 |   4 |   10 |
|   5 |   6 |   5 |   10 |   1 |   2 |   4 |   10 |
|   1 |   1 |   2 |   20 |   1 |   2 |   5 |   30 |
|   1 |   1 |   6 |   40 |   1 |   2 |   5 |   30 |
|   1 |   2 |   1 |   30 |   1 |   2 |   5 |   30 |
|   1 |   2 |   2 |   50 |   1 |   2 |   5 |   30 |
|   1 |   2 |   3 |   20 |   1 |   2 |   5 |   30 |
|   1 |   2 |   4 |   10 |   1 |   2 |   5 |   30 |
|   1 |   2 |   5 |   30 |   1 |   2 |   5 |   30 |
|   1 |   2 |   6 |   10 |   1 |   2 |   5 |   30 |
|   2 |   1 |   6 |   10 |   1 |   2 |   5 |   30 |
|   2 |   2 |   1 |   40 |   1 |   2 |   5 |   30 |
|   2 |   3 |   6 |   20 |   1 |   2 |   5 |   30 |
|   3 |   1 |   1 |   60 |   1 |   2 |   5 |   30 |
|   3 |   2 |   1 |   50 |   1 |   2 |   5 |   30 |
|   3 |   3 |   6 |   70 |   1 |   2 |   5 |   30 |
|   4 |   1 |   4 |   50 |   1 |   2 |   5 |   30 |
|   4 |   5 |   1 |   10 |   1 |   2 |   5 |   30 |
|   4 |   5 |   5 |   50 |   1 |   2 |   5 |   30 |
|   5 |   1 |   1 |   80 |   1 |   2 |   5 |   30 |
|   5 |   6 |   5 |   10 |   1 |   2 |   5 |   30 |
|   1 |   1 |   2 |   20 |   1 |   2 |   6 |   10 |
|   1 |   1 |   6 |   40 |   1 |   2 |   6 |   10 |
|   1 |   2 |   1 |   30 |   1 |   2 |   6 |   10 |
|   1 |   2 |   2 |   50 |   1 |   2 |   6 |   10 |
|   1 |   2 |   3 |   20 |   1 |   2 |   6 |   10 |
|   1 |   2 |   4 |   10 |   1 |   2 |   6 |   10 |
|   1 |   2 |   5 |   30 |   1 |   2 |   6 |   10 |
|   1 |   2 |   6 |   10 |   1 |   2 |   6 |   10 |
|   2 |   1 |   6 |   10 |   1 |   2 |   6 |   10 |
|   2 |   2 |   1 |   40 |   1 |   2 |   6 |   10 |
|   2 |   3 |   6 |   20 |   1 |   2 |   6 |   10 |
|   3 |   1 |   1 |   60 |   1 |   2 |   6 |   10 |
|   3 |   2 |   1 |   50 |   1 |   2 |   6 |   10 |
|   3 |   3 |   6 |   70 |   1 |   2 |   6 |   10 |
|   4 |   1 |   4 |   50 |   1 |   2 |   6 |   10 |
|   4 |   5 |   1 |   10 |   1 |   2 |   6 |   10 |
|   4 |   5 |   5 |   50 |   1 |   2 |   6 |   10 |
|   5 |   1 |   1 |   80 |   1 |   2 |   6 |   10 |
|   5 |   6 |   5 |   10 |   1 |   2 |   6 |   10 |
|   1 |   1 |   2 |   20 |   2 |   1 |   6 |   10 |
|   1 |   1 |   6 |   40 |   2 |   1 |   6 |   10 |
|   1 |   2 |   1 |   30 |   2 |   1 |   6 |   10 |
|   1 |   2 |   2 |   50 |   2 |   1 |   6 |   10 |
|   1 |   2 |   3 |   20 |   2 |   1 |   6 |   10 |
|   1 |   2 |   4 |   10 |   2 |   1 |   6 |   10 |
|   1 |   2 |   5 |   30 |   2 |   1 |   6 |   10 |
|   1 |   2 |   6 |   10 |   2 |   1 |   6 |   10 |
|   2 |   1 |   6 |   10 |   2 |   1 |   6 |   10 |
|   2 |   2 |   1 |   40 |   2 |   1 |   6 |   10 |
|   2 |   3 |   6 |   20 |   2 |   1 |   6 |   10 |
|   3 |   1 |   1 |   60 |   2 |   1 |   6 |   10 |
|   3 |   2 |   1 |   50 |   2 |   1 |   6 |   10 |
|   3 |   3 |   6 |   70 |   2 |   1 |   6 |   10 |
|   4 |   1 |   4 |   50 |   2 |   1 |   6 |   10 |
|   4 |   5 |   1 |   10 |   2 |   1 |   6 |   10 |
|   4 |   5 |   5 |   50 |   2 |   1 |   6 |   10 |
|   5 |   1 |   1 |   80 |   2 |   1 |   6 |   10 |
|   5 |   6 |   5 |   10 |   2 |   1 |   6 |   10 |
|   1 |   1 |   2 |   20 |   2 |   2 |   1 |   40 |
|   1 |   1 |   6 |   40 |   2 |   2 |   1 |   40 |
|   1 |   2 |   1 |   30 |   2 |   2 |   1 |   40 |
|   1 |   2 |   2 |   50 |   2 |   2 |   1 |   40 |
|   1 |   2 |   3 |   20 |   2 |   2 |   1 |   40 |
|   1 |   2 |   4 |   10 |   2 |   2 |   1 |   40 |
|   1 |   2 |   5 |   30 |   2 |   2 |   1 |   40 |
|   1 |   2 |   6 |   10 |   2 |   2 |   1 |   40 |
|   2 |   1 |   6 |   10 |   2 |   2 |   1 |   40 |
|   2 |   2 |   1 |   40 |   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |   2 |   2 |   1 |   40 |
|   3 |   1 |   1 |   60 |   2 |   2 |   1 |   40 |
|   3 |   2 |   1 |   50 |   2 |   2 |   1 |   40 |
|   3 |   3 |   6 |   70 |   2 |   2 |   1 |   40 |
|   4 |   1 |   4 |   50 |   2 |   2 |   1 |   40 |
|   4 |   5 |   1 |   10 |   2 |   2 |   1 |   40 |
|   4 |   5 |   5 |   50 |   2 |   2 |   1 |   40 |
|   5 |   1 |   1 |   80 |   2 |   2 |   1 |   40 |
|   5 |   6 |   5 |   10 |   2 |   2 |   1 |   40 |
|   1 |   1 |   2 |   20 |   2 |   3 |   6 |   20 |
|   1 |   1 |   6 |   40 |   2 |   3 |   6 |   20 |
|   1 |   2 |   1 |   30 |   2 |   3 |   6 |   20 |
|   1 |   2 |   2 |   50 |   2 |   3 |   6 |   20 |
|   1 |   2 |   3 |   20 |   2 |   3 |   6 |   20 |
|   1 |   2 |   4 |   10 |   2 |   3 |   6 |   20 |
|   1 |   2 |   5 |   30 |   2 |   3 |   6 |   20 |
|   1 |   2 |   6 |   10 |   2 |   3 |   6 |   20 |
|   2 |   1 |   6 |   10 |   2 |   3 |   6 |   20 |
|   2 |   2 |   1 |   40 |   2 |   3 |   6 |   20 |
|   2 |   3 |   6 |   20 |   2 |   3 |   6 |   20 |
|   3 |   1 |   1 |   60 |   2 |   3 |   6 |   20 |
|   3 |   2 |   1 |   50 |   2 |   3 |   6 |   20 |
|   3 |   3 |   6 |   70 |   2 |   3 |   6 |   20 |
|   4 |   1 |   4 |   50 |   2 |   3 |   6 |   20 |
|   4 |   5 |   1 |   10 |   2 |   3 |   6 |   20 |
|   4 |   5 |   5 |   50 |   2 |   3 |   6 |   20 |
|   5 |   1 |   1 |   80 |   2 |   3 |   6 |   20 |
|   5 |   6 |   5 |   10 |   2 |   3 |   6 |   20 |
|   1 |   1 |   2 |   20 |   3 |   1 |   1 |   60 |
|   1 |   1 |   6 |   40 |   3 |   1 |   1 |   60 |
|   1 |   2 |   1 |   30 |   3 |   1 |   1 |   60 |
|   1 |   2 |   2 |   50 |   3 |   1 |   1 |   60 |
|   1 |   2 |   3 |   20 |   3 |   1 |   1 |   60 |
|   1 |   2 |   4 |   10 |   3 |   1 |   1 |   60 |
|   1 |   2 |   5 |   30 |   3 |   1 |   1 |   60 |
|   1 |   2 |   6 |   10 |   3 |   1 |   1 |   60 |
|   2 |   1 |   6 |   10 |   3 |   1 |   1 |   60 |
|   2 |   2 |   1 |   40 |   3 |   1 |   1 |   60 |
|   2 |   3 |   6 |   20 |   3 |   1 |   1 |   60 |
|   3 |   1 |   1 |   60 |   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |   3 |   1 |   1 |   60 |
|   3 |   3 |   6 |   70 |   3 |   1 |   1 |   60 |
|   4 |   1 |   4 |   50 |   3 |   1 |   1 |   60 |
|   4 |   5 |   1 |   10 |   3 |   1 |   1 |   60 |
|   4 |   5 |   5 |   50 |   3 |   1 |   1 |   60 |
|   5 |   1 |   1 |   80 |   3 |   1 |   1 |   60 |
|   5 |   6 |   5 |   10 |   3 |   1 |   1 |   60 |
|   1 |   1 |   2 |   20 |   3 |   2 |   1 |   50 |
|   1 |   1 |   6 |   40 |   3 |   2 |   1 |   50 |
|   1 |   2 |   1 |   30 |   3 |   2 |   1 |   50 |
|   1 |   2 |   2 |   50 |   3 |   2 |   1 |   50 |
|   1 |   2 |   3 |   20 |   3 |   2 |   1 |   50 |
|   1 |   2 |   4 |   10 |   3 |   2 |   1 |   50 |
|   1 |   2 |   5 |   30 |   3 |   2 |   1 |   50 |
|   1 |   2 |   6 |   10 |   3 |   2 |   1 |   50 |
|   2 |   1 |   6 |   10 |   3 |   2 |   1 |   50 |
|   2 |   2 |   1 |   40 |   3 |   2 |   1 |   50 |
|   2 |   3 |   6 |   20 |   3 |   2 |   1 |   50 |
|   3 |   1 |   1 |   60 |   3 |   2 |   1 |   50 |
|   3 |   2 |   1 |   50 |   3 |   2 |   1 |   50 |
|   3 |   3 |   6 |   70 |   3 |   2 |   1 |   50 |
|   4 |   1 |   4 |   50 |   3 |   2 |   1 |   50 |
|   4 |   5 |   1 |   10 |   3 |   2 |   1 |   50 |
|   4 |   5 |   5 |   50 |   3 |   2 |   1 |   50 |
|   5 |   1 |   1 |   80 |   3 |   2 |   1 |   50 |
|   5 |   6 |   5 |   10 |   3 |   2 |   1 |   50 |
|   1 |   1 |   2 |   20 |   3 |   3 |   6 |   70 |
|   1 |   1 |   6 |   40 |   3 |   3 |   6 |   70 |
|   1 |   2 |   1 |   30 |   3 |   3 |   6 |   70 |
|   1 |   2 |   2 |   50 |   3 |   3 |   6 |   70 |
|   1 |   2 |   3 |   20 |   3 |   3 |   6 |   70 |
|   1 |   2 |   4 |   10 |   3 |   3 |   6 |   70 |
|   1 |   2 |   5 |   30 |   3 |   3 |   6 |   70 |
|   1 |   2 |   6 |   10 |   3 |   3 |   6 |   70 |
|   2 |   1 |   6 |   10 |   3 |   3 |   6 |   70 |
|   2 |   2 |   1 |   40 |   3 |   3 |   6 |   70 |
|   2 |   3 |   6 |   20 |   3 |   3 |   6 |   70 |
|   3 |   1 |   1 |   60 |   3 |   3 |   6 |   70 |
|   3 |   2 |   1 |   50 |   3 |   3 |   6 |   70 |
|   3 |   3 |   6 |   70 |   3 |   3 |   6 |   70 |
|   4 |   1 |   4 |   50 |   3 |   3 |   6 |   70 |
|   4 |   5 |   1 |   10 |   3 |   3 |   6 |   70 |
|   4 |   5 |   5 |   50 |   3 |   3 |   6 |   70 |
|   5 |   1 |   1 |   80 |   3 |   3 |   6 |   70 |
|   5 |   6 |   5 |   10 |   3 |   3 |   6 |   70 |
|   1 |   1 |   2 |   20 |   4 |   1 |   4 |   50 |
|   1 |   1 |   6 |   40 |   4 |   1 |   4 |   50 |
|   1 |   2 |   1 |   30 |   4 |   1 |   4 |   50 |
|   1 |   2 |   2 |   50 |   4 |   1 |   4 |   50 |
|   1 |   2 |   3 |   20 |   4 |   1 |   4 |   50 |
|   1 |   2 |   4 |   10 |   4 |   1 |   4 |   50 |
|   1 |   2 |   5 |   30 |   4 |   1 |   4 |   50 |
|   1 |   2 |   6 |   10 |   4 |   1 |   4 |   50 |
|   2 |   1 |   6 |   10 |   4 |   1 |   4 |   50 |
|   2 |   2 |   1 |   40 |   4 |   1 |   4 |   50 |
|   2 |   3 |   6 |   20 |   4 |   1 |   4 |   50 |
|   3 |   1 |   1 |   60 |   4 |   1 |   4 |   50 |
|   3 |   2 |   1 |   50 |   4 |   1 |   4 |   50 |
|   3 |   3 |   6 |   70 |   4 |   1 |   4 |   50 |
|   4 |   1 |   4 |   50 |   4 |   1 |   4 |   50 |
|   4 |   5 |   1 |   10 |   4 |   1 |   4 |   50 |
|   4 |   5 |   5 |   50 |   4 |   1 |   4 |   50 |
|   5 |   1 |   1 |   80 |   4 |   1 |   4 |   50 |
|   5 |   6 |   5 |   10 |   4 |   1 |   4 |   50 |
|   1 |   1 |   2 |   20 |   4 |   5 |   1 |   10 |
|   1 |   1 |   6 |   40 |   4 |   5 |   1 |   10 |
|   1 |   2 |   1 |   30 |   4 |   5 |   1 |   10 |
|   1 |   2 |   2 |   50 |   4 |   5 |   1 |   10 |
|   1 |   2 |   3 |   20 |   4 |   5 |   1 |   10 |
|   1 |   2 |   4 |   10 |   4 |   5 |   1 |   10 |
|   1 |   2 |   5 |   30 |   4 |   5 |   1 |   10 |
|   1 |   2 |   6 |   10 |   4 |   5 |   1 |   10 |
|   2 |   1 |   6 |   10 |   4 |   5 |   1 |   10 |
|   2 |   2 |   1 |   40 |   4 |   5 |   1 |   10 |
|   2 |   3 |   6 |   20 |   4 |   5 |   1 |   10 |
|   3 |   1 |   1 |   60 |   4 |   5 |   1 |   10 |
|   3 |   2 |   1 |   50 |   4 |   5 |   1 |   10 |
|   3 |   3 |   6 |   70 |   4 |   5 |   1 |   10 |
|   4 |   1 |   4 |   50 |   4 |   5 |   1 |   10 |
|   4 |   5 |   1 |   10 |   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |   4 |   5 |   1 |   10 |
|   5 |   1 |   1 |   80 |   4 |   5 |   1 |   10 |
|   5 |   6 |   5 |   10 |   4 |   5 |   1 |   10 |
|   1 |   1 |   2 |   20 |   4 |   5 |   5 |   50 |
|   1 |   1 |   6 |   40 |   4 |   5 |   5 |   50 |
|   1 |   2 |   1 |   30 |   4 |   5 |   5 |   50 |
|   1 |   2 |   2 |   50 |   4 |   5 |   5 |   50 |
|   1 |   2 |   3 |   20 |   4 |   5 |   5 |   50 |
|   1 |   2 |   4 |   10 |   4 |   5 |   5 |   50 |
|   1 |   2 |   5 |   30 |   4 |   5 |   5 |   50 |
|   1 |   2 |   6 |   10 |   4 |   5 |   5 |   50 |
|   2 |   1 |   6 |   10 |   4 |   5 |   5 |   50 |
|   2 |   2 |   1 |   40 |   4 |   5 |   5 |   50 |
|   2 |   3 |   6 |   20 |   4 |   5 |   5 |   50 |
|   3 |   1 |   1 |   60 |   4 |   5 |   5 |   50 |
|   3 |   2 |   1 |   50 |   4 |   5 |   5 |   50 |
|   3 |   3 |   6 |   70 |   4 |   5 |   5 |   50 |
|   4 |   1 |   4 |   50 |   4 |   5 |   5 |   50 |
|   4 |   5 |   1 |   10 |   4 |   5 |   5 |   50 |
|   4 |   5 |   5 |   50 |   4 |   5 |   5 |   50 |
|   5 |   1 |   1 |   80 |   4 |   5 |   5 |   50 |
|   5 |   6 |   5 |   10 |   4 |   5 |   5 |   50 |
|   1 |   1 |   2 |   20 |   5 |   1 |   1 |   80 |
|   1 |   1 |   6 |   40 |   5 |   1 |   1 |   80 |
|   1 |   2 |   1 |   30 |   5 |   1 |   1 |   80 |
|   1 |   2 |   2 |   50 |   5 |   1 |   1 |   80 |
|   1 |   2 |   3 |   20 |   5 |   1 |   1 |   80 |
|   1 |   2 |   4 |   10 |   5 |   1 |   1 |   80 |
|   1 |   2 |   5 |   30 |   5 |   1 |   1 |   80 |
|   1 |   2 |   6 |   10 |   5 |   1 |   1 |   80 |
|   2 |   1 |   6 |   10 |   5 |   1 |   1 |   80 |
|   2 |   2 |   1 |   40 |   5 |   1 |   1 |   80 |
|   2 |   3 |   6 |   20 |   5 |   1 |   1 |   80 |
|   3 |   1 |   1 |   60 |   5 |   1 |   1 |   80 |
|   3 |   2 |   1 |   50 |   5 |   1 |   1 |   80 |
|   3 |   3 |   6 |   70 |   5 |   1 |   1 |   80 |
|   4 |   1 |   4 |   50 |   5 |   1 |   1 |   80 |
|   4 |   5 |   1 |   10 |   5 |   1 |   1 |   80 |
|   4 |   5 |   5 |   50 |   5 |   1 |   1 |   80 |
|   5 |   1 |   1 |   80 |   5 |   1 |   1 |   80 |
|   5 |   6 |   5 |   10 |   5 |   1 |   1 |   80 |
|   1 |   1 |   2 |   20 |   5 |   6 |   5 |   10 |
|   1 |   1 |   6 |   40 |   5 |   6 |   5 |   10 |
|   1 |   2 |   1 |   30 |   5 |   6 |   5 |   10 |
|   1 |   2 |   2 |   50 |   5 |   6 |   5 |   10 |
|   1 |   2 |   3 |   20 |   5 |   6 |   5 |   10 |
|   1 |   2 |   4 |   10 |   5 |   6 |   5 |   10 |
|   1 |   2 |   5 |   30 |   5 |   6 |   5 |   10 |
|   1 |   2 |   6 |   10 |   5 |   6 |   5 |   10 |
|   2 |   1 |   6 |   10 |   5 |   6 |   5 |   10 |
|   2 |   2 |   1 |   40 |   5 |   6 |   5 |   10 |
|   2 |   3 |   6 |   20 |   5 |   6 |   5 |   10 |
|   3 |   1 |   1 |   60 |   5 |   6 |   5 |   10 |
|   3 |   2 |   1 |   50 |   5 |   6 |   5 |   10 |
|   3 |   3 |   6 |   70 |   5 |   6 |   5 |   10 |
|   4 |   1 |   4 |   50 |   5 |   6 |   5 |   10 |
|   4 |   5 |   1 |   10 |   5 |   6 |   5 |   10 |
|   4 |   5 |   5 |   50 |   5 |   6 |   5 |   10 |
|   5 |   1 |   1 |   80 |   5 |   6 |   5 |   10 |
|   5 |   6 |   5 |   10 |   5 |   6 |   5 |   10 |
+-----+-----+-----+------+-----+-----+-----+------+
361 rows in set (0.30 sec)

mysql> select * from spj s join spj s1 on s.pno=s1.pno ;
+-----+-----+-----+------+-----+-----+-----+------+
| sno | pno | jno | qty  | sno | pno | jno | qty  |
+-----+-----+-----+------+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |   1 |   1 |   2 |   20 |
|   1 |   1 |   2 |   20 |   1 |   1 |   6 |   40 |
|   1 |   1 |   2 |   20 |   2 |   1 |   6 |   10 |
|   1 |   1 |   2 |   20 |   3 |   1 |   1 |   60 |
|   1 |   1 |   2 |   20 |   4 |   1 |   4 |   50 |
|   1 |   1 |   2 |   20 |   5 |   1 |   1 |   80 |
|   1 |   1 |   6 |   40 |   1 |   1 |   2 |   20 |
|   1 |   1 |   6 |   40 |   1 |   1 |   6 |   40 |
|   1 |   1 |   6 |   40 |   2 |   1 |   6 |   10 |
|   1 |   1 |   6 |   40 |   3 |   1 |   1 |   60 |
|   1 |   1 |   6 |   40 |   4 |   1 |   4 |   50 |
|   1 |   1 |   6 |   40 |   5 |   1 |   1 |   80 |
|   1 |   2 |   1 |   30 |   1 |   2 |   1 |   30 |
|   1 |   2 |   1 |   30 |   1 |   2 |   2 |   50 |
|   1 |   2 |   1 |   30 |   1 |   2 |   3 |   20 |
|   1 |   2 |   1 |   30 |   1 |   2 |   4 |   10 |
|   1 |   2 |   1 |   30 |   1 |   2 |   5 |   30 |
|   1 |   2 |   1 |   30 |   1 |   2 |   6 |   10 |
|   1 |   2 |   1 |   30 |   2 |   2 |   1 |   40 |
|   1 |   2 |   1 |   30 |   3 |   2 |   1 |   50 |
|   1 |   2 |   2 |   50 |   1 |   2 |   1 |   30 |
|   1 |   2 |   2 |   50 |   1 |   2 |   2 |   50 |
|   1 |   2 |   2 |   50 |   1 |   2 |   3 |   20 |
|   1 |   2 |   2 |   50 |   1 |   2 |   4 |   10 |
|   1 |   2 |   2 |   50 |   1 |   2 |   5 |   30 |
|   1 |   2 |   2 |   50 |   1 |   2 |   6 |   10 |
|   1 |   2 |   2 |   50 |   2 |   2 |   1 |   40 |
|   1 |   2 |   2 |   50 |   3 |   2 |   1 |   50 |
|   1 |   2 |   3 |   20 |   1 |   2 |   1 |   30 |
|   1 |   2 |   3 |   20 |   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |   1 |   2 |   3 |   20 |
|   1 |   2 |   3 |   20 |   1 |   2 |   4 |   10 |
|   1 |   2 |   3 |   20 |   1 |   2 |   5 |   30 |
|   1 |   2 |   3 |   20 |   1 |   2 |   6 |   10 |
|   1 |   2 |   3 |   20 |   2 |   2 |   1 |   40 |
|   1 |   2 |   3 |   20 |   3 |   2 |   1 |   50 |
|   1 |   2 |   4 |   10 |   1 |   2 |   1 |   30 |
|   1 |   2 |   4 |   10 |   1 |   2 |   2 |   50 |
|   1 |   2 |   4 |   10 |   1 |   2 |   3 |   20 |
|   1 |   2 |   4 |   10 |   1 |   2 |   4 |   10 |
|   1 |   2 |   4 |   10 |   1 |   2 |   5 |   30 |
|   1 |   2 |   4 |   10 |   1 |   2 |   6 |   10 |
|   1 |   2 |   4 |   10 |   2 |   2 |   1 |   40 |
|   1 |   2 |   4 |   10 |   3 |   2 |   1 |   50 |
|   1 |   2 |   5 |   30 |   1 |   2 |   1 |   30 |
|   1 |   2 |   5 |   30 |   1 |   2 |   2 |   50 |
|   1 |   2 |   5 |   30 |   1 |   2 |   3 |   20 |
|   1 |   2 |   5 |   30 |   1 |   2 |   4 |   10 |
|   1 |   2 |   5 |   30 |   1 |   2 |   5 |   30 |
|   1 |   2 |   5 |   30 |   1 |   2 |   6 |   10 |
|   1 |   2 |   5 |   30 |   2 |   2 |   1 |   40 |
|   1 |   2 |   5 |   30 |   3 |   2 |   1 |   50 |
|   1 |   2 |   6 |   10 |   1 |   2 |   1 |   30 |
|   1 |   2 |   6 |   10 |   1 |   2 |   2 |   50 |
|   1 |   2 |   6 |   10 |   1 |   2 |   3 |   20 |
|   1 |   2 |   6 |   10 |   1 |   2 |   4 |   10 |
|   1 |   2 |   6 |   10 |   1 |   2 |   5 |   30 |
|   1 |   2 |   6 |   10 |   1 |   2 |   6 |   10 |
|   1 |   2 |   6 |   10 |   2 |   2 |   1 |   40 |
|   1 |   2 |   6 |   10 |   3 |   2 |   1 |   50 |
|   2 |   1 |   6 |   10 |   1 |   1 |   2 |   20 |
|   2 |   1 |   6 |   10 |   1 |   1 |   6 |   40 |
|   2 |   1 |   6 |   10 |   2 |   1 |   6 |   10 |
|   2 |   1 |   6 |   10 |   3 |   1 |   1 |   60 |
|   2 |   1 |   6 |   10 |   4 |   1 |   4 |   50 |
|   2 |   1 |   6 |   10 |   5 |   1 |   1 |   80 |
|   2 |   2 |   1 |   40 |   1 |   2 |   1 |   30 |
|   2 |   2 |   1 |   40 |   1 |   2 |   2 |   50 |
|   2 |   2 |   1 |   40 |   1 |   2 |   3 |   20 |
|   2 |   2 |   1 |   40 |   1 |   2 |   4 |   10 |
|   2 |   2 |   1 |   40 |   1 |   2 |   5 |   30 |
|   2 |   2 |   1 |   40 |   1 |   2 |   6 |   10 |
|   2 |   2 |   1 |   40 |   2 |   2 |   1 |   40 |
|   2 |   2 |   1 |   40 |   3 |   2 |   1 |   50 |
|   2 |   3 |   6 |   20 |   2 |   3 |   6 |   20 |
|   2 |   3 |   6 |   20 |   3 |   3 |   6 |   70 |
|   3 |   1 |   1 |   60 |   1 |   1 |   2 |   20 |
|   3 |   1 |   1 |   60 |   1 |   1 |   6 |   40 |
|   3 |   1 |   1 |   60 |   2 |   1 |   6 |   10 |
|   3 |   1 |   1 |   60 |   3 |   1 |   1 |   60 |
|   3 |   1 |   1 |   60 |   4 |   1 |   4 |   50 |
|   3 |   1 |   1 |   60 |   5 |   1 |   1 |   80 |
|   3 |   2 |   1 |   50 |   1 |   2 |   1 |   30 |
|   3 |   2 |   1 |   50 |   1 |   2 |   2 |   50 |
|   3 |   2 |   1 |   50 |   1 |   2 |   3 |   20 |
|   3 |   2 |   1 |   50 |   1 |   2 |   4 |   10 |
|   3 |   2 |   1 |   50 |   1 |   2 |   5 |   30 |
|   3 |   2 |   1 |   50 |   1 |   2 |   6 |   10 |
|   3 |   2 |   1 |   50 |   2 |   2 |   1 |   40 |
|   3 |   2 |   1 |   50 |   3 |   2 |   1 |   50 |
|   3 |   3 |   6 |   70 |   2 |   3 |   6 |   20 |
|   3 |   3 |   6 |   70 |   3 |   3 |   6 |   70 |
|   4 |   1 |   4 |   50 |   1 |   1 |   2 |   20 |
|   4 |   1 |   4 |   50 |   1 |   1 |   6 |   40 |
|   4 |   1 |   4 |   50 |   2 |   1 |   6 |   10 |
|   4 |   1 |   4 |   50 |   3 |   1 |   1 |   60 |
|   4 |   1 |   4 |   50 |   4 |   1 |   4 |   50 |
|   4 |   1 |   4 |   50 |   5 |   1 |   1 |   80 |
|   4 |   5 |   1 |   10 |   4 |   5 |   1 |   10 |
|   4 |   5 |   1 |   10 |   4 |   5 |   5 |   50 |
|   4 |   5 |   5 |   50 |   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |   4 |   5 |   5 |   50 |
|   5 |   1 |   1 |   80 |   1 |   1 |   2 |   20 |
|   5 |   1 |   1 |   80 |   1 |   1 |   6 |   40 |
|   5 |   1 |   1 |   80 |   2 |   1 |   6 |   10 |
|   5 |   1 |   1 |   80 |   3 |   1 |   1 |   60 |
|   5 |   1 |   1 |   80 |   4 |   1 |   4 |   50 |
|   5 |   1 |   1 |   80 |   5 |   1 |   1 |   80 |
|   5 |   6 |   5 |   10 |   5 |   6 |   5 |   10 |
+-----+-----+-----+------+-----+-----+-----+------+
109 rows in set (0.00 sec)

mysql> select sno,distinct pno from spj; 
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'distinct pno from spj' at line 1
mysql> select distinct pno,sno from spj;
+-----+-----+
| pno | sno |
+-----+-----+
|   1 |   1 |
|   1 |   2 |
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   2 |   1 |
|   2 |   2 |
|   2 |   3 |
|   3 |   2 |
|   3 |   3 |
|   5 |   4 |
|   6 |   5 |
+-----+-----+
12 rows in set (0.00 sec)

mysql> create view v1 as (select distinct pno,sno from spj);
Query OK, 0 rows affected (0.06 sec)

mysql> select * from spj s join v1 v on s.pno=v.pno;
+-----+-----+-----+------+-----+-----+
| sno | pno | jno | qty  | pno | sno |
+-----+-----+-----+------+-----+-----+
|   1 |   1 |   2 |   20 |   1 |   1 |
|   1 |   1 |   2 |   20 |   1 |   2 |
|   1 |   1 |   2 |   20 |   1 |   3 |
|   1 |   1 |   2 |   20 |   1 |   4 |
|   1 |   1 |   2 |   20 |   1 |   5 |
|   1 |   1 |   6 |   40 |   1 |   1 |
|   1 |   1 |   6 |   40 |   1 |   2 |
|   1 |   1 |   6 |   40 |   1 |   3 |
|   1 |   1 |   6 |   40 |   1 |   4 |
|   1 |   1 |   6 |   40 |   1 |   5 |
|   1 |   2 |   1 |   30 |   2 |   1 |
|   1 |   2 |   1 |   30 |   2 |   2 |
|   1 |   2 |   1 |   30 |   2 |   3 |
|   1 |   2 |   2 |   50 |   2 |   1 |
|   1 |   2 |   2 |   50 |   2 |   2 |
|   1 |   2 |   2 |   50 |   2 |   3 |
|   1 |   2 |   3 |   20 |   2 |   1 |
|   1 |   2 |   3 |   20 |   2 |   2 |
|   1 |   2 |   3 |   20 |   2 |   3 |
|   1 |   2 |   4 |   10 |   2 |   1 |
|   1 |   2 |   4 |   10 |   2 |   2 |
|   1 |   2 |   4 |   10 |   2 |   3 |
|   1 |   2 |   5 |   30 |   2 |   1 |
|   1 |   2 |   5 |   30 |   2 |   2 |
|   1 |   2 |   5 |   30 |   2 |   3 |
|   1 |   2 |   6 |   10 |   2 |   1 |
|   1 |   2 |   6 |   10 |   2 |   2 |
|   1 |   2 |   6 |   10 |   2 |   3 |
|   2 |   1 |   6 |   10 |   1 |   1 |
|   2 |   1 |   6 |   10 |   1 |   2 |
|   2 |   1 |   6 |   10 |   1 |   3 |
|   2 |   1 |   6 |   10 |   1 |   4 |
|   2 |   1 |   6 |   10 |   1 |   5 |
|   2 |   2 |   1 |   40 |   2 |   1 |
|   2 |   2 |   1 |   40 |   2 |   2 |
|   2 |   2 |   1 |   40 |   2 |   3 |
|   2 |   3 |   6 |   20 |   3 |   2 |
|   2 |   3 |   6 |   20 |   3 |   3 |
|   3 |   1 |   1 |   60 |   1 |   1 |
|   3 |   1 |   1 |   60 |   1 |   2 |
|   3 |   1 |   1 |   60 |   1 |   3 |
|   3 |   1 |   1 |   60 |   1 |   4 |
|   3 |   1 |   1 |   60 |   1 |   5 |
|   3 |   2 |   1 |   50 |   2 |   1 |
|   3 |   2 |   1 |   50 |   2 |   2 |
|   3 |   2 |   1 |   50 |   2 |   3 |
|   3 |   3 |   6 |   70 |   3 |   2 |
|   3 |   3 |   6 |   70 |   3 |   3 |
|   4 |   1 |   4 |   50 |   1 |   1 |
|   4 |   1 |   4 |   50 |   1 |   2 |
|   4 |   1 |   4 |   50 |   1 |   3 |
|   4 |   1 |   4 |   50 |   1 |   4 |
|   4 |   1 |   4 |   50 |   1 |   5 |
|   4 |   5 |   1 |   10 |   5 |   4 |
|   4 |   5 |   5 |   50 |   5 |   4 |
|   5 |   1 |   1 |   80 |   1 |   1 |
|   5 |   1 |   1 |   80 |   1 |   2 |
|   5 |   1 |   1 |   80 |   1 |   3 |
|   5 |   1 |   1 |   80 |   1 |   4 |
|   5 |   1 |   1 |   80 |   1 |   5 |
|   5 |   6 |   5 |   10 |   6 |   5 |
+-----+-----+-----+------+-----+-----+
61 rows in set (0.00 sec)

mysql> select s.sno,s.pno,v.sno,v.pno from spj s join v1 v on s.pno=v.pno;
+-----+-----+-----+-----+
| sno | pno | sno | pno |
+-----+-----+-----+-----+
|   1 |   1 |   1 |   1 |
|   1 |   1 |   1 |   1 |
|   2 |   1 |   1 |   1 |
|   3 |   1 |   1 |   1 |
|   4 |   1 |   1 |   1 |
|   5 |   1 |   1 |   1 |
|   1 |   1 |   2 |   1 |
|   1 |   1 |   2 |   1 |
|   2 |   1 |   2 |   1 |
|   3 |   1 |   2 |   1 |
|   4 |   1 |   2 |   1 |
|   5 |   1 |   2 |   1 |
|   1 |   1 |   3 |   1 |
|   1 |   1 |   3 |   1 |
|   2 |   1 |   3 |   1 |
|   3 |   1 |   3 |   1 |
|   4 |   1 |   3 |   1 |
|   5 |   1 |   3 |   1 |
|   1 |   1 |   4 |   1 |
|   1 |   1 |   4 |   1 |
|   2 |   1 |   4 |   1 |
|   3 |   1 |   4 |   1 |
|   4 |   1 |   4 |   1 |
|   5 |   1 |   4 |   1 |
|   1 |   1 |   5 |   1 |
|   1 |   1 |   5 |   1 |
|   2 |   1 |   5 |   1 |
|   3 |   1 |   5 |   1 |
|   4 |   1 |   5 |   1 |
|   5 |   1 |   5 |   1 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   2 |   2 |   1 |   2 |
|   3 |   2 |   1 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   2 |   2 |   2 |   2 |
|   3 |   2 |   2 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   2 |   2 |   3 |   2 |
|   3 |   2 |   3 |   2 |
|   2 |   3 |   2 |   3 |
|   3 |   3 |   2 |   3 |
|   2 |   3 |   3 |   3 |
|   3 |   3 |   3 |   3 |
|   4 |   5 |   4 |   5 |
|   4 |   5 |   4 |   5 |
|   5 |   6 |   5 |   6 |
+-----+-----+-----+-----+
61 rows in set (0.00 sec)

mysql> quit
mysql> select s.sno,s.pno,v.sno,v.pno from spj s join v1 v on s.pno=v.pno;
+-----+-----+-----+-----+
| sno | pno | sno | pno |
+-----+-----+-----+-----+
|   1 |   1 |   1 |   1 |
|   1 |   1 |   1 |   1 |
|   2 |   1 |   1 |   1 |
|   3 |   1 |   1 |   1 |
|   4 |   1 |   1 |   1 |
|   5 |   1 |   1 |   1 |
|   1 |   1 |   2 |   1 |
|   1 |   1 |   2 |   1 |
|   2 |   1 |   2 |   1 |
|   3 |   1 |   2 |   1 |
|   4 |   1 |   2 |   1 |
|   5 |   1 |   2 |   1 |
|   1 |   1 |   3 |   1 |
|   1 |   1 |   3 |   1 |
|   2 |   1 |   3 |   1 |
|   3 |   1 |   3 |   1 |
|   4 |   1 |   3 |   1 |
|   5 |   1 |   3 |   1 |
|   1 |   1 |   4 |   1 |
|   1 |   1 |   4 |   1 |
|   2 |   1 |   4 |   1 |
|   3 |   1 |   4 |   1 |
|   4 |   1 |   4 |   1 |
|   5 |   1 |   4 |   1 |
|   1 |   1 |   5 |   1 |
|   1 |   1 |   5 |   1 |
|   2 |   1 |   5 |   1 |
|   3 |   1 |   5 |   1 |
|   4 |   1 |   5 |   1 |
|   5 |   1 |   5 |   1 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   2 |   2 |   1 |   2 |
|   3 |   2 |   1 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   2 |   2 |   2 |   2 |
|   3 |   2 |   2 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   2 |   2 |   3 |   2 |
|   3 |   2 |   3 |   2 |
|   2 |   3 |   2 |   3 |
|   3 |   3 |   2 |   3 |
|   2 |   3 |   3 |   3 |
|   3 |   3 |   3 |   3 |
|   4 |   5 |   4 |   5 |
|   4 |   5 |   4 |   5 |
|   5 |   6 |   5 |   6 |
+-----+-----+-----+-----+
61 rows in set (0.04 sec)

mysql> insert into spj values (6,1,6,65);
Query OK, 1 row affected (0.33 sec)

mysql> insert into spj values (6,6,3,20);
Query OK, 1 row affected (0.05 sec)

mysql> select s.sno,s.pno,v.sno,v.pno from spj s join v1 v on s.pno=v.pno;
+-----+-----+-----+-----+
| sno | pno | sno | pno |
+-----+-----+-----+-----+
|   1 |   1 |   1 |   1 |
|   1 |   1 |   1 |   1 |
|   2 |   1 |   1 |   1 |
|   3 |   1 |   1 |   1 |
|   4 |   1 |   1 |   1 |
|   5 |   1 |   1 |   1 |
|   6 |   1 |   1 |   1 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   2 |   2 |   1 |   2 |
|   3 |   2 |   1 |   2 |
|   1 |   1 |   2 |   1 |
|   1 |   1 |   2 |   1 |
|   2 |   1 |   2 |   1 |
|   3 |   1 |   2 |   1 |
|   4 |   1 |   2 |   1 |
|   5 |   1 |   2 |   1 |
|   6 |   1 |   2 |   1 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   2 |   2 |   2 |   2 |
|   3 |   2 |   2 |   2 |
|   2 |   3 |   2 |   3 |
|   3 |   3 |   2 |   3 |
|   1 |   1 |   3 |   1 |
|   1 |   1 |   3 |   1 |
|   2 |   1 |   3 |   1 |
|   3 |   1 |   3 |   1 |
|   4 |   1 |   3 |   1 |
|   5 |   1 |   3 |   1 |
|   6 |   1 |   3 |   1 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   2 |   2 |   3 |   2 |
|   3 |   2 |   3 |   2 |
|   2 |   3 |   3 |   3 |
|   3 |   3 |   3 |   3 |
|   1 |   1 |   4 |   1 |
|   1 |   1 |   4 |   1 |
|   2 |   1 |   4 |   1 |
|   3 |   1 |   4 |   1 |
|   4 |   1 |   4 |   1 |
|   5 |   1 |   4 |   1 |
|   6 |   1 |   4 |   1 |
|   4 |   5 |   4 |   5 |
|   4 |   5 |   4 |   5 |
|   1 |   1 |   5 |   1 |
|   1 |   1 |   5 |   1 |
|   2 |   1 |   5 |   1 |
|   3 |   1 |   5 |   1 |
|   4 |   1 |   5 |   1 |
|   5 |   1 |   5 |   1 |
|   6 |   1 |   5 |   1 |
|   5 |   6 |   5 |   6 |
|   6 |   6 |   5 |   6 |
|   1 |   1 |   6 |   1 |
|   1 |   1 |   6 |   1 |
|   2 |   1 |   6 |   1 |
|   3 |   1 |   6 |   1 |
|   4 |   1 |   6 |   1 |
|   5 |   1 |   6 |   1 |
|   6 |   1 |   6 |   1 |
|   5 |   6 |   6 |   6 |
|   6 |   6 |   6 |   6 |
+-----+-----+-----+-----+
76 rows in set (0.00 sec)

mysql> create view v2 as (select s.sno,s.pno,v.sno,v.pno from spj s join v1 v on s.pno=v.pno;);
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1
mysql> create view v2 as (select s.sno,s.pno,v.sno,v.pno from spj s join v1 v on s.pno=v.pno);
ERROR 1060 (42S21): Duplicate column name 'sno'
mysql> create view v2 (ssno,spno,vsno,vpno) as (select s.sno,s.pno,v.sno,v.pno from spj s join v1 v on s.pno=v.pno);
Query OK, 0 rows affected (0.05 sec)

mysql> select * from v2;
+------+------+------+------+
| ssno | spno | vsno | vpno |
+------+------+------+------+
|    1 |    1 |    1 |    1 |
|    1 |    1 |    1 |    1 |
|    2 |    1 |    1 |    1 |
|    3 |    1 |    1 |    1 |
|    4 |    1 |    1 |    1 |
|    5 |    1 |    1 |    1 |
|    6 |    1 |    1 |    1 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    2 |    2 |    1 |    2 |
|    3 |    2 |    1 |    2 |
|    1 |    1 |    2 |    1 |
|    1 |    1 |    2 |    1 |
|    2 |    1 |    2 |    1 |
|    3 |    1 |    2 |    1 |
|    4 |    1 |    2 |    1 |
|    5 |    1 |    2 |    1 |
|    6 |    1 |    2 |    1 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    2 |    2 |    2 |    2 |
|    3 |    2 |    2 |    2 |
|    2 |    3 |    2 |    3 |
|    3 |    3 |    2 |    3 |
|    1 |    1 |    3 |    1 |
|    1 |    1 |    3 |    1 |
|    2 |    1 |    3 |    1 |
|    3 |    1 |    3 |    1 |
|    4 |    1 |    3 |    1 |
|    5 |    1 |    3 |    1 |
|    6 |    1 |    3 |    1 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    2 |    2 |    3 |    2 |
|    3 |    2 |    3 |    2 |
|    2 |    3 |    3 |    3 |
|    3 |    3 |    3 |    3 |
|    1 |    1 |    4 |    1 |
|    1 |    1 |    4 |    1 |
|    2 |    1 |    4 |    1 |
|    3 |    1 |    4 |    1 |
|    4 |    1 |    4 |    1 |
|    5 |    1 |    4 |    1 |
|    6 |    1 |    4 |    1 |
|    4 |    5 |    4 |    5 |
|    4 |    5 |    4 |    5 |
|    1 |    1 |    5 |    1 |
|    1 |    1 |    5 |    1 |
|    2 |    1 |    5 |    1 |
|    3 |    1 |    5 |    1 |
|    4 |    1 |    5 |    1 |
|    5 |    1 |    5 |    1 |
|    6 |    1 |    5 |    1 |
|    5 |    6 |    5 |    6 |
|    6 |    6 |    5 |    6 |
|    1 |    1 |    6 |    1 |
|    1 |    1 |    6 |    1 |
|    2 |    1 |    6 |    1 |
|    3 |    1 |    6 |    1 |
|    4 |    1 |    6 |    1 |
|    5 |    1 |    6 |    1 |
|    6 |    1 |    6 |    1 |
|    5 |    6 |    6 |    6 |
|    6 |    6 |    6 |    6 |
+------+------+------+------+
76 rows in set (0.00 sec)

mysql> select ssno,vsno,spno,vpno from v2 V where (select count(distinct pno) from v2 v where v.ssno=V.ssno group by v.ssno)=(select count(distinct pno) from v2 v1 where v1.vsno=V.vsno group by V1.vsno);
ERROR 1054 (42S22): Unknown column 'pno' in 'field list'
mysql> select ssno,vsno,spno,vpno from v2 V where (select count(distinct v.spno) from v2 v where v.ssno=V.ssno group by v.ssno)=(select count(distinct v1.vpno) from v2 v1 where v1.vsno=V.vsno group by V1.vsno);
ERROR 1054 (42S22): Unknown column 'V1.vsno' in 'group statement'
mysql> select ssno,vsno,spno,vpno from v2 V where (select count(distinct v.spno) from v2 v where v.ssno=V.ssno group by v.ssno)=(select count(distinct v1.vpno) from v2 v1 where v1.vsno=V.vsno group by v1.vsno);
+------+------+------+------+
| ssno | vsno | spno | vpno |
+------+------+------+------+
|    1 |    1 |    1 |    1 |
|    1 |    1 |    1 |    1 |
|    4 |    1 |    1 |    1 |
|    5 |    1 |    1 |    1 |
|    6 |    1 |    1 |    1 |
|    1 |    1 |    2 |    2 |
|    1 |    1 |    2 |    2 |
|    1 |    1 |    2 |    2 |
|    1 |    1 |    2 |    2 |
|    1 |    1 |    2 |    2 |
|    1 |    1 |    2 |    2 |
|    2 |    2 |    1 |    1 |
|    3 |    2 |    1 |    1 |
|    2 |    2 |    2 |    2 |
|    3 |    2 |    2 |    2 |
|    2 |    2 |    3 |    3 |
|    3 |    2 |    3 |    3 |
|    2 |    3 |    1 |    1 |
|    3 |    3 |    1 |    1 |
|    2 |    3 |    2 |    2 |
|    3 |    3 |    2 |    2 |
|    2 |    3 |    3 |    3 |
|    3 |    3 |    3 |    3 |
|    1 |    4 |    1 |    1 |
|    1 |    4 |    1 |    1 |
|    4 |    4 |    1 |    1 |
|    5 |    4 |    1 |    1 |
|    6 |    4 |    1 |    1 |
|    4 |    4 |    5 |    5 |
|    4 |    4 |    5 |    5 |
|    1 |    5 |    1 |    1 |
|    1 |    5 |    1 |    1 |
|    4 |    5 |    1 |    1 |
|    5 |    5 |    1 |    1 |
|    6 |    5 |    1 |    1 |
|    5 |    5 |    6 |    6 |
|    6 |    5 |    6 |    6 |
|    1 |    6 |    1 |    1 |
|    1 |    6 |    1 |    1 |
|    4 |    6 |    1 |    1 |
|    5 |    6 |    1 |    1 |
|    6 |    6 |    1 |    1 |
|    5 |    6 |    6 |    6 |
|    6 |    6 |    6 |    6 |
+------+------+------+------+
44 rows in set (0.01 sec)

mysql> select distinct ssno,vsno,spno,vpno from v2 V where (select count(distinct v.spno) from v2 v where v.ssno=V.ssno group by v.ssno)=(select count(distinct v1.vpno) from v2 v1 where v1.vsno=V.vsno group by v1.vsno);
+------+------+------+------+
| ssno | vsno | spno | vpno |
+------+------+------+------+
|    1 |    1 |    1 |    1 |
|    4 |    1 |    1 |    1 |
|    5 |    1 |    1 |    1 |
|    6 |    1 |    1 |    1 |
|    1 |    1 |    2 |    2 |
|    2 |    2 |    1 |    1 |
|    3 |    2 |    1 |    1 |
|    2 |    2 |    2 |    2 |
|    3 |    2 |    2 |    2 |
|    2 |    2 |    3 |    3 |
|    3 |    2 |    3 |    3 |
|    2 |    3 |    1 |    1 |
|    3 |    3 |    1 |    1 |
|    2 |    3 |    2 |    2 |
|    3 |    3 |    2 |    2 |
|    2 |    3 |    3 |    3 |
|    3 |    3 |    3 |    3 |
|    1 |    4 |    1 |    1 |
|    4 |    4 |    1 |    1 |
|    5 |    4 |    1 |    1 |
|    6 |    4 |    1 |    1 |
|    4 |    4 |    5 |    5 |
|    1 |    5 |    1 |    1 |
|    4 |    5 |    1 |    1 |
|    5 |    5 |    1 |    1 |
|    6 |    5 |    1 |    1 |
|    5 |    5 |    6 |    6 |
|    6 |    5 |    6 |    6 |
|    1 |    6 |    1 |    1 |
|    4 |    6 |    1 |    1 |
|    5 |    6 |    1 |    1 |
|    6 |    6 |    1 |    1 |
|    5 |    6 |    6 |    6 |
|    6 |    6 |    6 |    6 |
+------+------+------+------+
34 rows in set (0.00 sec)

mysql> select distinct ssno,vsno,spno,vpno from v2 V where (select count(distinct v.spno) from v2 v where v.ssno=V.ssno group by v.ssno)=(select count(distinct v1.vpno) from v2 v1 where v1.vsno=V.vsno group by v1.vsno) and ssno!=vsno;
+------+------+------+------+
| ssno | vsno | spno | vpno |
+------+------+------+------+
|    4 |    1 |    1 |    1 |
|    5 |    1 |    1 |    1 |
|    6 |    1 |    1 |    1 |
|    3 |    2 |    1 |    1 |
|    3 |    2 |    2 |    2 |
|    3 |    2 |    3 |    3 |
|    2 |    3 |    1 |    1 |
|    2 |    3 |    2 |    2 |
|    2 |    3 |    3 |    3 |
|    1 |    4 |    1 |    1 |
|    5 |    4 |    1 |    1 |
|    6 |    4 |    1 |    1 |
|    1 |    5 |    1 |    1 |
|    4 |    5 |    1 |    1 |
|    6 |    5 |    1 |    1 |
|    6 |    5 |    6 |    6 |
|    1 |    6 |    1 |    1 |
|    4 |    6 |    1 |    1 |
|    5 |    6 |    1 |    1 |
|    5 |    6 |    6 |    6 |
+------+------+------+------+
20 rows in set (0.01 sec)

mysql> select distinct ssno,vsno,spno,vpno from v2 V where (select count(distinct v.spno) from v2 v where v.ssno=V.ssno group by v.ssno)=(select count(distinct v1.vpno) from v2 v1 where v1.vsno=V.vsno group by v1.vsno) and ssno!=vsno order by ssno;
+------+------+------+------+
| ssno | vsno | spno | vpno |
+------+------+------+------+
|    1 |    6 |    1 |    1 |
|    1 |    4 |    1 |    1 |
|    1 |    5 |    1 |    1 |
|    2 |    3 |    1 |    1 |
|    2 |    3 |    2 |    2 |
|    2 |    3 |    3 |    3 |
|    3 |    2 |    2 |    2 |
|    3 |    2 |    3 |    3 |
|    3 |    2 |    1 |    1 |
|    4 |    6 |    1 |    1 |
|    4 |    1 |    1 |    1 |
|    4 |    5 |    1 |    1 |
|    5 |    6 |    1 |    1 |
|    5 |    6 |    6 |    6 |
|    5 |    4 |    1 |    1 |
|    5 |    1 |    1 |    1 |
|    6 |    5 |    1 |    1 |
|    6 |    5 |    6 |    6 |
|    6 |    4 |    1 |    1 |
|    6 |    1 |    1 |    1 |
+------+------+------+------+
20 rows in set (0.00 sec)

mysql> select * from spj;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |
|   1 |   1 |   6 |   40 |
|   1 |   2 |   1 |   30 |
|   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |
|   1 |   2 |   4 |   10 |
|   1 |   2 |   5 |   30 |
|   1 |   2 |   6 |   10 |
|   2 |   1 |   6 |   10 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
|   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |
|   3 |   3 |   6 |   70 |
|   4 |   1 |   4 |   50 |
|   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |
|   5 |   1 |   1 |   80 |
|   5 |   6 |   5 |   10 |
|   6 |   1 |   6 |   65 |
|   6 |   6 |   3 |   20 |
+-----+-----+-----+------+
21 rows in set (0.00 sec)

mysql> select count(distinct v.spno) from v2 v group by v.ssno
    -> ;
+------------------------+
| count(distinct v.spno) |
+------------------------+
|                      2 |
|                      3 |
|                      3 |
|                      2 |
|                      2 |
|                      2 |
+------------------------+
6 rows in set (0.00 sec)

mysql> select ssno,count(distinct v.spno) from v2 v group by v.ssno
    -> ;
+------+------------------------+
| ssno | count(distinct v.spno) |
+------+------------------------+
|    1 |                      2 |
|    2 |                      3 |
|    3 |                      3 |
|    4 |                      2 |
|    5 |                      2 |
|    6 |                      2 |
+------+------------------------+
6 rows in set (0.00 sec)

mysql> select v1.vsno,count(distinct v1.vpno) from v2 v1 group by v1.vsno;
+------+-------------------------+
| vsno | count(distinct v1.vpno) |
+------+-------------------------+
|    1 |                       2 |
|    2 |                       3 |
|    3 |                       3 |
|    4 |                       2 |
|    5 |                       2 |
|    6 |                       2 |
+------+-------------------------+
6 rows in set (0.00 sec)

mysql> select * from v1;
+-----+-----+
| pno | sno |
+-----+-----+
|   1 |   1 |
|   2 |   1 |
|   1 |   2 |
|   2 |   2 |
|   3 |   2 |
|   1 |   3 |
|   2 |   3 |
|   3 |   3 |
|   1 |   4 |
|   5 |   4 |
|   1 |   5 |
|   6 |   5 |
|   1 |   6 |
|   6 |   6 |
+-----+-----+
14 rows in set (0.00 sec)

mysql> select * from v2;
+------+------+------+------+
| ssno | spno | vsno | vpno |
+------+------+------+------+
|    1 |    1 |    1 |    1 |
|    1 |    1 |    1 |    1 |
|    2 |    1 |    1 |    1 |
|    3 |    1 |    1 |    1 |
|    4 |    1 |    1 |    1 |
|    5 |    1 |    1 |    1 |
|    6 |    1 |    1 |    1 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    2 |    2 |    1 |    2 |
|    3 |    2 |    1 |    2 |
|    1 |    1 |    2 |    1 |
|    1 |    1 |    2 |    1 |
|    2 |    1 |    2 |    1 |
|    3 |    1 |    2 |    1 |
|    4 |    1 |    2 |    1 |
|    5 |    1 |    2 |    1 |
|    6 |    1 |    2 |    1 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    2 |    2 |    2 |    2 |
|    3 |    2 |    2 |    2 |
|    2 |    3 |    2 |    3 |
|    3 |    3 |    2 |    3 |
|    1 |    1 |    3 |    1 |
|    1 |    1 |    3 |    1 |
|    2 |    1 |    3 |    1 |
|    3 |    1 |    3 |    1 |
|    4 |    1 |    3 |    1 |
|    5 |    1 |    3 |    1 |
|    6 |    1 |    3 |    1 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    2 |    2 |    3 |    2 |
|    3 |    2 |    3 |    2 |
|    2 |    3 |    3 |    3 |
|    3 |    3 |    3 |    3 |
|    1 |    1 |    4 |    1 |
|    1 |    1 |    4 |    1 |
|    2 |    1 |    4 |    1 |
|    3 |    1 |    4 |    1 |
|    4 |    1 |    4 |    1 |
|    5 |    1 |    4 |    1 |
|    6 |    1 |    4 |    1 |
|    4 |    5 |    4 |    5 |
|    4 |    5 |    4 |    5 |
|    1 |    1 |    5 |    1 |
|    1 |    1 |    5 |    1 |
|    2 |    1 |    5 |    1 |
|    3 |    1 |    5 |    1 |
|    4 |    1 |    5 |    1 |
|    5 |    1 |    5 |    1 |
|    6 |    1 |    5 |    1 |
|    5 |    6 |    5 |    6 |
|    6 |    6 |    5 |    6 |
|    1 |    1 |    6 |    1 |
|    1 |    1 |    6 |    1 |
|    2 |    1 |    6 |    1 |
|    3 |    1 |    6 |    1 |
|    4 |    1 |    6 |    1 |
|    5 |    1 |    6 |    1 |
|    6 |    1 |    6 |    1 |
|    5 |    6 |    6 |    6 |
|    6 |    6 |    6 |    6 |
+------+------+------+------+
76 rows in set (0.00 sec)

mysql> create view v2 (ssno,spno,vsno,vpno) as (select s.sno,s.pno,v.sno,v.pno from v1 s join v1 v on s.pno=v.pno);
ERROR 1050 (42S01): Table 'v2' already exists
mysql> create view v3 (ssno,spno,vsno,vpno) as (select s.sno,s.pno,v.sno,v.pno from v1 s join v1 v on s.pno=v.pno);
Query OK, 0 rows affected (0.04 sec)

mysql> select * from v3;
+------+------+------+------+
| ssno | spno | vsno | vpno |
+------+------+------+------+
|    1 |    1 |    1 |    1 |
|    1 |    1 |    2 |    1 |
|    1 |    1 |    3 |    1 |
|    1 |    1 |    4 |    1 |
|    1 |    1 |    5 |    1 |
|    1 |    1 |    6 |    1 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    3 |    2 |
|    2 |    1 |    1 |    1 |
|    2 |    1 |    2 |    1 |
|    2 |    1 |    3 |    1 |
|    2 |    1 |    4 |    1 |
|    2 |    1 |    5 |    1 |
|    2 |    1 |    6 |    1 |
|    2 |    2 |    1 |    2 |
|    2 |    2 |    2 |    2 |
|    2 |    2 |    3 |    2 |
|    2 |    3 |    2 |    3 |
|    2 |    3 |    3 |    3 |
|    3 |    1 |    1 |    1 |
|    3 |    1 |    2 |    1 |
|    3 |    1 |    3 |    1 |
|    3 |    1 |    4 |    1 |
|    3 |    1 |    5 |    1 |
|    3 |    1 |    6 |    1 |
|    3 |    2 |    1 |    2 |
|    3 |    2 |    2 |    2 |
|    3 |    2 |    3 |    2 |
|    3 |    3 |    2 |    3 |
|    3 |    3 |    3 |    3 |
|    4 |    1 |    1 |    1 |
|    4 |    1 |    2 |    1 |
|    4 |    1 |    3 |    1 |
|    4 |    1 |    4 |    1 |
|    4 |    1 |    5 |    1 |
|    4 |    1 |    6 |    1 |
|    4 |    5 |    4 |    5 |
|    5 |    1 |    1 |    1 |
|    5 |    1 |    2 |    1 |
|    5 |    1 |    3 |    1 |
|    5 |    1 |    4 |    1 |
|    5 |    1 |    5 |    1 |
|    5 |    1 |    6 |    1 |
|    5 |    6 |    5 |    6 |
|    5 |    6 |    6 |    6 |
|    6 |    1 |    1 |    1 |
|    6 |    1 |    2 |    1 |
|    6 |    1 |    3 |    1 |
|    6 |    1 |    4 |    1 |
|    6 |    1 |    5 |    1 |
|    6 |    1 |    6 |    1 |
|    6 |    6 |    5 |    6 |
|    6 |    6 |    6 |    6 |
+------+------+------+------+
54 rows in set (0.00 sec)

mysql> select distinct ssno,vsno,spno,vpno from v3 V where (select count(distinct v.spno) from v2 v where v.ssno=V.ssno group by v.ssno)=(select count(distinct v1.vpno) from v2 v1 where v1.vsno=V.vsno group by v1.vsno) and ssno!=vsno order by ssno;
+------+------+------+------+
| ssno | vsno | spno | vpno |
+------+------+------+------+
|    1 |    4 |    1 |    1 |
|    1 |    5 |    1 |    1 |
|    1 |    6 |    1 |    1 |
|    2 |    3 |    2 |    2 |
|    2 |    3 |    3 |    3 |
|    2 |    3 |    1 |    1 |
|    3 |    2 |    1 |    1 |
|    3 |    2 |    2 |    2 |
|    3 |    2 |    3 |    3 |
|    4 |    5 |    1 |    1 |
|    4 |    6 |    1 |    1 |
|    4 |    1 |    1 |    1 |
|    5 |    6 |    6 |    6 |
|    5 |    4 |    1 |    1 |
|    5 |    6 |    1 |    1 |
|    5 |    1 |    1 |    1 |
|    6 |    4 |    1 |    1 |
|    6 |    5 |    1 |    1 |
|    6 |    1 |    1 |    1 |
|    6 |    5 |    6 |    6 |
+------+------+------+------+
20 rows in set (0.01 sec)

mysql> select * from v1;
+-----+-----+
| pno | sno |
+-----+-----+
|   1 |   1 |
|   2 |   1 |
|   1 |   2 |
|   2 |   2 |
|   3 |   2 |
|   1 |   3 |
|   2 |   3 |
|   3 |   3 |
|   1 |   4 |
|   5 |   4 |
|   1 |   5 |
|   6 |   5 |
|   1 |   6 |
|   6 |   6 |
+-----+-----+
14 rows in set (0.00 sec)

mysql> select sno from v1 q where (select pno from v1 where sno=q.sno)=(select pno from v1 where sno!=q.sno);
ERROR 1242 (21000): Subquery returns more than 1 row
mysql> select sno from v1 q where (select pno from v1 where sno=q.sno)in(select pno from v1 where sno!=q.sno);
ERROR 1242 (21000): Subquery returns more than 1 row
mysql> select distinct ssno,vsno,spno,vpno from v2 V where (select count(distinct v.spno) from v2 v where v.ssno=V.ssno group by v.ssno)=(select count( v1.vpno) from v2 v1 where v1.vsno=V.vsno group by v1.vsno) and ssno!=vsno;
Empty set (0.00 sec)

mysql> select q.sno from v1 q  where q.pno in(select pno from v1 where sno!=q.sno) group by q.sno having count(distinct(select pno from v1 where sno!=q.sno))=(select count(distinct pno) from v1 where sno=q.sno);
ERROR 1242 (21000): Subquery returns more than 1 row
mysql> select q.sno from v1 q  where q.pno in(select pno from v1 where sno!=q.sno) group by q.sno having count((select pno from v1 where sno!=q.sno))=(select count(distinct pno) from v1 where sno=q.sno);
ERROR 1242 (21000): Subquery returns more than 1 row
mysql> select q.sno from v1 q  where q.pno in(select pno from v1 where sno!=q.sno) group by q.sno having count( pno)=(select count(distinct pno) from v1 where sno=q.sno);
+-----+
| sno |
+-----+
|   1 |
|   2 |
|   3 |
|   5 |
|   6 |
+-----+
5 rows in set (0.01 sec)

mysql> select q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno!=q.sno) group by q.sno having count(w.pno)=(select count(distinct pno) from v1 where sno=q.sno);
ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'w.sno' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> select q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno!=q.sno) group by q.sno,w.sno having count(w.pno)=(select count(distinct pno) from v1 where sno=q.sno);
+-----+-----+
| sno | sno |
+-----+-----+
|   4 |   1 |
|   4 |   4 |
|   4 |   5 |
|   4 |   6 |
+-----+-----+
4 rows in set (0.00 sec)

mysql> select * from v1;
+-----+-----+
| pno | sno |
+-----+-----+
|   1 |   1 |
|   2 |   1 |
|   1 |   2 |
|   2 |   2 |
|   3 |   2 |
|   1 |   3 |
|   2 |   3 |
|   3 |   3 |
|   1 |   4 |
|   5 |   4 |
|   1 |   5 |
|   6 |   5 |
|   1 |   6 |
|   6 |   6 |
+-----+-----+
14 rows in set (0.00 sec)

mysql> select sno from v1 v where pno in (select pno from v1 q where v.sno!=q.sno group by q.sno) group by sno having count(pno)=(select count(pno) from v1 q where v.sno!=q.sno group by q.sno);
ERROR 1242 (21000): Subquery returns more than 1 row
mysql> select q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno!=q.sno) group by q.sno,w.sno having count(w.pno)=(select count(distinct pno) from v1 where sno=q.sno);
+-----+-----+
| sno | sno |
+-----+-----+
|   4 |   1 |
|   4 |   4 |
|   4 |   5 |
|   4 |   6 |
+-----+-----+
4 rows in set (0.00 sec)

mysql> select * from v1 join v1;
ERROR 1066 (42000): Not unique table/alias: 'v1'
mysql> select * from v1 q join v1 w;
+-----+-----+-----+-----+
| pno | sno | pno | sno |
+-----+-----+-----+-----+
|   1 |   1 |   1 |   1 |
|   2 |   1 |   1 |   1 |
|   1 |   2 |   1 |   1 |
|   2 |   2 |   1 |   1 |
|   3 |   2 |   1 |   1 |
|   1 |   3 |   1 |   1 |
|   2 |   3 |   1 |   1 |
|   3 |   3 |   1 |   1 |
|   1 |   4 |   1 |   1 |
|   5 |   4 |   1 |   1 |
|   1 |   5 |   1 |   1 |
|   6 |   5 |   1 |   1 |
|   1 |   6 |   1 |   1 |
|   6 |   6 |   1 |   1 |
|   1 |   1 |   2 |   1 |
|   2 |   1 |   2 |   1 |
|   1 |   2 |   2 |   1 |
|   2 |   2 |   2 |   1 |
|   3 |   2 |   2 |   1 |
|   1 |   3 |   2 |   1 |
|   2 |   3 |   2 |   1 |
|   3 |   3 |   2 |   1 |
|   1 |   4 |   2 |   1 |
|   5 |   4 |   2 |   1 |
|   1 |   5 |   2 |   1 |
|   6 |   5 |   2 |   1 |
|   1 |   6 |   2 |   1 |
|   6 |   6 |   2 |   1 |
|   1 |   1 |   1 |   2 |
|   2 |   1 |   1 |   2 |
|   1 |   2 |   1 |   2 |
|   2 |   2 |   1 |   2 |
|   3 |   2 |   1 |   2 |
|   1 |   3 |   1 |   2 |
|   2 |   3 |   1 |   2 |
|   3 |   3 |   1 |   2 |
|   1 |   4 |   1 |   2 |
|   5 |   4 |   1 |   2 |
|   1 |   5 |   1 |   2 |
|   6 |   5 |   1 |   2 |
|   1 |   6 |   1 |   2 |
|   6 |   6 |   1 |   2 |
|   1 |   1 |   2 |   2 |
|   2 |   1 |   2 |   2 |
|   1 |   2 |   2 |   2 |
|   2 |   2 |   2 |   2 |
|   3 |   2 |   2 |   2 |
|   1 |   3 |   2 |   2 |
|   2 |   3 |   2 |   2 |
|   3 |   3 |   2 |   2 |
|   1 |   4 |   2 |   2 |
|   5 |   4 |   2 |   2 |
|   1 |   5 |   2 |   2 |
|   6 |   5 |   2 |   2 |
|   1 |   6 |   2 |   2 |
|   6 |   6 |   2 |   2 |
|   1 |   1 |   3 |   2 |
|   2 |   1 |   3 |   2 |
|   1 |   2 |   3 |   2 |
|   2 |   2 |   3 |   2 |
|   3 |   2 |   3 |   2 |
|   1 |   3 |   3 |   2 |
|   2 |   3 |   3 |   2 |
|   3 |   3 |   3 |   2 |
|   1 |   4 |   3 |   2 |
|   5 |   4 |   3 |   2 |
|   1 |   5 |   3 |   2 |
|   6 |   5 |   3 |   2 |
|   1 |   6 |   3 |   2 |
|   6 |   6 |   3 |   2 |
|   1 |   1 |   1 |   3 |
|   2 |   1 |   1 |   3 |
|   1 |   2 |   1 |   3 |
|   2 |   2 |   1 |   3 |
|   3 |   2 |   1 |   3 |
|   1 |   3 |   1 |   3 |
|   2 |   3 |   1 |   3 |
|   3 |   3 |   1 |   3 |
|   1 |   4 |   1 |   3 |
|   5 |   4 |   1 |   3 |
|   1 |   5 |   1 |   3 |
|   6 |   5 |   1 |   3 |
|   1 |   6 |   1 |   3 |
|   6 |   6 |   1 |   3 |
|   1 |   1 |   2 |   3 |
|   2 |   1 |   2 |   3 |
|   1 |   2 |   2 |   3 |
|   2 |   2 |   2 |   3 |
|   3 |   2 |   2 |   3 |
|   1 |   3 |   2 |   3 |
|   2 |   3 |   2 |   3 |
|   3 |   3 |   2 |   3 |
|   1 |   4 |   2 |   3 |
|   5 |   4 |   2 |   3 |
|   1 |   5 |   2 |   3 |
|   6 |   5 |   2 |   3 |
|   1 |   6 |   2 |   3 |
|   6 |   6 |   2 |   3 |
|   1 |   1 |   3 |   3 |
|   2 |   1 |   3 |   3 |
|   1 |   2 |   3 |   3 |
|   2 |   2 |   3 |   3 |
|   3 |   2 |   3 |   3 |
|   1 |   3 |   3 |   3 |
|   2 |   3 |   3 |   3 |
|   3 |   3 |   3 |   3 |
|   1 |   4 |   3 |   3 |
|   5 |   4 |   3 |   3 |
|   1 |   5 |   3 |   3 |
|   6 |   5 |   3 |   3 |
|   1 |   6 |   3 |   3 |
|   6 |   6 |   3 |   3 |
|   1 |   1 |   1 |   4 |
|   2 |   1 |   1 |   4 |
|   1 |   2 |   1 |   4 |
|   2 |   2 |   1 |   4 |
|   3 |   2 |   1 |   4 |
|   1 |   3 |   1 |   4 |
|   2 |   3 |   1 |   4 |
|   3 |   3 |   1 |   4 |
|   1 |   4 |   1 |   4 |
|   5 |   4 |   1 |   4 |
|   1 |   5 |   1 |   4 |
|   6 |   5 |   1 |   4 |
|   1 |   6 |   1 |   4 |
|   6 |   6 |   1 |   4 |
|   1 |   1 |   5 |   4 |
|   2 |   1 |   5 |   4 |
|   1 |   2 |   5 |   4 |
|   2 |   2 |   5 |   4 |
|   3 |   2 |   5 |   4 |
|   1 |   3 |   5 |   4 |
|   2 |   3 |   5 |   4 |
|   3 |   3 |   5 |   4 |
|   1 |   4 |   5 |   4 |
|   5 |   4 |   5 |   4 |
|   1 |   5 |   5 |   4 |
|   6 |   5 |   5 |   4 |
|   1 |   6 |   5 |   4 |
|   6 |   6 |   5 |   4 |
|   1 |   1 |   1 |   5 |
|   2 |   1 |   1 |   5 |
|   1 |   2 |   1 |   5 |
|   2 |   2 |   1 |   5 |
|   3 |   2 |   1 |   5 |
|   1 |   3 |   1 |   5 |
|   2 |   3 |   1 |   5 |
|   3 |   3 |   1 |   5 |
|   1 |   4 |   1 |   5 |
|   5 |   4 |   1 |   5 |
|   1 |   5 |   1 |   5 |
|   6 |   5 |   1 |   5 |
|   1 |   6 |   1 |   5 |
|   6 |   6 |   1 |   5 |
|   1 |   1 |   6 |   5 |
|   2 |   1 |   6 |   5 |
|   1 |   2 |   6 |   5 |
|   2 |   2 |   6 |   5 |
|   3 |   2 |   6 |   5 |
|   1 |   3 |   6 |   5 |
|   2 |   3 |   6 |   5 |
|   3 |   3 |   6 |   5 |
|   1 |   4 |   6 |   5 |
|   5 |   4 |   6 |   5 |
|   1 |   5 |   6 |   5 |
|   6 |   5 |   6 |   5 |
|   1 |   6 |   6 |   5 |
|   6 |   6 |   6 |   5 |
|   1 |   1 |   1 |   6 |
|   2 |   1 |   1 |   6 |
|   1 |   2 |   1 |   6 |
|   2 |   2 |   1 |   6 |
|   3 |   2 |   1 |   6 |
|   1 |   3 |   1 |   6 |
|   2 |   3 |   1 |   6 |
|   3 |   3 |   1 |   6 |
|   1 |   4 |   1 |   6 |
|   5 |   4 |   1 |   6 |
|   1 |   5 |   1 |   6 |
|   6 |   5 |   1 |   6 |
|   1 |   6 |   1 |   6 |
|   6 |   6 |   1 |   6 |
|   1 |   1 |   6 |   6 |
|   2 |   1 |   6 |   6 |
|   1 |   2 |   6 |   6 |
|   2 |   2 |   6 |   6 |
|   3 |   2 |   6 |   6 |
|   1 |   3 |   6 |   6 |
|   2 |   3 |   6 |   6 |
|   3 |   3 |   6 |   6 |
|   1 |   4 |   6 |   6 |
|   5 |   4 |   6 |   6 |
|   1 |   5 |   6 |   6 |
|   6 |   5 |   6 |   6 |
|   1 |   6 |   6 |   6 |
|   6 |   6 |   6 |   6 |
+-----+-----+-----+-----+
196 rows in set (0.00 sec)

mysql> select q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno) group by q.sno,w.sno having count(w.pno)=(select count(distinct pno) from v1 where sno=q.sno);
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   4 |   1 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   4 |
|   6 |   1 |
|   6 |   4 |
+-----+-----+
10 rows in set (0.01 sec)

mysql> select q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno)=(select count(distinct pno) from v1 where sno=q.sno);
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   3 |
|   3 |   2 |
|   4 |   1 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
14 rows in set (0.01 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno)=(select count(distinct pno) from v1 where sno=q.sno);
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   3 |
|   3 |   2 |
|   4 |   1 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
14 rows in set (0.01 sec)

mysql> select * from v1
    -> ;
+-----+-----+
| pno | sno |
+-----+-----+
|   1 |   1 |
|   2 |   1 |
|   1 |   2 |
|   2 |   2 |
|   3 |   2 |
|   1 |   3 |
|   2 |   3 |
|   3 |   3 |
|   1 |   4 |
|   5 |   4 |
|   1 |   5 |
|   6 |   5 |
|   1 |   6 |
|   6 |   6 |
+-----+-----+
14 rows in set (0.00 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno)=(select count(distinct pno) from v1 where sno=q.sno);
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   3 |
|   3 |   2 |
|   4 |   1 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
14 rows in set (0.01 sec)

mysql> select sno from v1 v where pno in (select pno from v1 q where v.sno!=q.sno group by q.sno  having count(pno)=(select count(pno) from v1 q where v.sno!=q.sno group by q.sno));
ERROR 1055 (42000): Expression #1 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'q.pno' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> 
mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno)=(select count(distinct pno) from v1 where sno=q.sno);
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   3 |
|   3 |   2 |
|   4 |   1 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
14 rows in set (0.01 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where (select pno from v1 where sno=q.sno) in(select pno from v1 where sno=w.sno && sno!=q.sno)and (select pno from v1 where sno=w.sno) in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno)=(select count(distinct pno) from v1 where sno=q.sno);
ERROR 1242 (21000): Subquery returns more than 1 row
mysql> select sno,pno from v1 v where exists (select pno from v1 q where v.sno!=q.sno group by q.sno) group by sno having count(pno)=(select count(pno) from v1 q where v.sno!=q.sno group by q.sno);
ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'v.pno' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by
mysql> select * from v1 q join v1 on v1.sno=v2.sno;
ERROR 1054 (42S22): Unknown column 'v2.sno' in 'on clause'
mysql> select * from v1 q join v1 w on q.sno=w.sno;
+-----+-----+-----+-----+
| pno | sno | pno | sno |
+-----+-----+-----+-----+
|   1 |   1 |   1 |   1 |
|   1 |   1 |   2 |   1 |
|   2 |   1 |   1 |   1 |
|   2 |   1 |   2 |   1 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   2 |   2 |
|   1 |   2 |   3 |   2 |
|   2 |   2 |   1 |   2 |
|   2 |   2 |   2 |   2 |
|   2 |   2 |   3 |   2 |
|   3 |   2 |   1 |   2 |
|   3 |   2 |   2 |   2 |
|   3 |   2 |   3 |   2 |
|   1 |   3 |   1 |   3 |
|   1 |   3 |   2 |   3 |
|   1 |   3 |   3 |   3 |
|   2 |   3 |   1 |   3 |
|   2 |   3 |   2 |   3 |
|   2 |   3 |   3 |   3 |
|   3 |   3 |   1 |   3 |
|   3 |   3 |   2 |   3 |
|   3 |   3 |   3 |   3 |
|   1 |   4 |   1 |   4 |
|   1 |   4 |   5 |   4 |
|   5 |   4 |   1 |   4 |
|   5 |   4 |   5 |   4 |
|   1 |   5 |   1 |   5 |
|   1 |   5 |   6 |   5 |
|   6 |   5 |   1 |   5 |
|   6 |   5 |   6 |   5 |
|   1 |   6 |   6 |   6 |
|   1 |   6 |   1 |   6 |
|   6 |   6 |   6 |   6 |
|   6 |   6 |   1 |   6 |
+-----+-----+-----+-----+
34 rows in set (0.00 sec)

mysql> select * from v1 q join v1 w on q.sno=w.sno and q.pno=w.pno;
+-----+-----+-----+-----+
| pno | sno | pno | sno |
+-----+-----+-----+-----+
|   1 |   1 |   1 |   1 |
|   2 |   1 |   2 |   1 |
|   1 |   2 |   1 |   2 |
|   2 |   2 |   2 |   2 |
|   3 |   2 |   3 |   2 |
|   1 |   3 |   1 |   3 |
|   2 |   3 |   2 |   3 |
|   3 |   3 |   3 |   3 |
|   1 |   4 |   1 |   4 |
|   5 |   4 |   5 |   4 |
|   1 |   5 |   1 |   5 |
|   6 |   5 |   6 |   5 |
|   1 |   6 |   1 |   6 |
|   6 |   6 |   6 |   6 |
+-----+-----+-----+-----+
14 rows in set (0.00 sec)

mysql> select * from v1 q join v1 w on q.pno=w.pno;
+-----+-----+-----+-----+
| pno | sno | pno | sno |
+-----+-----+-----+-----+
|   1 |   1 |   1 |   1 |
|   1 |   1 |   1 |   2 |
|   1 |   1 |   1 |   3 |
|   1 |   1 |   1 |   4 |
|   1 |   1 |   1 |   5 |
|   1 |   1 |   1 |   6 |
|   2 |   1 |   2 |   1 |
|   2 |   1 |   2 |   2 |
|   2 |   1 |   2 |   3 |
|   1 |   2 |   1 |   1 |
|   1 |   2 |   1 |   2 |
|   1 |   2 |   1 |   3 |
|   1 |   2 |   1 |   4 |
|   1 |   2 |   1 |   5 |
|   1 |   2 |   1 |   6 |
|   2 |   2 |   2 |   1 |
|   2 |   2 |   2 |   2 |
|   2 |   2 |   2 |   3 |
|   3 |   2 |   3 |   2 |
|   3 |   2 |   3 |   3 |
|   1 |   3 |   1 |   1 |
|   1 |   3 |   1 |   2 |
|   1 |   3 |   1 |   3 |
|   1 |   3 |   1 |   4 |
|   1 |   3 |   1 |   5 |
|   1 |   3 |   1 |   6 |
|   2 |   3 |   2 |   1 |
|   2 |   3 |   2 |   2 |
|   2 |   3 |   2 |   3 |
|   3 |   3 |   3 |   2 |
|   3 |   3 |   3 |   3 |
|   1 |   4 |   1 |   1 |
|   1 |   4 |   1 |   2 |
|   1 |   4 |   1 |   3 |
|   1 |   4 |   1 |   4 |
|   1 |   4 |   1 |   5 |
|   1 |   4 |   1 |   6 |
|   5 |   4 |   5 |   4 |
|   1 |   5 |   1 |   1 |
|   1 |   5 |   1 |   2 |
|   1 |   5 |   1 |   3 |
|   1 |   5 |   1 |   4 |
|   1 |   5 |   1 |   5 |
|   1 |   5 |   1 |   6 |
|   6 |   5 |   6 |   6 |
|   6 |   5 |   6 |   5 |
|   1 |   6 |   1 |   1 |
|   1 |   6 |   1 |   2 |
|   1 |   6 |   1 |   3 |
|   1 |   6 |   1 |   4 |
|   1 |   6 |   1 |   5 |
|   1 |   6 |   1 |   6 |
|   6 |   6 |   6 |   6 |
|   6 |   6 |   6 |   5 |
+-----+-----+-----+-----+
54 rows in set (0.00 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where (select pno from v1 where sno=q.sno) in(select pno from v1 where sno=w.sno && sno!=q.sno)and (select pno from v1 where sno=w.sno) in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno)=(select count(distinct pno) from v1 where sno=q.sno);
ERROR 1242 (21000): Subquery returns more than 1 row
mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno)=(select count(distinct pno) from v1 where sno=q.sno);
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   3 |
|   3 |   2 |
|   4 |   1 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
14 rows in set (0.00 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and  w.pno not in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno)=(select count(distinct pno) from v1 where sno=q.sno);
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   4 |   1 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   4 |
|   6 |   1 |
|   6 |   4 |
+-----+-----+
10 rows in set (0.00 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno)=(select count(distinct pno) from v1 where sno=q.sno);
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   3 |
|   3 |   2 |
|   4 |   1 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
14 rows in set (0.01 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno)=(select count(distinct pno) from v1 where sno=q.sno);
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   3 |
|   3 |   2 |
|   4 |   1 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
14 rows in set (0.00 sec)

mysql> select * from v2;
+------+------+------+------+
| ssno | spno | vsno | vpno |
+------+------+------+------+
|    1 |    1 |    1 |    1 |
|    1 |    1 |    1 |    1 |
|    2 |    1 |    1 |    1 |
|    3 |    1 |    1 |    1 |
|    4 |    1 |    1 |    1 |
|    5 |    1 |    1 |    1 |
|    6 |    1 |    1 |    1 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    2 |    2 |    1 |    2 |
|    3 |    2 |    1 |    2 |
|    1 |    1 |    2 |    1 |
|    1 |    1 |    2 |    1 |
|    2 |    1 |    2 |    1 |
|    3 |    1 |    2 |    1 |
|    4 |    1 |    2 |    1 |
|    5 |    1 |    2 |    1 |
|    6 |    1 |    2 |    1 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    2 |    2 |    2 |    2 |
|    3 |    2 |    2 |    2 |
|    2 |    3 |    2 |    3 |
|    3 |    3 |    2 |    3 |
|    1 |    1 |    3 |    1 |
|    1 |    1 |    3 |    1 |
|    2 |    1 |    3 |    1 |
|    3 |    1 |    3 |    1 |
|    4 |    1 |    3 |    1 |
|    5 |    1 |    3 |    1 |
|    6 |    1 |    3 |    1 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    2 |    2 |    3 |    2 |
|    3 |    2 |    3 |    2 |
|    2 |    3 |    3 |    3 |
|    3 |    3 |    3 |    3 |
|    1 |    1 |    4 |    1 |
|    1 |    1 |    4 |    1 |
|    2 |    1 |    4 |    1 |
|    3 |    1 |    4 |    1 |
|    4 |    1 |    4 |    1 |
|    5 |    1 |    4 |    1 |
|    6 |    1 |    4 |    1 |
|    4 |    5 |    4 |    5 |
|    4 |    5 |    4 |    5 |
|    1 |    1 |    5 |    1 |
|    1 |    1 |    5 |    1 |
|    2 |    1 |    5 |    1 |
|    3 |    1 |    5 |    1 |
|    4 |    1 |    5 |    1 |
|    5 |    1 |    5 |    1 |
|    6 |    1 |    5 |    1 |
|    5 |    6 |    5 |    6 |
|    6 |    6 |    5 |    6 |
|    1 |    1 |    6 |    1 |
|    1 |    1 |    6 |    1 |
|    2 |    1 |    6 |    1 |
|    3 |    1 |    6 |    1 |
|    4 |    1 |    6 |    1 |
|    5 |    1 |    6 |    1 |
|    6 |    1 |    6 |    1 |
|    5 |    6 |    6 |    6 |
|    6 |    6 |    6 |    6 |
+------+------+------+------+
76 rows in set (0.00 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno)=(select count(distinct pno) from v1 where sno=q.sno);
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   3 |
|   3 |   2 |
|   4 |   1 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
14 rows in set (0.01 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno and pno in(select pno from v1 where sno=w.q.sno))=(select count(distinct pno) from v1 where sno=q.sno and pno in(select pno from v1 where sno=q.sno));
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   2 |
|   1 |   3 |
|   2 |   3 |
|   3 |   2 |
|   5 |   6 |
|   6 |   5 |
+-----+-----+
6 rows in set (0.00 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno and pno in(select pno from v1 where sno=w.q.sno))=(select count(distinct pno) from v1 where sno=q.sno and pno in(select pno from v1 where sno=q.sno));
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   1 |
|   1 |   2 |
|   1 |   3 |
|   2 |   2 |
|   2 |   3 |
|   3 |   2 |
|   3 |   3 |
|   4 |   4 |
|   5 |   5 |
|   5 |   6 |
|   6 |   5 |
|   6 |   6 |
+-----+-----+
12 rows in set (0.00 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno and pno in(select pno from v1 where sno=w.q.sno))=(select count(distinct pno) from v1 where sno=q.sno and pno in(select pno from v1 where sno=q.sno));
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   2 |
|   1 |   3 |
|   2 |   3 |
|   3 |   2 |
|   5 |   6 |
|   6 |   5 |
+-----+-----+
6 rows in set (0.01 sec)

mysql> select ssno,vsno from v2 V where (select count(distinct pno) from v2 v where V)
    -> ;
ERROR 1054 (42S22): Unknown column 'pno' in 'field list'
mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno and pno in(select pno from v1 where sno=w.sno))=(select count(distinct pno) from v1 where sno=q.sno and pno in(select pno from v1 where sno=q.sno));
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   3 |
|   3 |   2 |
|   4 |   1 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
14 rows in set (0.01 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno and pno in(select pno from v1 where sno=q.sno))=(select count(distinct pno) from v1 where sno=q.sno and pno in(select pno from v1 where sno=w.sno));
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   2 |
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   1 |
|   2 |   3 |
|   2 |   4 |
|   2 |   5 |
|   2 |   6 |
|   3 |   1 |
|   3 |   2 |
|   3 |   4 |
|   3 |   5 |
|   3 |   6 |
|   4 |   1 |
|   4 |   2 |
|   4 |   3 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   2 |
|   5 |   3 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   2 |
|   6 |   3 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
30 rows in set (0.00 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno and pno in(select pno from v1 where sno=w.q.sno))=(select count(distinct pno) from v1 where sno=q.sno and pno in(select pno from v1 where sno=q.w.sno));
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   2 |
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   1 |
|   2 |   3 |
|   2 |   4 |
|   2 |   5 |
|   2 |   6 |
|   3 |   1 |
|   3 |   2 |
|   3 |   4 |
|   3 |   5 |
|   3 |   6 |
|   4 |   1 |
|   4 |   2 |
|   4 |   3 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   2 |
|   5 |   3 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   2 |
|   6 |   3 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
30 rows in set (0.01 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno and pno in(select pno from v1 where sno=w.q.sno))=(select count(distinct pno) from v1 where sno=q.sno and pno in(select pno from v1 where sno=w.sno));
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   2 |
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   1 |
|   2 |   3 |
|   2 |   4 |
|   2 |   5 |
|   2 |   6 |
|   3 |   1 |
|   3 |   2 |
|   3 |   4 |
|   3 |   5 |
|   3 |   6 |
|   4 |   1 |
|   4 |   2 |
|   4 |   3 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   2 |
|   5 |   3 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   2 |
|   6 |   3 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
30 rows in set (0.01 sec)

mysql> select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno and pno in(select pno from v1 where sno=q.sno))=(select count(distinct pno) from v1 where sno=q.sno and pno in(select pno from v1 where sno=w.sno));
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   2 |
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   1 |
|   2 |   3 |
|   2 |   4 |
|   2 |   5 |
|   2 |   6 |
|   3 |   1 |
|   3 |   2 |
|   3 |   4 |
|   3 |   5 |
|   3 |   6 |
|   4 |   1 |
|   4 |   2 |
|   4 |   3 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   2 |
|   5 |   3 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   2 |
|   6 |   3 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
30 rows in set (0.00 sec)

mysql>  select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno and pno in(select pno from v1 where sno=w.q.sno))=(select count(distinct pno) from v1 where sno=q.sno and pno in(select pno from v1 where sno=q.sno));
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   2 |
|   1 |   3 |
|   2 |   3 |
|   3 |   2 |
|   5 |   6 |
|   6 |   5 |
+-----+-----+
6 rows in set (0.01 sec)

mysql>  select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno and pno in(select pno from v1 where sno=w.q.sno))=(select count(distinct pno) from v1 where sno=q.sno and pno in(select pno from v1 where sno=q.w.sno));
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   2 |
|   1 |   3 |
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   1 |
|   2 |   3 |
|   2 |   4 |
|   2 |   5 |
|   2 |   6 |
|   3 |   1 |
|   3 |   2 |
|   3 |   4 |
|   3 |   5 |
|   3 |   6 |
|   4 |   1 |
|   4 |   2 |
|   4 |   3 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   2 |
|   5 |   3 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   2 |
|   6 |   3 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
30 rows in set (0.01 sec)

mysql>  select distinct q.sno,w.sno from v1 q join v1 w where q.pno in(select pno from v1 where sno=w.sno && sno!=q.sno)and w.pno in(select pno from v1 where sno=q.sno && sno!=w.sno) group by q.sno,w.sno having (select count(distinct pno) from v1 where sno=w.sno and pno in(select pno from v1 where sno=w.sno))=(select count(distinct pno) from v1 where sno=q.sno and pno in(select pno from v1 where sno=q.sno));
+-----+-----+
| sno | sno |
+-----+-----+
|   1 |   4 |
|   1 |   5 |
|   1 |   6 |
|   2 |   3 |
|   3 |   2 |
|   4 |   1 |
|   4 |   5 |
|   4 |   6 |
|   5 |   1 |
|   5 |   4 |
|   5 |   6 |
|   6 |   1 |
|   6 |   4 |
|   6 |   5 |
+-----+-----+
14 rows in set (0.01 sec)

mysql> select ssno,vsno from v2 V where (select count(distinct pno) from v2 v where V.vsno=v.vsno and V.ssno=v.ssno group by vsno,ssno)=(select count(pno) from v2 q where q.ssno=V.ssno group by ssno); 
ERROR 1054 (42S22): Unknown column 'pno' in 'field list'
mysql> select ssno,vsno from v2 V where (select count(distinct spno) from v2 v where V.vsno=v.vsno and V.ssno=v.ssno group by vsno,ssno)=(select count(spno) from v2 q where q.ssno=V.ssno group by ssno);
Empty set (0.01 sec)

mysql> select ssno,vsno from v2 V where (select count(spno) from v2 v where V.vsno=v.vsno and V.ssno=v.ssno group by vsno,ssno)=(select count(spno) from v2 q where q.ssno=V.ssno group by ssno);
Empty set (0.01 sec)

mysql> select ssno,vsno from v2 V where (select count(distinct spno) from v2 v where V.vsno=v.vsno and V.ssno=v.ssno group by vsno,ssno)=(select count(distinct spno) from v2 q where q.ssno=V.ssno group by ssno);
+------+------+
| ssno | vsno |
+------+------+
|    1 |    1 |
|    1 |    1 |
|    1 |    1 |
|    1 |    1 |
|    1 |    1 |
|    1 |    1 |
|    1 |    1 |
|    1 |    1 |
|    1 |    2 |
|    1 |    2 |
|    2 |    2 |
|    3 |    2 |
|    1 |    2 |
|    1 |    2 |
|    1 |    2 |
|    1 |    2 |
|    1 |    2 |
|    1 |    2 |
|    2 |    2 |
|    3 |    2 |
|    2 |    2 |
|    3 |    2 |
|    1 |    3 |
|    1 |    3 |
|    2 |    3 |
|    3 |    3 |
|    1 |    3 |
|    1 |    3 |
|    1 |    3 |
|    1 |    3 |
|    1 |    3 |
|    1 |    3 |
|    2 |    3 |
|    3 |    3 |
|    2 |    3 |
|    3 |    3 |
|    4 |    4 |
|    4 |    4 |
|    4 |    4 |
|    5 |    5 |
|    6 |    5 |
|    5 |    5 |
|    6 |    5 |
|    5 |    6 |
|    6 |    6 |
|    5 |    6 |
|    6 |    6 |
+------+------+
47 rows in set (0.01 sec)

mysql> select distinct ssno,vsno from v2 V where (select count(distinct spno) from v2 v where V.vsno=v.vsno and V.ssno=v.ssno group by vsno,ssno)=(select count(distinct spno) from v2 q where q.ssno=V.ssno group by ssno);
+------+------+
| ssno | vsno |
+------+------+
|    1 |    1 |
|    1 |    2 |
|    2 |    2 |
|    3 |    2 |
|    1 |    3 |
|    2 |    3 |
|    3 |    3 |
|    4 |    4 |
|    5 |    5 |
|    6 |    5 |
|    5 |    6 |
|    6 |    6 |
+------+------+
12 rows in set (0.01 sec)

mysql> select distinct ssno,vsno from v2 V where (select count(distinct spno) from v2 v where V.vsno=v.vsno and V.ssno=v.ssno group by vsno,ssno)=(select count(distinct spno) from v2 q where q.ssno=V.ssno group by ssno) and ssno!=vsno;
+------+------+
| ssno | vsno |
+------+------+
|    1 |    2 |
|    3 |    2 |
|    1 |    3 |
|    2 |    3 |
|    6 |    5 |
|    5 |    6 |
+------+------+
6 rows in set (0.01 sec)

mysql> select * from v2;
+------+------+------+------+
| ssno | spno | vsno | vpno |
+------+------+------+------+
|    1 |    1 |    1 |    1 |
|    1 |    1 |    1 |    1 |
|    2 |    1 |    1 |    1 |
|    3 |    1 |    1 |    1 |
|    4 |    1 |    1 |    1 |
|    5 |    1 |    1 |    1 |
|    6 |    1 |    1 |    1 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    1 |    2 |    1 |    2 |
|    2 |    2 |    1 |    2 |
|    3 |    2 |    1 |    2 |
|    1 |    1 |    2 |    1 |
|    1 |    1 |    2 |    1 |
|    2 |    1 |    2 |    1 |
|    3 |    1 |    2 |    1 |
|    4 |    1 |    2 |    1 |
|    5 |    1 |    2 |    1 |
|    6 |    1 |    2 |    1 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    1 |    2 |    2 |    2 |
|    2 |    2 |    2 |    2 |
|    3 |    2 |    2 |    2 |
|    2 |    3 |    2 |    3 |
|    3 |    3 |    2 |    3 |
|    1 |    1 |    3 |    1 |
|    1 |    1 |    3 |    1 |
|    2 |    1 |    3 |    1 |
|    3 |    1 |    3 |    1 |
|    4 |    1 |    3 |    1 |
|    5 |    1 |    3 |    1 |
|    6 |    1 |    3 |    1 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    1 |    2 |    3 |    2 |
|    2 |    2 |    3 |    2 |
|    3 |    2 |    3 |    2 |
|    2 |    3 |    3 |    3 |
|    3 |    3 |    3 |    3 |
|    1 |    1 |    4 |    1 |
|    1 |    1 |    4 |    1 |
|    2 |    1 |    4 |    1 |
|    3 |    1 |    4 |    1 |
|    4 |    1 |    4 |    1 |
|    5 |    1 |    4 |    1 |
|    6 |    1 |    4 |    1 |
|    4 |    5 |    4 |    5 |
|    4 |    5 |    4 |    5 |
|    1 |    1 |    5 |    1 |
|    1 |    1 |    5 |    1 |
|    2 |    1 |    5 |    1 |
|    3 |    1 |    5 |    1 |
|    4 |    1 |    5 |    1 |
|    5 |    1 |    5 |    1 |
|    6 |    1 |    5 |    1 |
|    5 |    6 |    5 |    6 |
|    6 |    6 |    5 |    6 |
|    1 |    1 |    6 |    1 |
|    1 |    1 |    6 |    1 |
|    2 |    1 |    6 |    1 |
|    3 |    1 |    6 |    1 |
|    4 |    1 |    6 |    1 |
|    5 |    1 |    6 |    1 |
|    6 |    1 |    6 |    1 |
|    5 |    6 |    6 |    6 |
|    6 |    6 |    6 |    6 |
+------+------+------+------+
76 rows in set (0.01 sec)

mysql> select distinct ssno,vsno from v2 V where (select count(distinct spno) from v2 v where V.vsno=v.vsno and V.ssno=v.ssno and v.ssno!=v.vsno group by vsno,ssno)=(select count(distinct spno) from v2 q where q.ssno=V.ssno group by ssno) and ssno!=vsno;
+------+------+
| ssno | vsno |
+------+------+
|    1 |    2 |
|    3 |    2 |
|    1 |    3 |
|    2 |    3 |
|    6 |    5 |
|    5 |    6 |
+------+------+
6 rows in set (0.01 sec)

mysql> select distinct ssno,vsno from v2 V where (select count(distinct spno) from v2 v where V.vsno=v.vsno and V.ssno=v.ssno and v.ssno!=v.vsno group by vsno,ssno)=(select count(distinct spno) from v2 q where q.ssno=V.ssno and q.vsno=V.vsno group by ssno) and ssno!=vsno;
+------+------+
| ssno | vsno |
+------+------+
|    2 |    1 |
|    3 |    1 |
|    4 |    1 |
|    5 |    1 |
|    6 |    1 |
|    1 |    2 |
|    3 |    2 |
|    4 |    2 |
|    5 |    2 |
|    6 |    2 |
|    1 |    3 |
|    2 |    3 |
|    4 |    3 |
|    5 |    3 |
|    6 |    3 |
|    1 |    4 |
|    2 |    4 |
|    3 |    4 |
|    5 |    4 |
|    6 |    4 |
|    1 |    5 |
|    2 |    5 |
|    3 |    5 |
|    4 |    5 |
|    6 |    5 |
|    1 |    6 |
|    2 |    6 |
|    3 |    6 |
|    4 |    6 |
|    5 |    6 |
+------+------+
30 rows in set (0.01 sec)

mysql> select distinct ssno,vsno from v2 V where (select count(distinct spno) from v2 v where V.vsno=v.vsno and V.ssno=v.ssno and v.ssno!=v.vsno group by vsno,ssno)=(select count(distinct spno) from v2 q where q.ssno=V.ssno  group by ssno) and ssno!=vsno;
+------+------+
| ssno | vsno |
+------+------+
|    1 |    2 |
|    3 |    2 |
|    1 |    3 |
|    2 |    3 |
|    6 |    5 |
|    5 |    6 |
+------+------+
6 rows in set (0.01 sec)

mysql> select distinct ssno,vsno from v2 V where (select count(distinct spno) from v2 v where V.vsno=v.vsno and V.ssno=v.ssno and v.ssno!=v.vsno group by vsno,ssno)=(select count(distinct spno) from v2 q where q.ssno=V.ssno  group by ssno) and (select count(distinct spno) from v2 q where q.ssno=V.ssno  group by ssno)=(select count(distinct spno) from v2 q where q.ssno=V.ssno  group by vsno) and ssno!=vsno;
ERROR 1242 (21000): Subquery returns more than 1 row
mysql> select distinct ssno,vsno from v2 V where (select count(distinct spno) from v2 v where V.vsno=v.vsno and V.ssno=v.ssno and v.ssno!=v.vsno group by vsno,ssno)=(select count(distinct spno) from v2 q where q.ssno=V.ssno  group by ssno) and (select count(distinct spno) from v2 q where q.ssno=V.ssno  group by ssno)=(select count(distinct spno) from v2 q where q.vsno=V.vsno  group by vsno) and ssno!=vsno;
+------+------+
| ssno | vsno |
+------+------+
|    3 |    2 |
|    2 |    3 |
|    6 |    5 |
|    5 |    6 |
+------+------+
4 rows in set (0.01 sec)

mysql> select 8 from v1;
+---+
| 8 |
+---+
| 8 |
| 8 |
| 8 |
| 8 |
| 8 |
| 8 |
| 8 |
| 8 |
| 8 |
| 8 |
| 8 |
| 8 |
| 8 |
| 8 |
+---+
14 rows in set (0.00 sec)

mysql> select * from v1;
+-----+-----+
| pno | sno |
+-----+-----+
|   1 |   1 |
|   2 |   1 |
|   1 |   2 |
|   2 |   2 |
|   3 |   2 |
|   1 |   3 |
|   2 |   3 |
|   3 |   3 |
|   1 |   4 |
|   5 |   4 |
|   1 |   5 |
|   6 |   5 |
|   1 |   6 |
|   6 |   6 |
+-----+-----+
14 rows in set (0.00 sec)

mysql> select * from spj;
+-----+-----+-----+------+
| sno | pno | jno | qty  |
+-----+-----+-----+------+
|   1 |   1 |   2 |   20 |
|   1 |   1 |   6 |   40 |
|   1 |   2 |   1 |   30 |
|   1 |   2 |   2 |   50 |
|   1 |   2 |   3 |   20 |
|   1 |   2 |   4 |   10 |
|   1 |   2 |   5 |   30 |
|   1 |   2 |   6 |   10 |
|   2 |   1 |   6 |   10 |
|   2 |   2 |   1 |   40 |
|   2 |   3 |   6 |   20 |
|   3 |   1 |   1 |   60 |
|   3 |   2 |   1 |   50 |
|   3 |   3 |   6 |   70 |
|   4 |   1 |   4 |   50 |
|   4 |   5 |   1 |   10 |
|   4 |   5 |   5 |   50 |
|   5 |   1 |   1 |   80 |
|   5 |   6 |   5 |   10 |
|   6 |   1 |   6 |   65 |
|   6 |   6 |   3 |   20 |
+-----+-----+-----+------+
21 rows in set (0.00 sec)

mysql> select * from spj group by (sno,pno);
ERROR 1241 (21000): Operand should contain 1 column(s)
mysql> select sno,pno from spj group by sno,pno;
+-----+-----+
| sno | pno |
+-----+-----+
|   1 |   1 |
|   1 |   2 |
|   2 |   1 |
|   2 |   2 |
|   2 |   3 |
|   3 |   1 |
|   3 |   2 |
|   3 |   3 |
|   4 |   1 |
|   4 |   5 |
|   5 |   1 |
|   5 |   6 |
|   6 |   1 |
|   6 |   6 |
+-----+-----+
14 rows in set (0.00 sec)

mysql>  select distinct ssno,vsno from v2 V where (select count(distinct spno) from v2 v where V.vsno=v.vsno and V.ssno=v.ssno and v.ssno!=v.vsno group by vsno,ssno)=(select count(distinct spno) from v2 q where q.ssno=V.ssno  group by ssno) and (select count(distinct spno) from v2 q where q.ssno=V.ssno  group by ssno)=(select count(distinct spno) from v2 q where q.vsno=V.vsno  group by vsno) and ssno!=vsno;
+------+------+
| ssno | vsno |
+------+------+
|    3 |    2 |
|    2 |    3 |
|    6 |    5 |
|    5 |    6 |
+------+------+
4 rows in set (0.04 sec)

mysql> quit
